(window.webpackJsonp=window.webpackJsonp||[]).push([[358],{462:function(t,a,s){"use strict";s.r(a);var n=s(10),p=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("p",[t._v("在数据集成作业中，输入、转换、输出节点都可以通过自定义脚本来实现功能。")]),t._v(" "),s("h2",{attrs:{id:"支持的语法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#支持的语法"}},[t._v("#")]),t._v(" 支持的语法")]),t._v(" "),s("p",[t._v("脚本使用JavaScript语言进行编写，语法上支持ES5以及ES6的const和let语法。")]),t._v(" "),s("p",[t._v("ES5的语法及常见API可以参考地址： "),s("a",{attrs:{href:"http://www.ecma-international.org/ecma-262/5.1/index.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://www.ecma-international.org/ecma-262/5.1/index.html"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("ES6语法")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("const")])]),t._v(" "),s("li",[s("ul",[s("li",[s("p",[t._v("const声明一个只读的常量，一旦声明，常量的值就就不能改变；")])]),t._v(" "),s("li",[s("p",[t._v("const的作用域和let一样，只在声明所在的块级作用域内有效。")])])])]),t._v(" "),s("li",[s("p",[t._v("let")])]),t._v(" "),s("li",[s("ul",[s("li",[s("p",[t._v("在ES5中，只有两种作用域，一种是函数作用域，另一种是全局作用域，这个导致在写脚本的时候容易出现变量覆盖的情况；")])]),t._v(" "),s("li",[s("p",[t._v("所以ES6增加了let语法，用于声明变量，用法类似于var，但是所声明的变量只在let所在的代码块内有效；")])]),t._v(" "),s("li",[s("p",[t._v("建议在脚本开发的时候函数内部尽量使用let来声明变量，全局的采用var。")])])])])]),t._v(" "),s("h2",{attrs:{id:"基础扩展api"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#基础扩展api"}},[t._v("#")]),t._v(" 基础扩展API")]),t._v(" "),s("p",[t._v("我们对标准的JavaScript API进行了相应的扩展，以提供访问数据库，调用IoT服务模型， 同步数据到主数据的能力。")]),t._v(" "),s("p",[t._v("如下：")]),t._v(" "),s("h3",{attrs:{id:"_1-数据库操作"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-数据库操作"}},[t._v("#")]),t._v(" 1. 数据库操作")]),t._v(" "),s("p",[s("strong",[t._v("说明：数据库操作API的使用依赖标准扩展插件包")])]),t._v(" "),s("p",[s("code",[t._v("var iotPluginApi = require('./iotPlugin.js'); //(默认已经引用)")])]),t._v(" "),s("h4",{attrs:{id:"_1-1-sql查询接口-iotsqlselect"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-sql查询接口-iotsqlselect"}},[t._v("#")]),t._v(" 1.1 SQL查询接口 - iotSqlSelect")]),t._v(" "),s("p",[t._v("API: "),s("strong",[t._v("iotSqlSelect(statement)")])]),t._v(" "),s("p",[t._v("用途：用于在JS脚本中执行sql select语句")]),t._v(" "),s("table",{staticClass:"table",attrs:{"data-tag":"table",id:"table-625-cpe-5bz"}},[s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-t93-ey6-5hi",colwidth:"1*",colnum:"1",colname:"col1"}}),s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-h9u-c35-vsz",colwidth:"1*",colnum:"2",colname:"col2"}}),s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-0cq-akh-ssw",colwidth:"1*",colnum:"3",colname:"col3"}}),s("tbody",{staticClass:"tbody",attrs:{"data-tag":"tbody",id:"tbody-zvw-xmt-ane"}},[s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-6nd-aq3-yg5"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-se6-z9l-ve4"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-qon-mpn-al2"}},[t._v("参数")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-qis-2qa-jx8"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-hpc-zf3-qbx"}},[t._v("类型")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-rht-epn-m98"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-7q8-8ym-u1l"}},[t._v("说明")])])]),s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-qzm-l86-gb3"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-dn4-7ar-vk0"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-ayc-pcz-deg"}},[t._v("statement")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-xzz-7hq-gz8"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-e62-f7z-0y5"}},[t._v("String")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-rdc-uak-w4f"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-ymt-wmi-qzo"}},[t._v("需要执行的select sql语句，底层已经适配了数据库，所以这里只需要填写对应的sql语句")])])]),s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-agw-t9e-v2z"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-06p-c7w-pn4",colspan:"1"}}),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-1uj-wcl-lf0",colspan:"1"}}),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-5kc-iao-f7a",colspan:"1"}})])])]),t._v(" "),s("p",[t._v("返回值")]),t._v(" "),s("table",{staticClass:"table",attrs:{"data-tag":"table",id:"table-99a-r0n-hu8"}},[s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-21g-bxg-8au",colwidth:"1*",colnum:"1",colname:"col1"}}),s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-hon-5nz-8wg",colwidth:"1*",colnum:"2",colname:"col2"}}),s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-h7o-e7p-rez",colwidth:"1*",colnum:"3",colname:"col3"}}),s("tbody",{staticClass:"tbody",attrs:{"data-tag":"tbody",id:"tbody-8j9-j87-xr5"}},[s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-0yi-adp-k37"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-k1b-san-7uj"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-qnt-1se-ti4"}},[t._v("参数")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-v5c-kia-d0m"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-b7j-cco-gj3"}},[t._v("类型")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-nni-4sq-thr"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-byu-hdw-sfi"}},[t._v("说明")])])]),s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-at5-rfd-v2b"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-j3k-6a3-9xz"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-7lv-4i1-j5u"}},[t._v("code")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-l5x-fbf-emc"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-uqg-kpl-j1c"}},[t._v("Integer")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-rcq-g6l-ajj"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-50q-3bi-6b0"}},[t._v("200代表sql语句执行成功")]),s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-te9-xn1-far"}},[t._v("其他代表sql执执行失败，")]),s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-nol-0ou-3l8"}},[t._v("在使用时需要判断该返回值")])])]),s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-vg3-esm-2ka"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-znj-287-97q",colspan:"1"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-gcq-vww-hng"}},[t._v("data")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-6bp-ey2-12f",colspan:"1"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-505-gtj-0tc"}},[t._v("RowValueObject[]")]),s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-ren-g6k-ad3"}},[t._v("其中RowValueObject的类型为：")]),s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-i45-y9l-t7g"}},[t._v("Map<String，Object>;")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-arw-0pz-8r8",colspan:"1"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-mim-hlh-so0"}},[t._v("一个数组对象，数组成员为一个Map<String，Object>对象。")]),s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-vny-mbs-2qi"}},[t._v("对应sql select出来的每一行内容")]),s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-dht-nrp-g16"}},[t._v("Map的Key为列名，Object为该列对应的值。")]),s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-1l7-8ni-7y6"}},[t._v("使用的时候需要判断该数组的长度。")]),s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-ues-tu2-b57"}},[t._v("示例：")]),s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-urm-ohy-sut"}},[t._v("[")]),s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-cma-5l7-cxo"}},[t._v('{"key1":1，"key2":2}，{"key1":3，"key2":4}')]),s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-ovk-d43-gjm"}},[t._v("]")])])])])]),t._v(" "),s("p",[t._v("使用示例")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" sqlselect "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"select num, name from dbo.TestTable where num < 10"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" sqlResult "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" iotPluginApi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("iotSqlSelect")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sqlselect"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sqlResult"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("code "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" sqlResult"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" packingList "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Array")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" sqlResult"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" itemData "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Map")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//每一行的数据")]),t._v("\n        itemData"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"id"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sqlResult"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"num"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        itemData"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"name"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sqlResult"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v('"name'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("    \n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h4",{attrs:{id:"_1-2-sql执行接口-iotsqlexecute"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-sql执行接口-iotsqlexecute"}},[t._v("#")]),t._v(" 1.2 SQL执行接口 - iotSqlExecute")]),t._v(" "),s("p",[t._v("API: "),s("strong",[t._v("iotSqlExecute(statement)")])]),t._v(" "),s("p",[t._v("用途：用于在JS脚本中执行sql update 或者 delete语句")]),t._v(" "),s("table",{staticClass:"table",attrs:{"data-tag":"table",id:"table-nmc-0t7-5fy"}},[s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-yde-cll-ily",colwidth:"1*",colnum:"1",colname:"col1"}}),s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-cxx-izv-wdc",colwidth:"1*",colnum:"2",colname:"col2"}}),s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-72s-6n2-6o9",colwidth:"1*",colnum:"3",colname:"col3"}}),s("tbody",{staticClass:"tbody",attrs:{"data-tag":"tbody",id:"tbody-8j0-a7u-yxv"}},[s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-ths-95s-og7"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-h2q-s45-959"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-dbm-nzg-20b"}},[t._v("参数")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-q6b-169-uiu"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-5hv-x0i-3im"}},[t._v("类型")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-mx2-2jm-5rb"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-4t1-wpr-k6h"}},[t._v("说明")])])]),s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-elk-pud-1mr"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-qv7-bcg-xqa"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-o65-2dt-3ar"}},[t._v("statement")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-pmo-99p-93a"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-oa9-ze8-4ye"}},[t._v("String")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-pfu-g8k-331"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-j2h-41y-edn"}},[t._v("需要执行的update或delete sql语句，底层已经适配了数据库，所以这里只需要填写对应的sql语句")])])]),s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-h8r-nca-wmq"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-vxk-p8w-il3",colspan:"1"}}),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-sn8-7re-k6m",colspan:"1"}}),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-td8-sk0-fpm",colspan:"1"}})])])]),t._v(" "),s("p",[t._v("返回值")]),t._v(" "),s("table",{staticClass:"table",attrs:{"data-tag":"table",id:"table-q0b-tjq-w6u"}},[s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-ssv-tfd-tvr",colwidth:"1*",colnum:"1",colname:"col1"}}),s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-bgw-81w-157",colwidth:"1*",colnum:"2",colname:"col2"}}),s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-l66-0gi-gky",colwidth:"1*",colnum:"3",colname:"col3"}}),s("tbody",{staticClass:"tbody",attrs:{"data-tag":"tbody",id:"tbody-ktg-e8x-3uo"}},[s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-3k9-ss6-626"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-8mw-mhx-vav"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-u72-t14-bxl"}},[t._v("参数")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-776-yuc-dru"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-yip-aom-y89"}},[t._v("类型")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-6vy-4xf-fc1"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-zu3-ymf-qkr"}},[t._v("说明")])])]),s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-ne2-aj3-ob8"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-spr-yb7-4cn"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-r20-rhu-ptg"}},[t._v("code")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-6mp-yum-4ro"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-t5e-j7u-xkw"}},[t._v("Integer")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-fqr-xkc-lw4"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-z49-b7x-ubo"}},[t._v("200代表sql语句执行成功")]),s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-4c4-sc7-2kq"}},[t._v("其他代表sql执执行失败，")]),s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-hsd-9vv-39q"}},[t._v("在使用时需要判断该返回值")])])]),s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-6nj-myr-puh"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-gsh-wqr-m3z",colspan:"1"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-001-xvq-9x1"}},[t._v("data")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-mn4-g3p-oix",colspan:"1"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-ock-1iv-w24"}},[t._v("Integer")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-hls-4nt-jbw",colspan:"1"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-gzj-co3-30y"}},[t._v("影响的行数")])])])])]),t._v(" "),s("p",[t._v("使用示例")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" sqlUpdate "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'update dbo.TestTable set name = \"abc\" where num = 1'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" sqlResult "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" iotPluginApi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("iotSqlExecute")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sqlUpdate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sqlResult"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("code "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sqlResult"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h4",{attrs:{id:"_1-3-事务处理接口-iotgettransaction"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-事务处理接口-iotgettransaction"}},[t._v("#")]),t._v(" 1.3 事务处理接口 - iotGetTransaction")]),t._v(" "),s("p",[t._v("API: "),s("strong",[t._v("iotGetTransaction()")])]),t._v(" "),s("p",[t._v("用途：用于在JS脚本中创建一个事务")]),t._v(" "),s("p",[t._v("返回值：事务对象transaction")]),t._v(" "),s("table",{staticClass:"table",attrs:{"data-tag":"table",id:"table-mgj-5b8-hou"}},[s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-dae-4b9-01o",colwidth:"1*",colnum:"1",colname:"col1"}}),s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-itv-aq2-c0o",colwidth:"1*",colnum:"2",colname:"col2"}}),s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-shh-p8j-gi3",colwidth:"1*",colnum:"3",colname:"col3"}}),s("tbody",{staticClass:"tbody",attrs:{"data-tag":"tbody",id:"tbody-dg7-bdb-nnv"}},[s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-fqb-3zd-ssr"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-d2f-rhq-k9v"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-oo4-j7r-umb"}},[t._v("方法")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-bwr-o96-6hq"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-q4d-aig-2mw"}},[t._v("作用")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-sci-hc4-e7a"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-imd-ars-3un"}},[t._v("说明")])])]),s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-rq2-3nq-62v"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-swy-ipp-i2t"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-b5j-s3u-5c9"}},[t._v("transaction.select(statement)")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-l97-17d-hai"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-gnb-mdu-zeh"}},[t._v("查询数据")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-fw3-drv-5p8"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-7zm-iag-9ob"}},[t._v("参考iotSqlSelect的调用方式")])])]),s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-wd5-yrp-47f"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-zyi-lgd-g7y",colspan:"1"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-q0j-v09-grw"}},[t._v("transaction.execute(statement)")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-gq9-uup-n9w",colspan:"1"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-f15-p00-zy4"}},[t._v("修改或删除数据")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-3cg-g1k-3sh",colspan:"1"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-aac-zxm-60g"}},[t._v("参考iotSqlExecute的调用方式")])])]),s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-481-xp9-oey"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-ffc-wxh-3fw",colspan:"1"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-6w8-ei1-fdd"}},[t._v("transaction.commit()")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-wg8-fii-1vx",colspan:"1"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-mlg-8og-rio"}},[t._v("事务提交")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-r4f-yos-ust",colspan:"1"}})]),s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-ttl-mke-utu"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-7yv-n0e-d93",colspan:"1"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-a03-418-tnz"}},[t._v("transaction.rollback()")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-bs0-d21-f4i",colspan:"1"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-rzw-6er-c4r"}},[t._v("事务回滚")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-cha-yeg-4ls",colspan:"1"}})])])]),t._v(" "),s("p",[t._v("使用示例")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" transaction "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" iotPluginApi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("iotGetTransaction")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" sql1 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"INSERT INTO dbo.TB1(id,name,remark) VALUES("')]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'XXX1'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'YYY1'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v('"'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" sql2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"INSERT INTO dbo.TB2(id,name,remark) VALUES("')]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'XXX2'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'YYY2'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v('"'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        transaction"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("execute")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sql1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        transaction"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("execute")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sql2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//事务提交")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" r "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" transaction"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("commit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"commit:"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" r"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" iotPluginApi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("newIoTxResult")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"OK"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" r"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"rollback:"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//事务回滚")]),t._v("\n        transaction"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("rollback")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" iotPluginApi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("newIoTxResult")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("500")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"rollback"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h4",{attrs:{id:"_1-4-数据快照接口-newdbsnapshot"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-数据快照接口-newdbsnapshot"}},[t._v("#")]),t._v(" 1.4 数据快照接口 - newDbSnapshot")]),t._v(" "),s("p",[t._v("API: "),s("strong",[t._v("newDbSnapshot()")])]),t._v(" "),s("p",[t._v("用途：一般用于【数据库查询】输入节点的脚本编辑")]),t._v(" "),s("table",{staticClass:"table",attrs:{"data-tag":"table",id:"table-up7-22w-jbb"}},[s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-y8d-392-gaz",colwidth:"1*",colnum:"1",colname:"col1"}}),s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-9pj-qn5-jrf",colwidth:"1*",colnum:"2",colname:"col2"}}),s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-0nt-x7y-xyr",colwidth:"1*",colnum:"3",colname:"col3"}}),s("tbody",{staticClass:"tbody",attrs:{"data-tag":"tbody",id:"tbody-1f1-ha8-7dy"}},[s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-u5b-pun-bac"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-4xp-lny-w5w"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-49h-wco-r67"}},[t._v("参数")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-ij1-v10-xb2"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-5gh-66t-60m"}},[t._v("类型")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-t08-m2r-uz8"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-1pt-wpk-d16"}},[t._v("说明")])])]),s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-knv-hi9-aaj"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-lwx-r0o-nfn"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-p8l-vn2-pok"}},[t._v("statement")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-p4t-0ej-dms"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-zsf-ot1-4hf"}},[t._v("String")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-ykq-kmk-rsq"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-3di-am7-lu9"}},[t._v("需要执行的select sql语句，底层已经适配了数据库。所以这里只需要填写对应的sql语句")])])]),s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-y9f-1ys-2gl"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-x5c-20v-imd"}}),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-0u9-ckx-5cw"}}),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-5fu-53u-lfe"}})])])]),t._v(" "),s("p",[t._v("返回值：快照对象snapshot")]),t._v(" "),s("p",[t._v("使用示例")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("snapshot")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("snapshotType"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" context")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("snapshotType "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'increment'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//扫描整张表来计算增量")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" iotPluginApi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("newDbSnapshot")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"SELECT * FROM dbo.TB"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"_2-api操作"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-api操作"}},[t._v("#")]),t._v(" 2. API操作")]),t._v(" "),s("p",[s("strong",[t._v("说明：API操作的使用依赖HTTP扩展插件包")])]),t._v(" "),s("p",[s("code",[t._v("var iotPluginApi = require('./httpPlugin.js'); //(默认已经引用)")])]),t._v(" "),s("h4",{attrs:{id:"_2-1-http-get"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-http-get"}},[t._v("#")]),t._v(" 2.1 HTTP GET")]),t._v(" "),s("p",[t._v("API: "),s("strong",[t._v("httpGet()")])]),t._v(" "),s("p",[t._v("用途：一般用于【API查询】输入节点或者【API依赖】输出节点的脚本编辑")]),t._v(" "),s("table",{staticClass:"table",attrs:{"data-tag":"table",id:"table-u7q-2gz-tc1"}},[s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-51r-fv0-ymr",colwidth:"1*",colnum:"1",colname:"col1"}}),s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-8ao-ol0-hia",colwidth:"1*",colnum:"2",colname:"col2"}}),s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-zcv-ntf-9dj",colwidth:"1*",colnum:"3",colname:"col3"}}),s("tbody",{staticClass:"tbody",attrs:{"data-tag":"tbody",id:"tbody-f1u-hnx-e33"}},[s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-fml-mas-0bb"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-ksu-t9y-2ku"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-9r7-j33-1cy"}},[t._v("参数")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-45v-6kv-zy3"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-cb1-dv8-erg"}},[t._v("类型")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-3b0-zm3-oof"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-g6t-697-urr"}},[t._v("说明")])])]),s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-rug-i3o-kaj"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-obd-pul-sys"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-0zb-e8k-g5n"}},[t._v("apiPath")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-zpw-813-rfj"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-nrm-7q9-kxn"}},[t._v("String")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-4t3-u7v-6hd"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-kax-l6h-3k7"}},[t._v("HTTP路径，例如 /api/test")])])]),s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-zzt-lzm-7zv"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-f52-nba-amo"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-iek-rmr-iut"}},[t._v("headers")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-ljb-i8o-ad7"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-svt-fg3-8f1"}},[t._v("Map<String，String>")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-0su-kcz-sjm"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-z63-uf0-rmk"}},[t._v("需要扩展的HTTP Header")])])])])]),t._v(" "),s("p",[t._v("返回值：")]),t._v(" "),s("table",{staticClass:"table",attrs:{"data-tag":"table",id:"table-524-2tf-3fi"}},[s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-6c4-2fa-mpg",colwidth:"1*",colnum:"1",colname:"col1"}}),s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-dlx-mo4-v9z",colwidth:"1*",colnum:"2",colname:"col2"}}),s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-qd3-0bn-v2e",colwidth:"1*",colnum:"3",colname:"col3"}}),s("tbody",{staticClass:"tbody",attrs:{"data-tag":"tbody",id:"tbody-4hn-adx-ekw"}},[s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-tsd-26t-36i"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-h30-xox-7ne"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-k94-3kt-52k"}},[t._v("参数")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-r99-q8s-sb3"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-2fg-vzu-r1s"}},[t._v("类型")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-ukl-3qu-n51"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-eli-8n8-ahw"}},[t._v("说明")])])]),s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-3gw-37v-iem"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-bm9-55j-16n"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-vqp-031-xzv"}},[t._v("code")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-9uu-gox-r7d"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-pgp-e62-3dr"}},[t._v("Integer")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-kuk-rcz-95k"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-nj8-1tb-dgq"}},[t._v("200代表HTTP请求成功")]),s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-fk0-qnz-dbu"}},[t._v("其他代表HTTP请求失败，")]),s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-h3h-v02-6gw"}},[t._v("在使用时需要判断该返回值")])])]),s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-pdj-n96-0pi"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-0kw-v1r-qh0"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-yac-ztz-wx3"}},[t._v("data")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-8pq-av4-29r"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-a39-on6-2mr"}},[t._v("String")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-rno-eff-805"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-wsl-n9r-sdl"}},[t._v("返回的HTTP BODY")])])])])]),t._v(" "),s("p",[t._v("使用示例")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" response "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" httpPlugin"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("httpGet")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/api/test'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("code "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//这里需要对response.data的数据处理")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h4",{attrs:{id:"_2-2-http-post"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-http-post"}},[t._v("#")]),t._v(" 2.2 HTTP POST")]),t._v(" "),s("p",[t._v("API: "),s("strong",[t._v("httpPost()")])]),t._v(" "),s("p",[t._v("用途： 一般用于【API查询】输入节点或者【API依赖】输出节点的脚本编辑")]),t._v(" "),s("table",{staticClass:"table",attrs:{"data-tag":"table",id:"table-dr8-ozq-u8t"}},[s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-82y-ydl-ygg",colwidth:"1*",colnum:"1",colname:"col1"}}),s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-xja-lvr-jij",colwidth:"1*",colnum:"2",colname:"col2"}}),s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-apq-hl2-7nh",colwidth:"1*",colnum:"3",colname:"col3"}}),s("tbody",{staticClass:"tbody",attrs:{"data-tag":"tbody",id:"tbody-fq6-8wi-q9c"}},[s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-dl7-kun-a17"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-uoq-z47-tvu"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-prk-zw7-43s"}},[t._v("参数")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-r9c-1xc-y69"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-oa2-dwm-z6i"}},[t._v("类型")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-b5f-3no-j3u"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-3sx-do7-4n3"}},[t._v("说明")])])]),s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-pek-7if-085"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-95c-la9-2bd"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-pan-xt4-32h"}},[t._v("apiPath")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-mm0-mmi-o9j"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-228-stf-5g6"}},[t._v("String")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-iel-c90-say"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-fkm-6cs-089"}},[t._v("HTTP路径，例如 /api/test")])])]),s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-lqr-3zc-z0p"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-vdc-cyy-r52",colspan:"1"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-f2m-hk0-9zk"}},[t._v("jsonBody")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-kmk-4su-gx7",colspan:"1"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-09g-ieq-ssd"}},[t._v("String")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-995-z5q-8kh",colspan:"1"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-x6h-9wj-xem"}},[t._v("POST的JSON数据")])])]),s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-m8n-zpo-t6l"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-3tp-5ze-mum"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-0ln-yih-7u2"}},[t._v("headers")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-3ic-4hn-hfp"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-0ap-u23-2mr"}},[t._v("Map<String，String>")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-ip1-sg9-dr1"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-pf8-4ba-k67"}},[t._v("需要扩展的HTTP Header")])])])])]),t._v(" "),s("p",[t._v("返回值：")]),t._v(" "),s("table",{staticClass:"table",attrs:{"data-tag":"table",id:"table-cpu-hkg-mr4"}},[s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-rw0-5qe-t8b",colwidth:"1*",colnum:"1",colname:"col1"}}),s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-9qp-k6f-vj7",colwidth:"1*",colnum:"2",colname:"col2"}}),s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-bin-jj3-syo",colwidth:"1*",colnum:"3",colname:"col3"}}),s("tbody",{staticClass:"tbody",attrs:{"data-tag":"tbody",id:"tbody-5t2-wt1-eqd"}},[s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-ah6-56y-fyd"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-qoc-4vk-wya"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-1ln-owj-t1o"}},[t._v("参数")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-np5-mj6-q10"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-i36-lam-n3u"}},[t._v("类型")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-qtp-9pd-af9"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-kwk-r0w-a91"}},[t._v("说明")])])]),s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-al8-rkc-sn4"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-ush-335-j7q"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-of2-5v9-ffw"}},[t._v("code")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-3q1-nwi-xf2"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-zl7-aoy-roh"}},[t._v("Integer")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-g86-zmk-ydo"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-cb2-qkr-p47"}},[t._v("200代表HTTP请求成功")]),s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-lhv-sza-ksz"}},[t._v("其他代表HTTP请求失败，")]),s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-3mb-0t5-hl3"}},[t._v("在使用时需要判断该返回值")])])]),s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-da1-bk2-xxj"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-6t9-8gu-irq"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-6ny-2pq-qwf"}},[t._v("data")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-u38-rcn-eyb"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-mno-fwn-jbm"}},[t._v("String")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-b5x-wx8-ivy"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-sfq-sac-all"}},[t._v("返回的HTTP BODY")])])])])]),t._v(" "),s("p",[t._v("使用示例")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" response "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" httpPlugin"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("httpPostJson")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/api/test'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'{"name":"abc"}\'')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("code "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//这里需要对response.data的数据处理")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"_3-日志打印"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-日志打印"}},[t._v("#")]),t._v(" 3. 日志打印")]),t._v(" "),s("h4",{attrs:{id:"_3-1-api-log-format-args"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-api-log-format-args"}},[t._v("#")]),t._v(" 3.1 API: log(format，..args)")]),t._v(" "),s("p",[t._v("用途：格式化日志打印")]),t._v(" "),s("table",{staticClass:"table",attrs:{"data-tag":"table",id:"table-h8d-dc2-y50"}},[s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-23g-jyu-i44",colwidth:"1*",colnum:"1",colname:"col1"}}),s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-i4w-2re-kqy",colwidth:"1*",colnum:"2",colname:"col2"}}),s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-5nh-frw-tok",colwidth:"1*",colnum:"3",colname:"col3"}}),s("tbody",{staticClass:"tbody",attrs:{"data-tag":"tbody",id:"tbody-ypt-fe4-hgg"}},[s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-wet-6on-x3w"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-hnv-864-ood"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-vzu-w4f-2ru"}},[t._v("参数")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-81k-s70-xbi"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-mkk-mr4-nhp"}},[t._v("类型")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-go7-80t-xiy"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-8o2-u5m-bz5"}},[t._v("说明")])])]),s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-x33-hkd-5zi"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-zo5-96t-y9j"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-ie4-ldr-k5n"}},[t._v("format")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-eka-4dk-dsm"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-a66-z3m-bj8"}},[t._v("String")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-x2e-0wd-br1"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-h60-5y1-k01"}},[t._v("支持%s，%d，%c，%f等通用的格式转换符号")])])]),s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-pnu-bba-byz"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-pxa-r2h-kbn",colspan:"1"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-ndg-fbp-3hv"}},[t._v("args")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-zb2-hzu-lvl",colspan:"1"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-vqk-3x8-i07"}},[t._v("Object...")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-rhr-yku-wrn",colspan:"1"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-ztn-8mb-5q1"}},[t._v("需要打印的参数，可以为多个")])])])])]),t._v(" "),s("p",[t._v("返回值")]),t._v(" "),s("p",[t._v("使用示例")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" iotPluginApi "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./iotPlugin.js'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("transform")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("eventType"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("msgPayLoadList")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n   iotPluginApi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"toJSONString %s"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("utils"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("toJSONString")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("msgPayLoadList"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h4",{attrs:{id:"_3-2-api-log-object"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-api-log-object"}},[t._v("#")]),t._v(" 3.2 API: log(object)")]),t._v(" "),s("p",[t._v("用途： 日志打印")]),t._v(" "),s("table",{staticClass:"table",attrs:{"data-tag":"table",id:"table-e0s-3rw-loa"}},[s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-7ci-c1y-j1r",colwidth:"1*",colnum:"1",colname:"col1"}}),s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-b6d-yoh-43f",colwidth:"1*",colnum:"2",colname:"col2"}}),s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-74h-jmv-j4t",colwidth:"1*",colnum:"3",colname:"col3"}}),s("tbody",{staticClass:"tbody",attrs:{"data-tag":"tbody",id:"tbody-z0n-347-58g"}},[s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-4mb-7je-1tz"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-4fp-nea-cup"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-jbo-k0g-nuy"}},[t._v("参数")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-s11-80a-qov"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-xho-dtg-t1j"}},[t._v("类型")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-75r-r9b-ttk"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-ae1-vs1-45j"}},[t._v("说明")])])]),s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-gbv-1of-re5"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-bzo-2mt-xn5"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-l4g-paj-yin"}},[t._v("object")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-suk-5fy-mdn"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-smj-ugv-otn"}},[t._v("Object")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-q0g-m9v-oat"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-o80-f8a-314"}},[t._v("需要打印的对象，可以为String，也可以为其他类型，如果是其他类型，则默认转成相应的String打印出来")])])])])]),t._v(" "),s("p",[t._v("返回值")]),t._v(" "),s("p",[t._v("使用示例")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" iotPluginApi "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./iotPlugin.js'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("transform")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("eventType"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("msgPayLoadList")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    iotPluginApi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("eventType"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  iotPluginApi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("msgPayLoadList"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  iotPluginApi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'this is msgPlayLoad:'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("msgPayLoadList"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"_4-触发报警通知"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-触发报警通知"}},[t._v("#")]),t._v(" 4. 触发报警通知")]),t._v(" "),s("p",[t._v("API: "),s("strong",[t._v("t"),s("strong",[s("strong",[t._v("riggerAlarm")])]),t._v("(param)")])]),t._v(" "),s("p",[t._v("用途： 用于在JS脚本中触发一条报警消息到云端的数字工厂，可以指定接收报警的人员，角色和组织。")]),t._v(" "),s("table",{staticClass:"table",attrs:{"data-tag":"table",id:"table-l0g-uks-pqs"}},[s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-drm-ogm-ltt",colwidth:"1*",colnum:"1",colname:"col1"}}),s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-1qs-4te-vgu",colwidth:"1*",colnum:"2",colname:"col2"}}),s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-18u-fbd-4z0",colwidth:"1*",colnum:"3",colname:"col3"}}),s("tbody",{staticClass:"tbody",attrs:{"data-tag":"tbody",id:"tbody-99l-y3f-1xm"}},[s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-u3o-mfd-j0h"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-whf-fzb-iiu"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-q2m-z2x-l29"}},[t._v("参数")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-dp6-cl1-k6d"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-mwk-sem-fxj"}},[t._v("类型")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-3vj-i4u-t64"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-6yu-lki-azi"}},[t._v("说明")])])]),s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-yqu-4fr-sq1"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-pi8-0m0-706"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-8kv-pmq-ntr"}},[t._v("param")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-akg-t7z-ev2"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-ac8-ruf-2d3"}},[t._v("Map<String，Object>")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-i3t-cxn-uhh"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-727-qy7-wcq"}},[t._v("param为一个Map结构")])])]),s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-fv5-x5b-8ny"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-yfe-1ex-87y",colspan:"1"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-g0p-oo2-5cg"}},[t._v("param的具体定义如下")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-qjl-bst-3zq",colspan:"1"}}),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-c46-52y-81n",colspan:"1"}})]),s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-cur-fvk-gx5"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-dmf-fag-qir",colspan:"1"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-3xy-t2l-q0j"}},[t._v("level")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-243-vtf-7t6",colspan:"1"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-lyc-vx9-ry6"}},[t._v("Integer")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-bnu-7bv-bod",colspan:"1"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-phs-tgl-k0j"}},[t._v("报警级别")]),s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-2c8-e1z-sjl"}},[t._v("0：提醒")]),s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-hpy-ht5-sem"}},[t._v("1： 故障")]),s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-1i4-6ez-m4k"}},[t._v("2：报警")])])]),s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-tg4-d1h-6pm"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-e6x-mqi-jb1",colspan:"1"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-zo9-ye3-xdt"}},[t._v("receiverList")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-j5y-ivx-g01",colspan:"1"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-odt-75m-ah8"}},[t._v("List<String>")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-nwt-ttl-4yy",colspan:"1"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-qe8-1v3-xuy"}},[t._v("消息接收者的code码集合。")]),s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-k9w-cyq-3tq"}},[t._v("如果receiverType为role，则为角色码，如果receiverType为user，则为identityId，如果receiverType为organization，则为组织ID。")])])]),s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-uxr-02n-wg6"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-4k9-q9d-qpo",colspan:"1"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-33c-77o-zw8"}},[t._v("receiverType")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-72y-vi7-qdw",colspan:"1"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-xaq-m9j-uau"}},[t._v("String")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-6vv-3rh-r8m",colspan:"1"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-1r4-ysu-uti"}},[t._v("role：角色")]),s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-sgg-8ha-b9z"}},[t._v("user：人员")]),s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-0q3-pcy-cos"}},[t._v("organization：组织")]),s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-80o-8rz-pfe"}},[t._v("说明：管理员的特殊角色码为ADMINISTRATOR")])])]),s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-5uw-chw-9h2"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-ul9-ozq-8al",colspan:"1"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-7aj-9ok-7nc"}},[t._v("title")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-gdp-b83-9yz",colspan:"1"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-ant-eo8-z1e"}},[t._v("String")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-liz-5ep-4d7",colspan:"1"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-a7j-3xo-696"}},[t._v("报警的标题")])])]),s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-2s8-4ka-4pp"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-7cl-guc-go2",colspan:"1"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-pzf-xfu-tw5"}},[t._v("content")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-400-y7x-tjp",colspan:"1"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-kw6-m8d-daw"}},[t._v("String")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-isj-kgz-vwd",colspan:"1"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-dgf-fjb-hht"}},[t._v("报警的内容")])])])])]),t._v(" "),s("table",{staticClass:"table",attrs:{"data-tag":"table",id:"table-jjl-cq1-d89"}},[s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-4su-e58-l7o",colwidth:"1*",colnum:"1",colname:"col1"}}),s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-wo5-p7b-u42",colwidth:"1*",colnum:"2",colname:"col2"}}),s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-s99-yiv-m84",colwidth:"1*",colnum:"3",colname:"col3"}}),s("tbody",{staticClass:"tbody",attrs:{"data-tag":"tbody",id:"tbody-ptk-ust-en7"}},[s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-k7i-1vc-ims"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-l2d-lxe-tq7"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-iw8-rkv-6d9"}},[t._v("参数")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-n23-j1r-fvt"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-a54-o3a-dcc"}},[t._v("类型")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-0q5-2i3-tsr"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-gdy-r1x-7u3"}},[t._v("说明")])])]),s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-530-bgq-eqz"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-jmc-ohf-hiu"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-yxp-qrh-tb1"}},[t._v("code")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-unm-y7h-f2e"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-cq0-uh4-om5"}},[t._v("Integer")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-fit-dzb-ezn"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-5fh-xko-z6f"}},[t._v("200代表执行成功")]),s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-88i-frd-zz7"}},[t._v("其他代表执行失败，")]),s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-gw9-6fm-405"}},[t._v("在使用时需要判断该返回值")])])]),s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-j3z-acj-06a"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-54t-yp4-m18",colspan:"1"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-wph-pkf-1xv"}},[t._v("data")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-18z-8mg-dep",colspan:"1"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-26j-yht-6qq"}},[t._v("Object")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-paj-f6f-oen",colspan:"1"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-og0-kqa-esi"}},[t._v("无返回，为null")])])])])]),t._v(" "),s("p",[t._v("使用示例")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" iotPluginApi "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./iotPlugin.js'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" Map "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Java"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'java.util.HashMap'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("transform")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("eventType"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("msgPayLoadList")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" transformResultList "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Array")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" receveiverList "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ADMINISTRATOR'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 这里填入报警的相关参数")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" triggerParam "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Map")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n   triggerParam"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("put")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"level"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n   triggerParam"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("put")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"receiverList"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("receveiverList"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n   triggerParam"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("put")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"receiverType"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"role"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n   triggerParam"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("put")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"title"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"边缘数据集成报警内容自定义标题"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n   triggerParam"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("put")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'content'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"边缘数据集成报警内容:产线异常"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  \n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 这里为调用扩展API触发报警")]),t._v("\n   iotPluginApi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("triggerAlarm")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("triggerParam"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  \n     "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" transformResultList"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"_5-获取设备的属性"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-获取设备的属性"}},[t._v("#")]),t._v(" 5. 获取设备的属性")]),t._v(" "),s("p",[s("strong",[t._v("API: cloudThingPropertiesGet(param)")])]),t._v(" "),s("p",[t._v("用途：获取物联网设备的属性")]),t._v(" "),s("p",[t._v("入参列表")]),t._v(" "),s("p",[t._v("|\n入参名称")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("数据类型")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("是否必须")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("入参描述")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th")])]),t._v(" "),s("tbody",[s("tr",[s("td")])])]),t._v(" "),s("p",[t._v("param")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("Map<String，Object>")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("param")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("param")]),t._v(" "),s("p",[t._v("|\n|")]),t._v(" "),s("p",[t._v("param的具体定义如下")]),t._v(" "),s("p",[t._v("|  |  |  |\n|")]),t._v(" "),s("p",[t._v("iotId")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("字符串")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("否")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("设备ID，生活物联网平台为设备颁发的ID，设备的唯一标识符。productKey和deviceName为空时，该入参不允许为空。")]),t._v(" "),s("p",[t._v("|\n|")]),t._v(" "),s("p",[t._v("productKey")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("字符串")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("否")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("产品的Key，设备证书信息之一。创建产品时，生活物联网平台为该产品颁发的全局唯一标识。当iotId为空时，该参数不允许为空。")]),t._v(" "),s("p",[t._v("|\n|")]),t._v(" "),s("p",[t._v("deviceName")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("字符串")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("否")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("设备的名称，设备证书信息之一。在注册设备时，自定义的或系统生成的设备名称，具备产品维度内的唯一性。当iotId为空时，该参数不允许为空。")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("返回值")]),t._v(" "),s("table",{staticClass:"table",attrs:{"data-tag":"table",id:"table-06p-qzo-z2s"}},[s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-x7h-3nm-zgv",colwidth:"1*",colnum:"1",colname:"col1"}}),s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-17t-8q7-uoe",colwidth:"1*",colnum:"2",colname:"col2"}}),s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-9bt-dme-fqk",colwidth:"1*",colnum:"3",colname:"col3"}}),s("tbody",{staticClass:"tbody",attrs:{"data-tag":"tbody",id:"tbody-lb3-m90-fju"}},[s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-lpi-yyn-wr0"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-l7c-moa-lzj"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-nuw-kf7-gxj"}},[t._v("参数")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-d3p-mnq-wmz"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-6qy-nti-gv7"}},[t._v("类型")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-7vo-c3z-o8n"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-8dp-4xh-9kz"}},[t._v("说明")])])]),s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-elq-dqs-na3"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-1tg-j8v-7s5"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-21r-y4q-rix"}},[t._v("code")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-asw-mpv-0kk"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-w45-yhw-usf"}},[t._v("Integer")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-6ml-kuy-izf"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-gl7-nz1-mdd"}},[t._v("200代表执行成功")]),s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-r07-vqg-a22"}},[t._v("其他代表执行失败，")]),s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-gws-rnt-zk0"}},[t._v("在使用时需要判断该返回值")])])]),s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-vvv-xru-xvq"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-w4v-n8f-ytb",colspan:"1"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-m3u-vnr-14j"}},[t._v("data")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-1ts-5p5-t84",colspan:"1"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-fsm-pak-ur9"}},[t._v("Object")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-q73-pvn-ry2",colspan:"1"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-ld2-9b8-lgv"}},[t._v("无返回，为null")])])])])]),t._v(" "),s("p",[t._v("使用示例")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" iotPluginApi "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./iotPlugin.js'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" Map "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Java"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'java.util.HashMap'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("transform")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("eventType"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("msgPayLoadList")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" getParam "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Map")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  getParam"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("put")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"productKey"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"a17nEF9qLYJ"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  getParam"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("put")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"deviceName"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mIwfRzXY9wLpRFz5RfJJ"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" result "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" iotPluginApi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("cloudThingPropertiesGet")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("getParam"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("result"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("code "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      iotPluginApi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"获取物的属性成功"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      iotPluginApi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"属性值为 %s"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("utils"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("toJSONString")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("result"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"_6-设置设备的属性"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-设置设备的属性"}},[t._v("#")]),t._v(" 6. 设置设备的属性")]),t._v(" "),s("p",[s("strong",[t._v("API:")]),t._v(" "),s("strong",[t._v("cloudThingPropertiesSet")]),t._v("**(param)**")]),t._v(" "),s("p",[t._v("入参列表")]),t._v(" "),s("p",[t._v("|\n入参名称")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("数据类型")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("是否必须")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("入参示例")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("入参描述")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th")])]),t._v(" "),s("tbody",[s("tr",[s("td")])])]),t._v(" "),s("p",[t._v("iotId")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("字符串")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("否")]),t._v(" "),s("p",[t._v("|  |")]),t._v(" "),s("p",[t._v("设备ID，物联网平台为设备颁发的ID，设备的唯一标识符。productKey和deviceName为空时，该入参不允许为空")]),t._v(" "),s("p",[t._v("|\n|")]),t._v(" "),s("p",[t._v("items")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("JSON")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("是")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("{}")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("set参数")]),t._v(" "),s("p",[t._v("|\n|")]),t._v(" "),s("p",[t._v("productKey")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("字符串")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("否")]),t._v(" "),s("p",[t._v("|  |")]),t._v(" "),s("p",[t._v("产品的Key，设备证书信息之一。创建产品时，生活物联网平台为该产品颁发的全局唯一标识。当iotId为空时，该参数不允许为空")]),t._v(" "),s("p",[t._v("|\n|")]),t._v(" "),s("p",[t._v("deviceName")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("字符串")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("否")]),t._v(" "),s("p",[t._v("|  |")]),t._v(" "),s("p",[t._v("设备的名称，设备证书信息之一。在注册设备时，自定义的或系统生成的设备名称，具备产品维度内的唯一性。当iotId为空时，该参数不允许为空")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("返回值")]),t._v(" "),s("table",{staticClass:"table",attrs:{"data-tag":"table",id:"table-fi8-tlt-7lp"}},[s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-uqa-ahv-ppp",colwidth:"1*",colnum:"1",colname:"col1"}}),s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-qpx-sg2-6k6",colwidth:"1*",colnum:"2",colname:"col2"}}),s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-sy9-gh3-rju",colwidth:"1*",colnum:"3",colname:"col3"}}),s("tbody",{staticClass:"tbody",attrs:{"data-tag":"tbody",id:"tbody-nl7-wne-r4h"}},[s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-vr9-dhl-ypw"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-y2t-72l-7ds"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-w5z-13u-g58"}},[t._v("参数")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-f47-r2n-xm7"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-xk6-jvn-hxi"}},[t._v("类型")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-dob-pes-mif"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-m4r-fxp-88h"}},[t._v("说明")])])]),s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-crc-5dy-xja"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-pmo-m7v-4uo"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-mcm-qcn-f34"}},[t._v("code")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-uj6-4bz-6lc"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-r9y-je9-0b2"}},[t._v("Integer")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-y22-dyt-swm"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-a3p-gl1-7ck"}},[t._v("200代表执行成功")]),s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-v88-psw-gwa"}},[t._v("其他代表执行失败，")]),s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-q23-d06-p9c"}},[t._v("在使用时需要判断该返回值")])])]),s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-5td-k2z-f9g"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-8ka-sgw-02p",colspan:"1"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-zl4-usy-k3m"}},[t._v("data")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-cqz-znp-cmd",colspan:"1"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-r17-nes-nia"}},[t._v("Object")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-56t-js1-ej3",colspan:"1"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-v8b-nca-7je"}},[t._v("无返回，为null")])])])])]),t._v(" "),s("p",[t._v("使用示例")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" iotPluginApi "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./iotPlugin.js'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" Map "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Java"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'java.util.HashMap'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("transform")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("eventType"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("msgPayLoadList")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" param "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Map")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" serviceParam "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Map")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  param"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("put")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"productKey"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"a17nEF9qLYJ"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  param"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("put")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"deviceName"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mIwfRzXY9wLpRFz5RfJJ"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  serviceParam"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("put")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"wendu"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  serviceParam"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("put")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"shidu"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  param"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("put")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"items"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("serviceParam"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" result "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" iotPluginApi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("cloudThingPropertiesSet")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("param"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("result"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("code "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      iotPluginApi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"设置物的属性成功"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"_7-调用设备的服务"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-调用设备的服务"}},[t._v("#")]),t._v(" 7. 调用设备的服务")]),t._v(" "),s("p",[s("strong",[t._v("API:")]),t._v(" "),s("strong",[t._v("cloudThingServiceInvoke")])]),t._v(" "),s("p",[t._v("入参列表")]),t._v(" "),s("p",[t._v("|\n入参名称")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("数据类型")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("是否必须")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("入参示例")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("入参描述")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th")])]),t._v(" "),s("tbody",[s("tr",[s("td")])])]),t._v(" "),s("p",[t._v("iotId")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("字符串")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("否")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("xxxxxxxx")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("设备ID，物联网平台为设备颁发的ID，设备的唯一标识符。productKey和deviceName为空时，该入参不允许为空")]),t._v(" "),s("p",[t._v("|\n|")]),t._v(" "),s("p",[t._v("identifier")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("字符串")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("是")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("xxxxxxxx")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("服务的标识符")]),t._v(" "),s("p",[t._v("|\n|")]),t._v(" "),s("p",[t._v("args")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("JSON")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("是")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("{}")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("服务入参")]),t._v(" "),s("p",[t._v("|\n|")]),t._v(" "),s("p",[t._v("productKey")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("字符串")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("是")]),t._v(" "),s("p",[t._v("|  |")]),t._v(" "),s("p",[t._v("产品的Key，设备证书信息之一。创建产品时，生活物联网平台为该产品颁发的全局唯一标识。当iotId为空时，该参数不允许为空")]),t._v(" "),s("p",[t._v("|\n|")]),t._v(" "),s("p",[t._v("deviceName")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("字符串")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("是")]),t._v(" "),s("p",[t._v("|  |")]),t._v(" "),s("p",[t._v("设备的名称，设备证书信息之一。在注册设备时，自定义的或系统生成的设备名称，具备产品维度内的唯一性。当iotId为空时，该参数不允许为空")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("返回值")]),t._v(" "),s("table",{staticClass:"table",attrs:{"data-tag":"table",id:"table-q3o-d36-hms"}},[s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-u38-7cd-0zf",colwidth:"1*",colnum:"1",colname:"col1"}}),s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-wkc-hnu-xkd",colwidth:"1*",colnum:"2",colname:"col2"}}),s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-up6-v7y-kvx",colwidth:"1*",colnum:"3",colname:"col3"}}),s("tbody",{staticClass:"tbody",attrs:{"data-tag":"tbody",id:"tbody-awk-47y-d6s"}},[s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-za4-tbj-htc"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-fkd-o3q-qpy"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-dgi-8ym-zv5"}},[t._v("参数")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-0et-f6x-2nw"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-ffw-a1v-p0i"}},[t._v("类型")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-fte-uml-jlk"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-wyf-bhj-akm"}},[t._v("说明")])])]),s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-ddh-f0i-cg6"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-gm6-rez-gv4"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-nv0-y3k-wd3"}},[t._v("code")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-l4s-kp6-6ch"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-ejc-cpi-toh"}},[t._v("Integer")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-0o0-rql-ket"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-k8r-s4r-pms"}},[t._v("200代表执行成功")]),s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-q83-wss-i9x"}},[t._v("其他代表执行失败，")]),s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-js2-opc-s33"}},[t._v("在使用时需要判断该返回值")])])]),s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-3xk-4yz-vfx"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-jyg-59m-htd",colspan:"1"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-b27-g9l-vyf"}},[t._v("data")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-xh6-3ap-7sq",colspan:"1"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-2xn-jvu-2tz"}},[t._v("Object")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-rd3-f20-3ha",colspan:"1"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-weg-rhs-isu"}},[t._v("无返回，为null")])])])])]),t._v(" "),s("p",[t._v("使用示例")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" iotPluginApi "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./iotPlugin.js'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" Map "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Java"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'java.util.HashMap'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("transform")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("eventType"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("msgPayLoadList")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" param "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Map")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" args "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Map")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  param"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("put")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"productKey"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"a17nEF9qLYJ"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  param"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("put")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"deviceName"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mIwfRzXY9wLpRFz5RfJJ"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  param"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("put")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"identifier"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"start"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  args"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("put")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"param1"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  args"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("put")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"param2"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  param"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("put")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"args"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("args"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" result "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" iotPluginApi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("cloudThingServiceInvoke")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("param"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("result"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("code "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      iotPluginApi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"调用物的服务成功"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      iotPluginApi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"返回值为 %s"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("utils"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("toJSONString")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("result"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"_8-工具函数utils"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-工具函数utils"}},[t._v("#")]),t._v(" 8. 工具函数utils")]),t._v(" "),s("h4",{attrs:{id:"_8-1-api-sleep-ms"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-1-api-sleep-ms"}},[t._v("#")]),t._v(" 8.1 API: sleep(ms)")]),t._v(" "),s("p",[t._v("用途： 用于在JS脚本中休眠sleep")]),t._v(" "),s("p",[t._v("返回值")]),t._v(" "),s("p",[t._v("使用示例")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//引用iot扩展Api模块,必须引用")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" iotPluginApi "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./iotPlugin.js'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("transform")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("eventType"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("msgPayLoadList")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    utils"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sleep")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    iotPluginApi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"sleep 1 seconds"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h4",{attrs:{id:"_8-2-api-tojsonstring-param"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-2-api-tojsonstring-param"}},[t._v("#")]),t._v(" 8.2 API: toJSONString(param);")]),t._v(" "),s("p",[t._v("用途： 用于在JS中将一个JS对象转成JSON字符串5.1 API: "),s("strong",[t._v("sle"),s("strong",[s("strong",[t._v("ep")])]),t._v("(ms);")])]),t._v(" "),s("table",{staticClass:"table",attrs:{"data-tag":"table",id:"table-vds-qsx-42n"}},[s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-3m8-4fg-mgk",colwidth:"1*",colnum:"1",colname:"col1"}}),s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-msa-k5r-o3b",colwidth:"1*",colnum:"2",colname:"col2"}}),s("colgroup",{staticClass:"col",attrs:{width:"240",span:"1","data-tag":"col",id:"col-r6m-f71-tk4",colwidth:"1*",colnum:"3",colname:"col3"}}),s("tbody",{staticClass:"tbody",attrs:{"data-tag":"tbody",id:"tbody-5t9-s9x-r1g"}},[s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-pfr-3a5-zoj"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-6pj-ru9-ism"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-05j-5bv-rt1"}},[t._v("参数")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-h34-rsp-4xz"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-gs7-ghm-myz"}},[t._v("类型")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-pz5-3sw-y6e"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-zrw-1d6-73j"}},[t._v("说明")])])]),s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-4k3-hfq-y2h"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-tcl-7o8-9y3"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-8wg-rrn-jpo"}},[s("b",[s("u",{staticClass:"u",attrs:{"data-tag":"u"}},[t._v("param")])])])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-6li-kho-jww"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-krv-svv-5ex"}},[t._v("Object")])]),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-yr0-oaq-e99"}},[s("p",{staticClass:"p",attrs:{"data-tag":"p",id:"p-gwy-ym0-1p2"}},[t._v("需要转换的JS对象，比如为Map，List可以JSON序列化的对象")])])]),s("tr",{staticClass:"tr",attrs:{"data-tag":"tr",id:"tr-4ln-sig-lry"}},[s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-fkh-whe-y8n",colspan:"1"}}),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-s19-4xf-lxz",colspan:"1"}}),s("td",{staticClass:"td",attrs:{"data-tag":"td",id:"td-co6-s1f-dau",colspan:"1"}})])])]),t._v(" "),s("p",[t._v("返回值")]),t._v(" "),s("p",[t._v("使用示例")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//引用iot扩展Api模块,必须引用")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" iotPluginApi "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./iotPlugin.js'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("transform")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("eventType"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("msgPayLoadList")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n     iotPluginApi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"toJSONString %s"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("utils"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("toJSONString")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("msgPayLoadList"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("8.3 全局变量")]),t._v(" "),s("p",[t._v("读取、存储、删除全局变量，在JS中调用。")]),t._v(" "),s("p",[t._v("|\n方法")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("说明")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th")])]),t._v(" "),s("tbody",[s("tr",[s("td")])])]),t._v(" "),s("p",[s("strong",[t._v("utils.getVar(key）")])]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("读取一个变量")]),t._v(" "),s("p",[t._v("|\n|")]),t._v(" "),s("p",[s("strong",[t._v("utils.putVar(key）")])]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("存储一个变量")]),t._v(" "),s("p",[t._v("|\n|")]),t._v(" "),s("p",[s("strong",[t._v("utils.removeVar(key）")])]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("删除一个变量")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("8.4 API: 时间格式化")]),t._v(" "),s("p",[s("strong",[t._v("（1）formatDate")]),t._v("**(timestamp, unitName, pattern)**")]),t._v(" "),s("p",[t._v("|\n参数")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("类型")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("说明")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th")])]),t._v(" "),s("tbody",[s("tr",[s("td")])])]),t._v(" "),s("p",[s("strong",[t._v("timestamp")])]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("Long")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("时间戳")]),t._v(" "),s("p",[t._v("|\n|")]),t._v(" "),s("p",[s("strong",[t._v("unitName")])]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("String")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("时间单位")]),t._v(" "),s("p",[s("em",[t._v("NANOSECONDS - 纳秒")])]),t._v(" "),s("p",[s("em",[t._v("MICROSECONDS - 微秒")])]),t._v(" "),s("p",[s("em",[t._v("MILLISECONDS - 毫秒")])]),t._v(" "),s("p",[s("em",[t._v("SECONDS - 秒")])]),t._v(" "),s("p",[s("em",[t._v("DAYS - 天")])]),t._v(" "),s("p",[t._v("|\n|")]),t._v(" "),s("p",[s("strong",[t._v("pattern")])]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("String")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("yyyy-MM-dd hh:mm:ss")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("返回值")]),t._v(" "),s("p",[t._v("|\n参数")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("类型")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("说明")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th")])]),t._v(" "),s("tbody",[s("tr",[s("td")])])]),t._v(" "),s("p",[t._v("String")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("格式化时间字符串")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("返回值")]),t._v(" "),s("div",{staticClass:"language-auto extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('//引用iot扩展Api模块,必须引用\nvar iotPluginApi = require(\'./iotPlugin.js\');\n\nfunction transform(eventType,msgPayLoadList){\n  masterData["DatetimeX"] = utils.formatDate(msgPayload["DateTimeX"], "NANOSECONDS", "yyyy-MM-dd HH:mm:ss");\n  masterData["TimestampX"] = utils.formatDate(msgPayload["TsX"], "NANOSECONDS", "yyyy-MM-dd HH:mm:ss");\n  masterData["DateX"] = utils.formatDate(msgPayload["DateX"], "DAYS", "yyyy-MM-dd");\n  masterData["TimeX"] = utils.formatDate(msgPayload["TimeX"], "MICROSECONDS", "HH:mm:ss");\n}\n')])])]),s("p",[s("strong",[t._v("（2）formatDate")]),t._v("**(datetime, pattern)**")]),t._v(" "),s("p",[t._v("|\n参数")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("类型")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("说明")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th")])]),t._v(" "),s("tbody",[s("tr",[s("td")])])]),t._v(" "),s("p",[s("strong",[t._v("timestamp")])]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("Long")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("时间戳")]),t._v(" "),s("p",[t._v("|\n|")]),t._v(" "),s("p",[s("strong",[t._v("pattern")])]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("String")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("yyyy-MM-dd hh:mm:ss")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("返回值")]),t._v(" "),s("p",[t._v("|\n参数")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("类型")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("说明")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th")])]),t._v(" "),s("tbody",[s("tr",[s("td")])])]),t._v(" "),s("p",[t._v("String")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("格式化时间字符串")]),t._v(" "),s("p",[t._v("|")]),t._v(" "),s("p",[t._v("返回值")]),t._v(" "),s("div",{staticClass:"language-auto extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("//引用iot扩展Api模块,必须引用\nvar iotPluginApi = require('./iotPlugin.js');\n\nfunction transform(eventType,msgPayLoadList){\n  let datestr = utils.formatDate(datetime, \"yyyy-MM-dd HH:mm:ss\");\n}\n")])])]),s("p",[t._v("9 环境变量")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/7878664061/p180016.png",alt:"环境变量"}}),t._v('在输入/输出/转换节点的脚本函数中，都用一个context记录作业的上下文，context.envConfig.get("参数名") 可以读取到边缘数据集成中已经配置的参数值。')]),t._v(" "),s("p",[t._v("10 JS插件")]),t._v(" "),s("p",[t._v("写好一个插件，上传到边缘数据集成配置中，可以被这个配置中的任务一个作业节点脚本引用。")]),t._v(" "),s("p",[t._v("典型例子：写好一个API登录检测的包，在输入输出节点脚本中调用。")]),t._v(" "),s("div",{staticClass:"language-auto extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('var httpPlugin = require(\'./../httpPlugin.js\');\n\nvar token = null;\n//上次使用token的时间\nvar token_time = 0;\n\nfunction getToken(name, password) {\n if (new Date().getTime() - token_time > 1000*30) {\n  //模拟获取Token的过程\n  let response = httpPlugin.httpPostJson("/api/getToken", {"name":name, "pwd": password});\n  if (response.code === 200) {\n   token = response.data;\n  } else {\n   console.log("GetToken error:" + response.code);\n      return null;\n  }\n }\n token_time = new Date().getTime();\n return token;\n}\n\nmodule.exports.getToken = getToken;\n')])])]),s("h2",{attrs:{id:"常见问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#常见问题"}},[t._v("#")]),t._v(" 常见问题")]),t._v(" "),s("ol",[s("li",[t._v("JS的变量提升问题")])]),t._v(" "),s("p",[t._v("说明：在脚本中经常需要在函数中实现较多的转换逻辑，而这里需要注意的是JavaScript(ES5)中的var变量的作用域跟Java和C的作用域不同，否则会出现函数中的变量被覆盖的情况，导致各种问题，例如死循环。")]),t._v(" "),s("p",[t._v("在大多数编程语言中，会用花括号"),s("code",[t._v("{}")]),t._v("来形成一个作用域，俗称“块作用域”，例如C语言、C++等。但是在JS中"),s("code",[t._v("{}")]),t._v("并不能产生块作用域，JS中的作用域是依靠函数形成的。")]),t._v(" "),s("p",[t._v("在ECMAScript5中，JS只有两类作用域：全局作用域、函数作用域。")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("全局作用域：全局对象的作用域，在代码的任何地方都可访问，但有时会被函数作用域覆盖")])]),t._v(" "),s("li",[s("p",[t._v("函数作用域：作用于整个函数范围内，不管到底是在函数中的何处进行声明")])])]),t._v(" "),s("p",[t._v("在最新的数字工厂脚本引擎版本中，已经支持了ES6的let和const语法，建议在编写脚本的时候使用let和const以避免该问题的产生。")]),t._v(" "),s("h2",{attrs:{id:"调试方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#调试方法"}},[t._v("#")]),t._v(" 调试方法")]),t._v(" "),s("h3",{attrs:{id:"_1-调试转换节点的脚本函数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-调试转换节点的脚本函数"}},[t._v("#")]),t._v(" 1. 调试转换节点的脚本函数")]),t._v(" "),s("p",[t._v("在创建一个数据集成任务后，需要在作业任务的转换节点编写转换函数（即transform函数，默认有参考代码），")]),t._v(" "),s("p",[t._v("在编写完该函数后，可以通过mock数据的方法来运行该函数，并进行日志打印和结果输出。")]),t._v(" "),s("p",[t._v("步骤")]),t._v(" "),s("ol",[s("li",[t._v("登录oc.supet.com，进入平台管理-》边缘计算-》选择一个数据集成任务-》编辑-》任务列表-》")])]),t._v(" "),s("p",[t._v("点击转换节点的“配置”按钮；")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/2218359951/p131996.png",alt:"image.png",title:"image.png"}})]),t._v(" "),s("p",[t._v("mock参数说明：mock参数是在点击调试的时候，transform函数的入参：msgPayLoad 其类型为一个Map<String，Object>类型。")]),t._v(" "),s("h3",{attrs:{id:"_2-查看js的调试日志"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-查看js的调试日志"}},[t._v("#")]),t._v(" 2. 查看JS的调试日志")]),t._v(" "),s("p",[t._v("在调试阶段，可以在云端直接针对某个集成任务进行实时调试，即脚本在边缘运行时，日志可以实时输出到云端的调试窗口中，该功能主要帮助在开发、调试阶段查看脚本的运行结果和日志情况。")]),t._v(" "),s("p",[t._v("2.1 在边缘数据集成中选择一个需要调试的任务，点击调试。")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/2218359951/p131997.png",alt:"image.png",title:"image.png"}})]),t._v(" "),s("p",[t._v("2.2 通过修改数据库或者其他方法触发数据变化，然后查看脚本的日志打印")]),t._v(" "),s("h3",{attrs:{id:"_3-查看js的运行日志"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-查看js的运行日志"}},[t._v("#")]),t._v(" 3. 查看JS的运行日志")]),t._v(" "),s("p",[t._v("当调试完一个脚本后，需要将该脚本正式下发到边缘应用，以正式数据集成。")]),t._v(" "),s("p",[t._v("数据集成时可能会产生全量数据，增量数据，进而出发脚本运行，如果需要查看运行中的JS日志，可以通过如下方法查看：")]),t._v(" "),s("p",[t._v("进入边缘数据集成-》点击查看日志")]),t._v(" "),s("p",[t._v("输入阿里云账号和密码：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/2218359951/p131999.png",alt:"image.png",title:"image.png"}})]),t._v(" "),s("p",[t._v("打开SLS日志窗口后，输入关键字“JsScriptLog”进行搜索查看。")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/2218359951/p132000.png",alt:"image.png",title:"image.png"}})]),t._v(" "),s("h2",{attrs:{id:"作业节点脚本函数说明"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#作业节点脚本函数说明"}},[t._v("#")]),t._v(" 作业节点脚本函数说明")]),t._v(" "),s("h3",{attrs:{id:"_1-输入节点"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-输入节点"}},[t._v("#")]),t._v(" 1. 输入节点")]),t._v(" "),s("p",[t._v("输入节点类型是“数据库增量”、“服务提供”、“API上传”的情况不需要编写脚本。")]),t._v(" "),s("h4",{attrs:{id:"_1-1-数据库查询"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-数据库查询"}},[t._v("#")]),t._v(" 1.1 数据库查询")]),t._v(" "),s("p",[t._v("方法一：获取整张表的全量数据，增量数据由系统计算两次SELECT之间的差别。")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n *\n * @param snapshotType full=全量同步，increment=增量同步，retry=重传数据\n * @param context\n *     context.snapshotOffset：记录目前偏移值，类型是数字、文本、MAP\n *     context.snapshotDiffDelete：是否计算删除增量\n *     context.snapshotRetryKeys：重传的唯一标识，Map类型，只有在snapshotType=retry才有值\n */")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("snapshot")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("snapshotType"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" context")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//扫描整张表读取全量数据")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" iotPluginApi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("newDbSnapshot")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"SELECT * FROM dbo.BG_Item"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("方法二：完整的实现全量、增量、重传")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n *\n * @param snapshotType full=全量同步，increment=增量同步，retry=重传数据\n * @param context\n *     context.snapshotOffset：记录目前偏移值，类型是数字、文本、MAP\n *     context.snapshotDiffDelete：是否计算删除增量\n *     context.snapshotRetryKeys：重传的唯一标识，Map类型，只有在snapshotType=retry才有值\n */")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("snapshot")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("snapshotType"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" context")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("snapshotType "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'increment'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//扫描整张表来计算增量")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" iotPluginApi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("newDbSnapshot")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"SELECT * FROM dbo.BG_Item"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('/* 高级用法：\n        //自定义增量\n        if (context.snapshotOffset == null) {\n            context.snapshotOffset = utils.currentTimeMillis();\n        }\n        let sql = "SELECT * FROM dbo.TB WHERE timestamp > " + context.snapshotOffset;\n        context.snapshotOffset = utils.currentTimeMillis();\n        context.snapshotDiffDelete = false;\n    return iotPluginApi.newDbSnapshot(sql);\n         */')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("snapshotType "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'retry'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//失败数据重传")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" iotPluginApi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("newDbSnapshot")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"SELECT * FROM dbo.BG_Item WHERE cItemCode = "')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" context"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("snapshotRetryKeys"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'cItemCode'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//扫描整张表读取全量数据")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" iotPluginApi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("newDbSnapshot")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"SELECT * FROM dbo.BG_Item"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h4",{attrs:{id:"_1-2-api查询"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-api查询"}},[t._v("#")]),t._v(" 1.2 API查询")]),t._v(" "),s("p",[t._v("说明：从一个API获取增量数据，不实现全量和重传功能。")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n *\n * @param snapshotType full=全量同步，increment=增量同步，retry=重传数据\n * @param context\n *       context.path: api路径\n *     context.snapshotOffset：记录目前偏移值，类型是数字、文本、MAP\n *     context.snapshotDiffDelete：是否计算删除增量\n *     context.snapshotMore：如果全量太多数据，需要分页，设置这个参数是true\n *     context.snapshotRetryKeys：重传的唯一标识，Map类型，只有在snapshotType=retry才有值\n */")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("snapshot")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("snapshotType"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" context")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("snapshotType "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'increment'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//重传，不实现无法拉增量数据")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("context"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("snapshotOffset "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            context"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("snapshotOffset "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" utils"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("currentTimeMillis")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//从当前时间戳开始")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//构造请求参数")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" params "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'timestamp'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" context"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("snapshotOffset"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//发起HTTP请求,也支持httpGet")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" body "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" httpPlugin"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("httpPostJson")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("context"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" utils"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("toJSONString")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("params"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//发起HTTP请求")]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("body"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("code "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//处理返回结果")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" records "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" iotPluginApi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("newList")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" record "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JSON")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("parse")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("body"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        records"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("record"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//records.add(xxx);添加更多数据")]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//不需要计算增量删除")]),t._v("\n        context"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("snapshotDiffDelete "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//更新记录")]),t._v("\n        context"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("snapshotOffset "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" utils"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("currentTimeMillis")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" records"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("snapshotType "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'full'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//全量同步，不实现无法拉取全量数据")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//参考增量实现方法")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//如果需要分页：可以用context.snapshotOffset记录位置")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//           同时设置context.snapshotMore=true")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("snapshotType "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'retry'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//重传，不实现无法重传数据")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//参考增量实现方法")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//重传的标识符从context.snapshotRetryKeys读取")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"_2-转换节点"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-转换节点"}},[t._v("#")]),t._v(" 2. 转换节点")]),t._v(" "),s("p",[t._v("说明：转换输入节点采集到的原始数据到目标数据格式。")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n * 客户实现: transform()转换函数\n * 这是脚本转换器的第一个转换函数,负责将 数据来源(如数据库变换的数据) 转换成 目标数据格式,如主数据,服务模型数据,物联网数据等\n * 如下的代码是一个示例：仅供参考,需要根据您的实际业务场景转换逻辑进行编写\n * 示例代码是数据源的数据转换成iot工业数字工厂的人员主数据格式\n * @param eventType为事件类型,对于数据库事件有 insert,update,delete\n * @param msgPayload 为需要转换的目标数据,注意其格式是一个Map,对应Java的格式为Map<String, Object>\n * @context 系统上下文参数\n * @return 返回转换后的数据格式,必须也为一个Map,即数据输入为Map,转换格式后还是为Map\n */")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("transform")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("eventType"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" msgPayload"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" context")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" masterData "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("iotPluginApi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("newMap")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//在这里实现数据转换逻辑")]),t._v("\n    masterData"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"num"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" msgPayload"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"id"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    masterData"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"name"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" msgPayload"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"name"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  \n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//这里也可以调用数据库操作API来查询数据")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" masterData"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[s("strong",[t._v("注")]),t._v("："),s("strong",[t._v("转换节点如果需要调用【数据库操作】或者【API操作】，默认访问的数据源是输入数据源。")])]),t._v(" "),s("h3",{attrs:{id:"_3-输出节点"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-输出节点"}},[t._v("#")]),t._v(" 3. 输出节点")]),t._v(" "),s("p",[t._v("输出节点类似是“主数据 ”、“服务依赖”的情况不需要编写脚本。")]),t._v(" "),s("h4",{attrs:{id:"_3-1-数据库回写"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-数据库回写"}},[t._v("#")]),t._v(" 3.1 数据库回写")]),t._v(" "),s("p",[t._v("不需要事务支持。")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n * 客户实现: distribute()分发函数\n * 负责将 transform转换后的数据写入边缘数据库\n * @param eventType 为事件类型,对于数据库事件有 insert,update,delete\n * @param transformData transform转换后的数据，是一个Map\n * @param context\n */")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("distribute")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("eventType"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" transformData"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" context")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" sql "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"INSERT INTO dbo.TB2(id,name,remark) VALUES("')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" transformData"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("\",'XXX','YYY')\"")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//写入边缘数据库")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" ret "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" iotPluginApi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("iotSqlExecute")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sql"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//在这里构造服务模型返回数据")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ret"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("code "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//成功")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//失败")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" ret"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("方法二：事务支持。")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n * 客户实现: distribute()分发函数\n * 负责将 transform转换后的数据写入边缘数据库\n * @param eventType 为事件类型,对于数据库事件有 insert,update,delete\n * @param transformData transform转换后的数据，是一个Map\n * @param context\n */")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("distribute")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("eventType"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" transformData"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" context")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" transaction "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" iotPluginApi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("iotGetTransaction")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" sql1 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"INSERT INTO dbo.TB1(id,name,remark) VALUES("')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" transformData"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("\",'XXX','YYY')\"")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" sql2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"INSERT INTO dbo.TB2(id,name,remark) VALUES("')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" transformData"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("\",'XXX','YYY')\"")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        transaction"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("execute")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sql1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        transaction"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("execute")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sql2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" r "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" transaction"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("commit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"commit:"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" r"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" iotPluginApi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("newIoTxResult")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"OK"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" r"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"rollback:"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        transaction"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("rollback")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" iotPluginApi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("newIoTxResult")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("500")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"rollback"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("3.2 调用API")]),t._v(" "),s("p",[t._v("说明：发起HTTP请求并分析响应结果。")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n * 客户实现: distribute()分发函数\n * 负责将 transform转换后的返回数据通过API方式上报\n * @param eventType 为事件类型,对于数据库事件有 insert,update,delete\n * @param transformData transform转换后的数据，是一个Map\n * @param context\n *     context.path：传入来的API路径\n */")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("distribute")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("eventType"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" transformData"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" context")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//发起一个HTTP请求，")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" data "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" httpPlugin"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("httpPostJson")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("context"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" utils"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("toJSONString")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("transformData"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"HTTP返回数据："')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//如果返回是一个JSON结构")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" jsonMap "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JSON")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("parse")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//返回结果")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" iotPluginApi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("newIoTxResult")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"success"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" jsonMap"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("3.3 告警")]),t._v(" "),s("p",[t._v("说明：输出节点为告警的场景适用于监听数据变化后触发通知，注意这里的报警需要提前在数字工厂->通知规则中进行报警定义，并定义报警的标题和内容。报警触发后，会在数字工厂的报警弹窗和钉钉中通知。")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n * 客户实现: distribute()分发函数，用于输出节点\n * 如下的代码是一个示例:仅供参考,需要根据您的实际业务场景转换逻辑进行编写\n * @param eventType为事件类型,对于数据库事件有 insert,update,delete\n * @param transformData 这是转换节点的transform()函数返回的内容，即转换后的数据格式\n * @context 系统上下文参数\n * @return\n */")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("distribute")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("eventType"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" transformData"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" context")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//提示：可以在这里对transformData进行判断，符合触发条件的才走下面的告警逻辑")]),t._v("\n   iotPluginApi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'告警'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" a "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" iotPluginApi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("triggerCloudAlarm")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'报警的内容写在这里'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" iotPluginApi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("newIoTxResult")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"success"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("3.4 物联网设备服务")]),t._v(" "),s("p",[t._v("说明：需要在IOT的物联网设备上为该设备创建一个服务，并在输出时选择设备及需要调用的设备的服务。")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n * 客户实现: distribute()分发函数，用于输出节点为设备物模型服务调用\n * 如下的代码是一个示例:仅供参考,需要根据您的实际业务场景转换逻辑进行编写\n * @param eventType为事件类型,对于数据库事件有 insert,update,delete\n * @param transformData 这是转换节点的transform()函数返回的内容，即转换后的数据格式\n * @context 系统上下文参数\n * @return\n */")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("distribute")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("eventType"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" transformData"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" context")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//注意：triggerDeviceServiceCall的参数为一个JSON结构,即设备服务调用的参数")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//如果该服务未设置任何参数，这传入空的json对象接口。")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//也可以在这里进行if判断，对数据进行过滤，只有符合条件对才触发设备调用")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" a "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" iotPluginApi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("triggerDeviceServiceCall")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("3.5 自定义脚本")]),t._v(" "),s("p",[t._v("说明：自定义脚本为用户自定义的输出逻辑，用户可以在该脚本中调用八爪鱼脚本的API函数实现自己的逻辑。注：该distribute函数需要返回IoTxResult 200代表函数调用成功。")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n * 客户实现: distribute()分发函数，用于输出节点\n * 如下的代码是一个示例:仅供参考,需要根据您的实际业务场景转换逻辑进行编写\n * @param eventType为事件类型,对于数据库事件有 insert,update,delete\n * @param transformData 这是转换节点的transform()函数返回的内容，即转换后的数据格式\n * @context 系统上下文参数\n * @return\n */")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("distribute")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("eventType"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" transformData"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" context")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//这是一个自定义的脚本，您可以在这里通过调用数据集成的脚本API实现自定义的输出逻辑")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//这个示例脚本仅仅只是打印了一条语句，用于参考")]),t._v("\n   iotPluginApi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'this is user-defined script'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" iotPluginApi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("newIoTxResult")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"success"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"_4-使用步骤"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-使用步骤"}},[t._v("#")]),t._v(" 4. 使用步骤")]),t._v(" "),s("p",[t._v("下面介绍如何使用脚本的几个步骤。")]),t._v(" "),s("h4",{attrs:{id:"_4-1-创建数据集成和开发作业任务"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-创建数据集成和开发作业任务"}},[t._v("#")]),t._v(" 4.1. 创建数据集成和开发作业任务")]),t._v(" "),s("p",[t._v("创建一个数据集成，然后在该数据中创建一个作业任务，同时完成输入节点、转换节点、输出节点的配置和脚本编写。")]),t._v(" "),s("p",[t._v("转换节点必须实现脚本，其他的输入节点、输出节点根据不同的类型有些需要配置，")]),t._v(" "),s("p",[t._v("有些需要进行脚本编写，请根据实际业务场景进行配置。")]),t._v(" "),s("h4",{attrs:{id:"_4-2-调试脚本"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-调试脚本"}},[t._v("#")]),t._v(" 4.2. 调试脚本")]),t._v(" "),s("p",[t._v("在完成脚本编写后，通过Mock参数和调试的方法进行脚本调试，查看调试的返回值确认脚本是否编写正确。")]),t._v(" "),s("h4",{attrs:{id:"_4-3-下载配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-下载配置"}},[t._v("#")]),t._v(" 4.3. 下载配置")]),t._v(" "),s("p",[t._v("脚本编写和调试完成后，进行数据集成页面的编辑页面，点击“下载配置”，将脚本下载到边缘应用。")]),t._v(" "),s("h4",{attrs:{id:"_4-4-查看数据集成结果"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-4-查看数据集成结果"}},[t._v("#")]),t._v(" 4.4. 查看数据集成结果")]),t._v(" "),s("p",[t._v("查看主数据/服务模型/API等输出节点的同步结果。")]),t._v(" "),s("p",[t._v("下载成功后，查看主数据的数据，或者服务模型的数据以判断是否同步成功。")]),t._v(" "),s("p",[t._v("也可以通过在边缘的数据库进行数据库表的修改触发增量数据，进而脚本转换查看同步的结果。")])])}),[],!1,null,null,null);a.default=p.exports}}]);