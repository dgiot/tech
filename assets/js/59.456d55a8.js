(window.webpackJsonp=window.webpackJsonp||[]).push([[59],{578:function(s,a,t){"use strict";t.r(a);var n=t(7),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"username-认证"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#username-认证"}},[s._v("#")]),s._v(" Username 认证")]),s._v(" "),t("p",[s._v("Username 认证使用配置文件预设客户端用户名与密码，支持通过 HTTP API 管理认证数据。")]),s._v(" "),t("p",[s._v("Username 认证不依赖外部数据源，使用上足够简单轻量。")]),s._v(" "),t("p",[s._v("插件：")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("emqx_auth_username\n")])])]),t("h2",{attrs:{id:"哈希方法"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#哈希方法"}},[s._v("#")]),s._v(" 哈希方法")]),s._v(" "),t("p",[s._v("Username 认证默认使用 sha256 进行密码哈希加密，可在 "),t("code",[s._v("etc/plugins/emqx_auth_username.conf")]),s._v(" 中更改：")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# etc/plugins/emqx_auth_username.conf")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Value: plain | md5 | sha | sha256 ")]),s._v("\nauth.user.password_hash "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sha256\n")])])]),t("p",[s._v("配置"),t("RouterLink",{attrs:{to:"/zh/backend/emqx/advanced/auth.html#加盐规则与哈希方法"}},[s._v("哈希方法")]),s._v("后，新增的预设认证数据与通过 HTTP API 添加的认证数据将以哈希密文存储在 EMQ X 内置数据库中。")],1),s._v(" "),t("h2",{attrs:{id:"预设认证数据"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#预设认证数据"}},[s._v("#")]),s._v(" 预设认证数据")]),s._v(" "),t("p",[s._v("可以通过配置文件预设认证数据，编辑配置文件："),t("code",[s._v("etc/plugins/emqx_auth_username.conf")])]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# etc/plugins/emqx_auth_username.conf")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 第一组认证数据")]),s._v("\nauth.user.1.username "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" admin\nauth.user.1.password "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" public\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 第二组认证数据")]),s._v("\nauth.user.2.username "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" wivwiv\nauth.user.2.password "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" public\n")])])]),t("p",[s._v("插件启动时将读取预设认证数据并加载到 EMQ X 内置数据库中，节点上的认证数据会在此阶段同步至集群中。")]),s._v(" "),t("div",{staticClass:"custom-block danger"},[t("p",{staticClass:"custom-block-title"},[s._v("警告")]),s._v(" "),t("p",[s._v("预设认证数据在配置文件中使用了明文密码，出于安全性与可维护性考虑应当避免使用该功能。")]),s._v(" "),t("p",[s._v("预设认证数据无法通过 API 修改、删除，请慎用。")])]),s._v(" "),t("h2",{attrs:{id:"使用-http-api-管理认证数据"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用-http-api-管理认证数据"}},[s._v("#")]),s._v(" 使用 HTTP API 管理认证数据")]),s._v(" "),t("h3",{attrs:{id:"添加认证数据"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#添加认证数据"}},[s._v("#")]),s._v(" 添加认证数据")]),s._v(" "),t("p",[s._v("API 定义：")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Request")]),s._v("\nPOST api/v4/auth_username\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"username"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"emqx_u"')]),s._v(",\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"password"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"emqx_p"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Response")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"code"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("p",[s._v("使用 POST 请求添加 username 为 "),t("code",[s._v("emqx_u")]),s._v(" password 为 "),t("code",[s._v("emqx_p")]),s._v(" 的认证信息，返回信息中 "),t("code",[s._v("code = 0")]),s._v(" 即为成功。")]),s._v(" "),t("h3",{attrs:{id:"查看已经添加的认证数据"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看已经添加的认证数据"}},[s._v("#")]),s._v(" 查看已经添加的认证数据")]),s._v(" "),t("p",[s._v("API 定义：")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Request")]),s._v("\nGET api/v4/auth_username\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Response")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"code"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(",\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"data"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"emqx_u"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("h3",{attrs:{id:"更改指定用户名的密码"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#更改指定用户名的密码"}},[s._v("#")]),s._v(" 更改指定用户名的密码")]),s._v(" "),t("p",[s._v("指定用户名，传递新密码进行更改，再次连接时需要使用新密码进行连接：")]),s._v(" "),t("p",[s._v("API 定义：")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Request")]),s._v("\nPUT api/v4/auth_username/"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${username}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"password"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"emqx_new_p"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Response")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"code"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("h3",{attrs:{id:"查看指定用户名信息"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看指定用户名信息"}},[s._v("#")]),s._v(" 查看指定用户名信息")]),s._v(" "),t("p",[s._v("指定用户名，查看相关用户名、密码信息，注意此处返回的密码是使用配置文件指定哈希方式加密后的密码：")]),s._v(" "),t("p",[s._v("API 定义：")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Request")]),s._v("\nGET api/v4/auth_username/"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${username}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Response")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"code"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(",\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"data"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"username"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"emqx_u"')]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"password"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"091dc8753347e7dc5d348508fe6323735eecdb84fa800548870158117af8a0c0"')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("h3",{attrs:{id:"删除认证数据"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#删除认证数据"}},[s._v("#")]),s._v(" 删除认证数据")]),s._v(" "),t("p",[s._v("删除指定认证数据：")]),s._v(" "),t("p",[s._v("API 定义：")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Request")]),s._v("\nDELETE api/v4/auth_username/"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${username}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Response")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"code"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])])])}),[],!1,null,null,null);a.default=e.exports}}]);