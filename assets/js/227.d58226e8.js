(window.webpackJsonp=window.webpackJsonp||[]).push([[227],{647:function(a,t,s){"use strict";s.r(t);var n=s(10),e=Object(n.a)({},(function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"与其他工具的连接"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#与其他工具的连接"}},[a._v("#")]),a._v(" 与其他工具的连接")]),a._v(" "),s("h2",{attrs:{id:"grafana"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#grafana"}},[a._v("#")]),a._v(" "),s("a",{staticClass:"anchor",attrs:{id:"grafana"}}),a._v("Grafana")]),a._v(" "),s("p",[a._v("TDengine能够与开源数据可视化系统"),s("a",{attrs:{href:"https://www.grafana.com/",target:"_blank",rel:"noopener noreferrer"}},[a._v("Grafana"),s("OutboundLink")],1),a._v("快速集成搭建数据监测报警系统，整个过程无需任何代码开发，TDengine中数据表中内容可以在仪表盘(DashBoard)上进行可视化展现。")]),a._v(" "),s("h3",{attrs:{id:"安装grafana"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装grafana"}},[a._v("#")]),a._v(" 安装Grafana")]),a._v(" "),s("p",[a._v("目前TDengine支持Grafana 5.2.4以上的版本。用户可以根据当前的操作系统，到Grafana官网下载安装包，并执行安装。下载地址如下：https://grafana.com/grafana/download。")]),a._v(" "),s("h3",{attrs:{id:"配置grafana"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置grafana"}},[a._v("#")]),a._v(" 配置Grafana")]),a._v(" "),s("p",[a._v("TDengine的Grafana插件在安装包的/usr/local/taos/connector/grafanaplugin目录下。")]),a._v(" "),s("p",[a._v("以CentOS 7.2操作系统为例，将tdengine目录拷贝到/var/lib/grafana/plugins目录下，重新启动grafana即可。")]),a._v(" "),s("h3",{attrs:{id:"使用-grafana"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用-grafana"}},[a._v("#")]),a._v(" 使用 Grafana")]),a._v(" "),s("h4",{attrs:{id:"配置数据源"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置数据源"}},[a._v("#")]),a._v(" 配置数据源")]),a._v(" "),s("p",[a._v("用户可以直接通过 localhost:3000 的网址，登录 Grafana 服务器(用户名/密码:admin/admin)，通过左侧 "),s("code",[a._v("Configuration -> Data Sources")]),a._v(" 可以添加数据源，如下图所示：")]),a._v(" "),s("p",[s("img",{attrs:{src:"page://images/connections/add_datasource1.jpg",alt:"img"}})]),a._v(" "),s("p",[a._v("点击 "),s("code",[a._v("Add data source")]),a._v(" 可进入新增数据源页面，在查询框中输入 TDengine 可选择添加，如下图所示：")]),a._v(" "),s("p",[s("img",{attrs:{src:"page://images/connections/add_datasource2.jpg",alt:"img"}})]),a._v(" "),s("p",[a._v("进入数据源配置页面，按照默认提示修改相应配置即可：")]),a._v(" "),s("p",[s("img",{attrs:{src:"page://images/connections/add_datasource3.jpg",alt:"img"}})]),a._v(" "),s("ul",[s("li",[a._v("Host： TDengine 集群的中任意一台服务器的 IP 地址与 TDengine RESTful 接口的端口号(6041)，默认 http://localhost:6041")]),a._v(" "),s("li",[a._v("User：TDengine 用户名。")]),a._v(" "),s("li",[a._v("Password：TDengine 用户密码。")])]),a._v(" "),s("p",[a._v("点击 "),s("code",[a._v("Save & Test")]),a._v(" 进行测试，成功会有如下提示：")]),a._v(" "),s("p",[s("img",{attrs:{src:"page://images/connections/add_datasource4.jpg",alt:"img"}})]),a._v(" "),s("h4",{attrs:{id:"创建-dashboard"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#创建-dashboard"}},[a._v("#")]),a._v(" 创建 Dashboard")]),a._v(" "),s("p",[a._v("回到主界面创建 Dashboard，点击 Add Query 进入面板查询页面：")]),a._v(" "),s("p",[s("img",{attrs:{src:"page://images/connections/create_dashboard1.jpg",alt:"img"}})]),a._v(" "),s("p",[a._v("如上图所示，在 Query 中选中 "),s("code",[a._v("TDengine")]),a._v(" 数据源，在下方查询框可输入相应 sql 进行查询，具体说明如下：")]),a._v(" "),s("ul",[s("li",[a._v("INPUT SQL：输入要查询的语句（该 SQL 语句的结果集应为两列多行），例如："),s("code",[a._v("select avg(mem_system) from log.dn where ts >= $from and ts < $to interval($interval)")]),a._v(" ，其中，from、to 和 interval 为 TDengine插件的内置变量，表示从Grafana插件面板获取的查询范围和时间间隔。除了内置变量外，"),s("code",[a._v("也支持可以使用自定义模板变量")]),a._v("。")]),a._v(" "),s("li",[a._v("ALIAS BY：可设置当前查询别名。")]),a._v(" "),s("li",[a._v("GENERATE SQL： 点击该按钮会自动替换相应变量，并生成最终执行的语句。")])]),a._v(" "),s("p",[a._v("按照默认提示查询当前 TDengine 部署所在服务器指定间隔系统内存平均使用量如下：")]),a._v(" "),s("p",[s("img",{attrs:{src:"page://images/connections/create_dashboard2.jpg",alt:"img"}})]),a._v(" "),s("blockquote",[s("p",[a._v("关于如何使用Grafana创建相应的监测界面以及更多有关使用Grafana的信息，请参考Grafana官方的"),s("a",{attrs:{href:"https://grafana.com/docs/",target:"_blank",rel:"noopener noreferrer"}},[a._v("文档"),s("OutboundLink")],1),a._v("。")])]),a._v(" "),s("h4",{attrs:{id:"导入-dashboard"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#导入-dashboard"}},[a._v("#")]),a._v(" 导入 Dashboard")]),a._v(" "),s("p",[a._v("在 Grafana 插件目录 /usr/local/taos/connector/grafana/tdengine/dashboard/ 下提供了一个 "),s("code",[a._v("tdengine-grafana.json")]),a._v(" 可导入的 dashboard。")]),a._v(" "),s("p",[a._v("点击左侧 "),s("code",[a._v("Import")]),a._v(" 按钮，并上传 "),s("code",[a._v("tdengine-grafana.json")]),a._v(" 文件：")]),a._v(" "),s("p",[s("img",{attrs:{src:"page://images/connections/import_dashboard1.jpg",alt:"img"}})]),a._v(" "),s("p",[a._v("导入完成之后可看到如下效果：")]),a._v(" "),s("p",[s("img",{attrs:{src:"page://images/connections/import_dashboard2.jpg",alt:"img"}})]),a._v(" "),s("h2",{attrs:{id:"matlab"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#matlab"}},[a._v("#")]),a._v(" "),s("a",{staticClass:"anchor",attrs:{id:"matlab"}}),a._v("Matlab")]),a._v(" "),s("p",[a._v("MatLab可以通过安装包内提供的JDBC Driver直接连接到TDengine获取数据到本地工作空间。")]),a._v(" "),s("h3",{attrs:{id:"matlab的jdbc接口适配"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#matlab的jdbc接口适配"}},[a._v("#")]),a._v(" MatLab的JDBC接口适配")]),a._v(" "),s("p",[a._v("MatLab的适配有下面几个步骤，下面以Windows10上适配MatLab2017a为例：")]),a._v(" "),s("ul",[s("li",[a._v("将TDengine安装包内的驱动程序JDBCDriver-1.0.0-dist.jar拷贝到${matlab_root}\\MATLAB\\R2017a\\java\\jar\\toolbox")]),a._v(" "),s("li",[a._v("将TDengine安装包内的taos.lib文件拷贝至${matlab_ root _dir}\\MATLAB\\R2017a\\lib\\win64")]),a._v(" "),s("li",[a._v("将新添加的驱动jar包加入MatLab的classpath。在${matlab_ root _dir}\\MATLAB\\R2017a\\toolbox\\local\\classpath.txt文件中添加下面一行\n​")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("$matlabroot/java/jar/toolbox/JDBCDriver-1.0.0-dist.jar\n")])])]),s("ul",[s("li",[a._v("在${user_home}\\AppData\\Roaming\\MathWorks\\MATLAB\\R2017a\\下添加一个文件javalibrarypath.txt, 并在该文件中添加taos.dll的路径，比如您的taos.dll是在安装时拷贝到了C:\\Windows\\System32下，那么就应该在javalibrarypath.txt中添加如下一行：\n​")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("C:\\Windows\\System32\n")])])]),s("h3",{attrs:{id:"在matlab中连接tdengine获取数据"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#在matlab中连接tdengine获取数据"}},[a._v("#")]),a._v(" 在MatLab中连接TDengine获取数据")]),a._v(" "),s("p",[a._v("在成功进行了上述配置后，打开MatLab。")]),a._v(" "),s("ul",[s("li",[a._v("创建一个连接：")])]),a._v(" "),s("div",{staticClass:"language-matlab extra-class"},[s("pre",{pre:!0,attrs:{class:"language-matlab"}},[s("code",[a._v("conn "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("database")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("‘db’"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" ‘root’"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" ‘taosdata’"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" ‘com"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("taosdata"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("jdbc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("TSDBDriver’"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" ‘jdbc"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v("TSDB"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("127.0")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v(".0")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v(".1")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("’"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),s("ul",[s("li",[a._v("执行一次查询：")])]),a._v(" "),s("div",{staticClass:"language-matlab extra-class"},[s("pre",{pre:!0,attrs:{class:"language-matlab"}},[s("code",[a._v("sql0 "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("‘select "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),a._v(" from tb’"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\ndata "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("select")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("conn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" sql0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),s("ul",[s("li",[a._v("插入一条记录:")])]),a._v(" "),s("div",{staticClass:"language-matlab extra-class"},[s("pre",{pre:!0,attrs:{class:"language-matlab"}},[s("code",[a._v("sql1 "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("‘insert into tb "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("values")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("now"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("’"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("exec")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("conn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" sql1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),s("p",[a._v("更多例子细节请参考安装包内examples\\Matlab\\TDengineDemo.m文件。")]),a._v(" "),s("h2",{attrs:{id:"r"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#r"}},[a._v("#")]),a._v(" "),s("a",{staticClass:"anchor",attrs:{id:"r"}}),a._v("R")]),a._v(" "),s("p",[a._v("R语言支持通过JDBC接口来连接TDengine数据库。首先需要安装R语言的JDBC包。启动R语言环境，然后执行以下命令安装R语言的JDBC支持库：")]),a._v(" "),s("div",{staticClass:"language-R extra-class"},[s("pre",{pre:!0,attrs:{class:"language-r"}},[s("code",[a._v("install.packages"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'RJDBC'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" repos"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'http://cran.us.r-project.org'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),s("p",[a._v("安装完成以后，通过执行"),s("code",[a._v("library('RJDBC')")]),a._v("命令加载 "),s("em",[a._v("RJDBC")]),a._v(" 包：")]),a._v(" "),s("p",[a._v("然后加载TDengine的JDBC驱动：")]),a._v(" "),s("div",{staticClass:"language-R extra-class"},[s("pre",{pre:!0,attrs:{class:"language-r"}},[s("code",[a._v("drv"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<-")]),a._v("JDBC"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"com.taosdata.jdbc.TSDBDriver"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"JDBCDriver-2.0.0-dist.jar"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" identifier.quote"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"\\""')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),s("p",[a._v("如果执行成功，不会出现任何错误信息。之后通过以下命令尝试连接数据库：")]),a._v(" "),s("div",{staticClass:"language-R extra-class"},[s("pre",{pre:!0,attrs:{class:"language-r"}},[s("code",[a._v("conn"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<-")]),a._v("dbConnect"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("drv"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"jdbc:TSDB://192.168.0.1:0/?user=root&password=taosdata"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"root"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"taosdata"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),s("p",[a._v("注意将上述命令中的IP地址替换成正确的IP地址。如果没有任务错误的信息，则连接数据库成功，否则需要根据错误提示调整连接的命令。TDengine支持以下的 "),s("em",[a._v("RJDBC")]),a._v(" 包中函数：")]),a._v(" "),s("ul",[s("li",[a._v('dbWriteTable(conn, "test", iris, overwrite=FALSE, append=TRUE)：将数据框iris写入表test中，overwrite必须设置为false，append必须设为TRUE,且数据框iris要与表test的结构一致。')]),a._v(" "),s("li",[a._v('dbGetQuery(conn, "select count(*) from test")：查询语句')]),a._v(" "),s("li",[a._v('dbSendUpdate(conn, "use db")：执行任何非查询sql语句。例如dbSendUpdate(conn, "use db")， 写入数据dbSendUpdate(conn, "insert into t1 values(now, 99)")等。')]),a._v(" "),s("li",[a._v('dbReadTable(conn, "test")：读取表test中数据')]),a._v(" "),s("li",[a._v("dbDisconnect(conn)：关闭连接")]),a._v(" "),s("li",[a._v('dbRemoveTable(conn, "test")：删除表test')])]),a._v(" "),s("p",[a._v("TDengine客户端暂不支持如下函数：")]),a._v(" "),s("ul",[s("li",[a._v('dbExistsTable(conn, "test")：是否存在表test')]),a._v(" "),s("li",[a._v("dbListTables(conn)：显示连接中的所有表")])])])}),[],!1,null,null,null);t.default=e.exports}}]);