<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>性能 | 数蛙技术团队</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.slim.min.js"></script>
    <script type="text/javascript" src="https://s9.cnzz.com/z_stat.php?id=1279876880&amp;web_id=1279876880"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.2/jquery.fancybox.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.2/jquery.fancybox.min.css">
    <meta name="description" content="数蛙科技是一家致力于提供物联网垂直领域应用使能平台及解决方案的创新型公司。">
    <meta name="referrer" content="never">
    
    <link rel="preload" href="/assets/css/0.styles.23a8192d.css" as="style"><link rel="preload" href="/assets/js/app.4e242cc4.js" as="script"><link rel="preload" href="/assets/js/7.57a5124b.js" as="script"><link rel="preload" href="/assets/js/5.7fd7e714.js" as="script"><link rel="preload" href="/assets/js/137.cf1aa4b6.js" as="script"><link rel="prefetch" href="/assets/js/10.2eef3347.js"><link rel="prefetch" href="/assets/js/100.0d1dc244.js"><link rel="prefetch" href="/assets/js/101.03674c43.js"><link rel="prefetch" href="/assets/js/102.371d534b.js"><link rel="prefetch" href="/assets/js/103.5019a517.js"><link rel="prefetch" href="/assets/js/104.b7b0892b.js"><link rel="prefetch" href="/assets/js/105.05110607.js"><link rel="prefetch" href="/assets/js/106.81a88ebc.js"><link rel="prefetch" href="/assets/js/107.47d9db94.js"><link rel="prefetch" href="/assets/js/108.833d6ef7.js"><link rel="prefetch" href="/assets/js/109.c271600f.js"><link rel="prefetch" href="/assets/js/11.b825f6c8.js"><link rel="prefetch" href="/assets/js/110.39492b52.js"><link rel="prefetch" href="/assets/js/111.91f2b9f1.js"><link rel="prefetch" href="/assets/js/112.b6cf1aea.js"><link rel="prefetch" href="/assets/js/113.742eaeb1.js"><link rel="prefetch" href="/assets/js/114.88d9d98d.js"><link rel="prefetch" href="/assets/js/115.9d2a100a.js"><link rel="prefetch" href="/assets/js/116.d2429b02.js"><link rel="prefetch" href="/assets/js/117.6782c476.js"><link rel="prefetch" href="/assets/js/118.7e4d7de8.js"><link rel="prefetch" href="/assets/js/119.11995a21.js"><link rel="prefetch" href="/assets/js/12.4b9c956b.js"><link rel="prefetch" href="/assets/js/120.ff1c34c6.js"><link rel="prefetch" href="/assets/js/121.11d33030.js"><link rel="prefetch" href="/assets/js/122.c51df360.js"><link rel="prefetch" href="/assets/js/123.7d7931dd.js"><link rel="prefetch" href="/assets/js/124.749a0d98.js"><link rel="prefetch" href="/assets/js/125.948ea945.js"><link rel="prefetch" href="/assets/js/126.03551901.js"><link rel="prefetch" href="/assets/js/127.da6c5015.js"><link rel="prefetch" href="/assets/js/128.8148af09.js"><link rel="prefetch" href="/assets/js/129.034e112b.js"><link rel="prefetch" href="/assets/js/13.ce23de6c.js"><link rel="prefetch" href="/assets/js/130.103337c6.js"><link rel="prefetch" href="/assets/js/131.e268f861.js"><link rel="prefetch" href="/assets/js/132.65f10543.js"><link rel="prefetch" href="/assets/js/133.35d3c705.js"><link rel="prefetch" href="/assets/js/134.e9be72eb.js"><link rel="prefetch" href="/assets/js/135.fcb68174.js"><link rel="prefetch" href="/assets/js/136.7d17d81f.js"><link rel="prefetch" href="/assets/js/138.a00aeb0a.js"><link rel="prefetch" href="/assets/js/139.760b9573.js"><link rel="prefetch" href="/assets/js/14.21133967.js"><link rel="prefetch" href="/assets/js/140.982156eb.js"><link rel="prefetch" href="/assets/js/141.8929a379.js"><link rel="prefetch" href="/assets/js/142.94146198.js"><link rel="prefetch" href="/assets/js/143.8516737f.js"><link rel="prefetch" href="/assets/js/144.df30d764.js"><link rel="prefetch" href="/assets/js/145.2f6c6e79.js"><link rel="prefetch" href="/assets/js/146.4588ed64.js"><link rel="prefetch" href="/assets/js/147.62fc04ad.js"><link rel="prefetch" href="/assets/js/148.378cbdb7.js"><link rel="prefetch" href="/assets/js/149.0492b57e.js"><link rel="prefetch" href="/assets/js/15.bdcbdeb1.js"><link rel="prefetch" href="/assets/js/150.068b21c5.js"><link rel="prefetch" href="/assets/js/151.76f9e84c.js"><link rel="prefetch" href="/assets/js/152.ae2cb70d.js"><link rel="prefetch" href="/assets/js/153.9a6e83cb.js"><link rel="prefetch" href="/assets/js/154.517a5564.js"><link rel="prefetch" href="/assets/js/155.6f9570bc.js"><link rel="prefetch" href="/assets/js/156.739debec.js"><link rel="prefetch" href="/assets/js/157.5a1dfb8e.js"><link rel="prefetch" href="/assets/js/158.396c7565.js"><link rel="prefetch" href="/assets/js/159.5d79955f.js"><link rel="prefetch" href="/assets/js/16.9c85aa78.js"><link rel="prefetch" href="/assets/js/160.6797b16f.js"><link rel="prefetch" href="/assets/js/161.78f12eb9.js"><link rel="prefetch" href="/assets/js/162.d2b2b9fa.js"><link rel="prefetch" href="/assets/js/163.7c6b402e.js"><link rel="prefetch" href="/assets/js/164.bb6f5198.js"><link rel="prefetch" href="/assets/js/165.6413143d.js"><link rel="prefetch" href="/assets/js/166.2d18a969.js"><link rel="prefetch" href="/assets/js/167.6b73826e.js"><link rel="prefetch" href="/assets/js/168.b0179911.js"><link rel="prefetch" href="/assets/js/169.e25c8669.js"><link rel="prefetch" href="/assets/js/17.d0e5fdd9.js"><link rel="prefetch" href="/assets/js/170.4fa88feb.js"><link rel="prefetch" href="/assets/js/171.05da47ec.js"><link rel="prefetch" href="/assets/js/172.009a16fa.js"><link rel="prefetch" href="/assets/js/173.ede559d5.js"><link rel="prefetch" href="/assets/js/174.31342991.js"><link rel="prefetch" href="/assets/js/175.5a4daac1.js"><link rel="prefetch" href="/assets/js/176.9bfe1272.js"><link rel="prefetch" href="/assets/js/177.cf032b0e.js"><link rel="prefetch" href="/assets/js/178.35f457c7.js"><link rel="prefetch" href="/assets/js/179.9d3e718a.js"><link rel="prefetch" href="/assets/js/18.1e077813.js"><link rel="prefetch" href="/assets/js/180.fd72aa83.js"><link rel="prefetch" href="/assets/js/181.1a8dfdaa.js"><link rel="prefetch" href="/assets/js/182.75e09097.js"><link rel="prefetch" href="/assets/js/183.b9cdc2f9.js"><link rel="prefetch" href="/assets/js/184.d8712b9a.js"><link rel="prefetch" href="/assets/js/185.8cb7bdb6.js"><link rel="prefetch" href="/assets/js/186.48073b4b.js"><link rel="prefetch" href="/assets/js/187.21a03cfd.js"><link rel="prefetch" href="/assets/js/188.94de90f9.js"><link rel="prefetch" href="/assets/js/189.746f42da.js"><link rel="prefetch" href="/assets/js/19.059b21d8.js"><link rel="prefetch" href="/assets/js/190.6b199d66.js"><link rel="prefetch" href="/assets/js/191.4d9711d2.js"><link rel="prefetch" href="/assets/js/192.e17ab329.js"><link rel="prefetch" href="/assets/js/193.19c47321.js"><link rel="prefetch" href="/assets/js/194.ad656d67.js"><link rel="prefetch" href="/assets/js/195.67baee9f.js"><link rel="prefetch" href="/assets/js/196.ad14da1a.js"><link rel="prefetch" href="/assets/js/197.b891d759.js"><link rel="prefetch" href="/assets/js/198.6afd196b.js"><link rel="prefetch" href="/assets/js/199.fac0a9cf.js"><link rel="prefetch" href="/assets/js/20.4fe3eafd.js"><link rel="prefetch" href="/assets/js/200.5f8c09e1.js"><link rel="prefetch" href="/assets/js/201.952ff73e.js"><link rel="prefetch" href="/assets/js/202.52ba6447.js"><link rel="prefetch" href="/assets/js/203.3eb2e932.js"><link rel="prefetch" href="/assets/js/204.d12eba7d.js"><link rel="prefetch" href="/assets/js/205.35978252.js"><link rel="prefetch" href="/assets/js/206.8ef3bf66.js"><link rel="prefetch" href="/assets/js/207.20935abf.js"><link rel="prefetch" href="/assets/js/208.78a3acda.js"><link rel="prefetch" href="/assets/js/209.d6f0b1fa.js"><link rel="prefetch" href="/assets/js/21.e34386fb.js"><link rel="prefetch" href="/assets/js/210.5b9a5dc9.js"><link rel="prefetch" href="/assets/js/211.74e12077.js"><link rel="prefetch" href="/assets/js/212.013bc9ad.js"><link rel="prefetch" href="/assets/js/213.dbe90e20.js"><link rel="prefetch" href="/assets/js/214.3d02d326.js"><link rel="prefetch" href="/assets/js/215.6641c1cb.js"><link rel="prefetch" href="/assets/js/216.63f448d1.js"><link rel="prefetch" href="/assets/js/217.213fe12f.js"><link rel="prefetch" href="/assets/js/218.abede164.js"><link rel="prefetch" href="/assets/js/219.34201408.js"><link rel="prefetch" href="/assets/js/22.fda338ba.js"><link rel="prefetch" href="/assets/js/220.5c761591.js"><link rel="prefetch" href="/assets/js/221.da0703b9.js"><link rel="prefetch" href="/assets/js/222.990a6a77.js"><link rel="prefetch" href="/assets/js/223.25c93399.js"><link rel="prefetch" href="/assets/js/224.8e1d27f5.js"><link rel="prefetch" href="/assets/js/225.ead69a28.js"><link rel="prefetch" href="/assets/js/226.c422563d.js"><link rel="prefetch" href="/assets/js/227.97118fe7.js"><link rel="prefetch" href="/assets/js/228.cf877a01.js"><link rel="prefetch" href="/assets/js/229.f8e7aea7.js"><link rel="prefetch" href="/assets/js/23.8a71f6a9.js"><link rel="prefetch" href="/assets/js/230.55ad0eb8.js"><link rel="prefetch" href="/assets/js/231.56f464ba.js"><link rel="prefetch" href="/assets/js/232.5cba923c.js"><link rel="prefetch" href="/assets/js/233.53b5eb1d.js"><link rel="prefetch" href="/assets/js/234.6adcd59d.js"><link rel="prefetch" href="/assets/js/235.69880aed.js"><link rel="prefetch" href="/assets/js/236.1c4e44fc.js"><link rel="prefetch" href="/assets/js/237.4ca8b0fd.js"><link rel="prefetch" href="/assets/js/238.9b714bfa.js"><link rel="prefetch" href="/assets/js/239.3284026f.js"><link rel="prefetch" href="/assets/js/24.93dad987.js"><link rel="prefetch" href="/assets/js/240.a8745409.js"><link rel="prefetch" href="/assets/js/241.bd236559.js"><link rel="prefetch" href="/assets/js/242.b61de29f.js"><link rel="prefetch" href="/assets/js/243.03c7b0c7.js"><link rel="prefetch" href="/assets/js/244.4099470f.js"><link rel="prefetch" href="/assets/js/245.e9adacd5.js"><link rel="prefetch" href="/assets/js/246.360a76d8.js"><link rel="prefetch" href="/assets/js/247.b5b2c06d.js"><link rel="prefetch" href="/assets/js/248.e2186a53.js"><link rel="prefetch" href="/assets/js/249.3c63fe6a.js"><link rel="prefetch" href="/assets/js/25.06c83527.js"><link rel="prefetch" href="/assets/js/250.bd093def.js"><link rel="prefetch" href="/assets/js/251.a1069828.js"><link rel="prefetch" href="/assets/js/252.bc247798.js"><link rel="prefetch" href="/assets/js/253.607a90a3.js"><link rel="prefetch" href="/assets/js/254.6d38cd30.js"><link rel="prefetch" href="/assets/js/255.cf438541.js"><link rel="prefetch" href="/assets/js/256.239cdd20.js"><link rel="prefetch" href="/assets/js/257.8247130e.js"><link rel="prefetch" href="/assets/js/258.9a838018.js"><link rel="prefetch" href="/assets/js/259.6409500e.js"><link rel="prefetch" href="/assets/js/26.81112137.js"><link rel="prefetch" href="/assets/js/260.60e41dbf.js"><link rel="prefetch" href="/assets/js/261.4a4de709.js"><link rel="prefetch" href="/assets/js/262.2e56e8a2.js"><link rel="prefetch" href="/assets/js/263.5ffc2e91.js"><link rel="prefetch" href="/assets/js/264.ec5ffafa.js"><link rel="prefetch" href="/assets/js/265.f477324f.js"><link rel="prefetch" href="/assets/js/266.09589a75.js"><link rel="prefetch" href="/assets/js/267.1d91fa2e.js"><link rel="prefetch" href="/assets/js/268.73448ec5.js"><link rel="prefetch" href="/assets/js/269.85f104b6.js"><link rel="prefetch" href="/assets/js/27.f115f75f.js"><link rel="prefetch" href="/assets/js/270.34b79201.js"><link rel="prefetch" href="/assets/js/271.c64129d9.js"><link rel="prefetch" href="/assets/js/272.e38c663f.js"><link rel="prefetch" href="/assets/js/273.d2304e79.js"><link rel="prefetch" href="/assets/js/274.513d7f0c.js"><link rel="prefetch" href="/assets/js/275.f201969d.js"><link rel="prefetch" href="/assets/js/276.2337defb.js"><link rel="prefetch" href="/assets/js/277.9932bcdf.js"><link rel="prefetch" href="/assets/js/278.2555f491.js"><link rel="prefetch" href="/assets/js/279.3cdfbc7d.js"><link rel="prefetch" href="/assets/js/28.7e51c7c0.js"><link rel="prefetch" href="/assets/js/280.936f8b17.js"><link rel="prefetch" href="/assets/js/281.93146a58.js"><link rel="prefetch" href="/assets/js/282.1f97ff19.js"><link rel="prefetch" href="/assets/js/283.176270aa.js"><link rel="prefetch" href="/assets/js/284.d3f388be.js"><link rel="prefetch" href="/assets/js/285.a550437e.js"><link rel="prefetch" href="/assets/js/286.ab6cc238.js"><link rel="prefetch" href="/assets/js/287.d837ceeb.js"><link rel="prefetch" href="/assets/js/288.585dc008.js"><link rel="prefetch" href="/assets/js/289.83ca998f.js"><link rel="prefetch" href="/assets/js/29.583c3665.js"><link rel="prefetch" href="/assets/js/290.c597b103.js"><link rel="prefetch" href="/assets/js/291.2f5d1618.js"><link rel="prefetch" href="/assets/js/292.8fba73f8.js"><link rel="prefetch" href="/assets/js/293.1ccd1a86.js"><link rel="prefetch" href="/assets/js/294.50b529e9.js"><link rel="prefetch" href="/assets/js/295.51544023.js"><link rel="prefetch" href="/assets/js/296.69090c0e.js"><link rel="prefetch" href="/assets/js/297.77bf57e2.js"><link rel="prefetch" href="/assets/js/298.e3f53ec2.js"><link rel="prefetch" href="/assets/js/299.98458923.js"><link rel="prefetch" href="/assets/js/30.6bff26ef.js"><link rel="prefetch" href="/assets/js/300.e8c9cbfd.js"><link rel="prefetch" href="/assets/js/301.d17d1350.js"><link rel="prefetch" href="/assets/js/302.ead736e4.js"><link rel="prefetch" href="/assets/js/303.b7c0a37e.js"><link rel="prefetch" href="/assets/js/304.8b5036f2.js"><link rel="prefetch" href="/assets/js/305.6731205e.js"><link rel="prefetch" href="/assets/js/306.0f4e3207.js"><link rel="prefetch" href="/assets/js/307.29af6325.js"><link rel="prefetch" href="/assets/js/308.96a3ba77.js"><link rel="prefetch" href="/assets/js/309.955d1c9e.js"><link rel="prefetch" href="/assets/js/31.74b30a12.js"><link rel="prefetch" href="/assets/js/310.10a00f16.js"><link rel="prefetch" href="/assets/js/311.5539fd7c.js"><link rel="prefetch" href="/assets/js/312.95421076.js"><link rel="prefetch" href="/assets/js/313.ad8a1e43.js"><link rel="prefetch" href="/assets/js/314.162e0d16.js"><link rel="prefetch" href="/assets/js/315.919c63a1.js"><link rel="prefetch" href="/assets/js/316.66582b15.js"><link rel="prefetch" href="/assets/js/317.367fa8f0.js"><link rel="prefetch" href="/assets/js/318.fa3e65e8.js"><link rel="prefetch" href="/assets/js/319.d7de9521.js"><link rel="prefetch" href="/assets/js/32.b16e3a96.js"><link rel="prefetch" href="/assets/js/320.b86687c3.js"><link rel="prefetch" href="/assets/js/321.215266fe.js"><link rel="prefetch" href="/assets/js/322.8d9e61eb.js"><link rel="prefetch" href="/assets/js/323.4959845a.js"><link rel="prefetch" href="/assets/js/324.7fb2d53b.js"><link rel="prefetch" href="/assets/js/325.9ee2f7a7.js"><link rel="prefetch" href="/assets/js/326.6b10530d.js"><link rel="prefetch" href="/assets/js/327.4759d284.js"><link rel="prefetch" href="/assets/js/328.751ec7eb.js"><link rel="prefetch" href="/assets/js/329.0eb6990b.js"><link rel="prefetch" href="/assets/js/33.d10c4c02.js"><link rel="prefetch" href="/assets/js/330.bcf7c03e.js"><link rel="prefetch" href="/assets/js/331.d641112b.js"><link rel="prefetch" href="/assets/js/332.d4483e32.js"><link rel="prefetch" href="/assets/js/333.581668c5.js"><link rel="prefetch" href="/assets/js/334.173aa887.js"><link rel="prefetch" href="/assets/js/34.03e86bff.js"><link rel="prefetch" href="/assets/js/35.8df71935.js"><link rel="prefetch" href="/assets/js/36.4b269ece.js"><link rel="prefetch" href="/assets/js/37.b9b78238.js"><link rel="prefetch" href="/assets/js/38.fbc664d2.js"><link rel="prefetch" href="/assets/js/39.c6fed64e.js"><link rel="prefetch" href="/assets/js/40.00b53127.js"><link rel="prefetch" href="/assets/js/41.84a8ec5c.js"><link rel="prefetch" href="/assets/js/42.8257f04f.js"><link rel="prefetch" href="/assets/js/43.4c369a45.js"><link rel="prefetch" href="/assets/js/44.008bc4bc.js"><link rel="prefetch" href="/assets/js/45.e5eb96f5.js"><link rel="prefetch" href="/assets/js/46.cd66d5ae.js"><link rel="prefetch" href="/assets/js/47.f1299357.js"><link rel="prefetch" href="/assets/js/48.0d935da6.js"><link rel="prefetch" href="/assets/js/49.93aac5f8.js"><link rel="prefetch" href="/assets/js/50.5b06ddad.js"><link rel="prefetch" href="/assets/js/51.bfaa7634.js"><link rel="prefetch" href="/assets/js/52.d06bf41a.js"><link rel="prefetch" href="/assets/js/53.95be5b11.js"><link rel="prefetch" href="/assets/js/54.3666b40a.js"><link rel="prefetch" href="/assets/js/55.860dade4.js"><link rel="prefetch" href="/assets/js/56.84adcd98.js"><link rel="prefetch" href="/assets/js/57.a7fe766d.js"><link rel="prefetch" href="/assets/js/58.fc463805.js"><link rel="prefetch" href="/assets/js/59.1f834601.js"><link rel="prefetch" href="/assets/js/6.300c849a.js"><link rel="prefetch" href="/assets/js/60.2bfc5b2b.js"><link rel="prefetch" href="/assets/js/61.60b367ae.js"><link rel="prefetch" href="/assets/js/62.7c7e4c42.js"><link rel="prefetch" href="/assets/js/63.2399d476.js"><link rel="prefetch" href="/assets/js/64.f1456fe2.js"><link rel="prefetch" href="/assets/js/65.0a9a990f.js"><link rel="prefetch" href="/assets/js/66.2bf4e08c.js"><link rel="prefetch" href="/assets/js/67.51e501af.js"><link rel="prefetch" href="/assets/js/68.809c1a93.js"><link rel="prefetch" href="/assets/js/69.d449545d.js"><link rel="prefetch" href="/assets/js/70.6b0914b4.js"><link rel="prefetch" href="/assets/js/71.0bbb3344.js"><link rel="prefetch" href="/assets/js/72.58986550.js"><link rel="prefetch" href="/assets/js/73.f43d0109.js"><link rel="prefetch" href="/assets/js/74.c4362056.js"><link rel="prefetch" href="/assets/js/75.9cac6cf4.js"><link rel="prefetch" href="/assets/js/76.6cb4e5b0.js"><link rel="prefetch" href="/assets/js/77.0212e835.js"><link rel="prefetch" href="/assets/js/78.4f2b3f59.js"><link rel="prefetch" href="/assets/js/79.2cfd56dc.js"><link rel="prefetch" href="/assets/js/8.3b6fe697.js"><link rel="prefetch" href="/assets/js/80.39fafaad.js"><link rel="prefetch" href="/assets/js/81.3a32e68a.js"><link rel="prefetch" href="/assets/js/82.a17e3409.js"><link rel="prefetch" href="/assets/js/83.f62b5861.js"><link rel="prefetch" href="/assets/js/84.062c259b.js"><link rel="prefetch" href="/assets/js/85.8fa3e343.js"><link rel="prefetch" href="/assets/js/86.dca9f68a.js"><link rel="prefetch" href="/assets/js/87.e85eae17.js"><link rel="prefetch" href="/assets/js/88.9cfc00a2.js"><link rel="prefetch" href="/assets/js/89.839092a7.js"><link rel="prefetch" href="/assets/js/9.cfab03b0.js"><link rel="prefetch" href="/assets/js/90.2c2d83f1.js"><link rel="prefetch" href="/assets/js/91.34b4e89c.js"><link rel="prefetch" href="/assets/js/92.c63ca1d6.js"><link rel="prefetch" href="/assets/js/93.764621dd.js"><link rel="prefetch" href="/assets/js/94.4a61ba2b.js"><link rel="prefetch" href="/assets/js/95.bb2aee83.js"><link rel="prefetch" href="/assets/js/96.d7614e70.js"><link rel="prefetch" href="/assets/js/97.83b91e5d.js"><link rel="prefetch" href="/assets/js/98.2ccb7753.js"><link rel="prefetch" href="/assets/js/99.079d2ee5.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.8d7743fe.js"><link rel="prefetch" href="/assets/js/vendors~flowchart.f20d812e.js"><link rel="prefetch" href="/assets/js/vendors~photo-swipe.751a6989.js">
    <link rel="stylesheet" href="/assets/css/0.styles.23a8192d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">数蛙技术团队</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="用户手册" class="dropdown-title"><span class="title">用户手册</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/zh/manual/cloud/" class="nav-link">数蛙工业数据云平台</a></li><li class="dropdown-item"><!----> <a href="/zh/manual/edge/" class="nav-link">数蛙工业边缘网关</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="产品说明" class="dropdown-title"><span class="title">产品说明</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/zh/product/dgiot/" class="nav-link">一站式物联网平台</a></li><li class="dropdown-item"><!----> <a href="/zh/product/dgpress/" class="nav-link">一站式云压测平台</a></li><li class="dropdown-item"><!----> <a href="/zh/product/dgtest/" class="nav-link">一站式云检测平台</a></li><li class="dropdown-item"><!----> <a href="/zh/product/dgii/" class="nav-link">一站式云工厂平台</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开发指南" class="dropdown-title"><span class="title">开发指南</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/zh/backend/" class="nav-link">服务架构</a></li><li class="dropdown-item"><!----> <a href="/zh/frontend/" class="nav-link router-link-active">交互技术</a></li><li class="dropdown-item"><!----> <a href="/zh/dataanalysis/" class="nav-link">数据分析</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="实战教程" class="dropdown-title"><span class="title">实战教程</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/zh/blog/knowledge/" class="nav-link">基础知识</a></li><li class="dropdown-item"><!----> <a href="/zh/blog/study/" class="nav-link">案例教程</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/zh/frontend/parse/performance.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">简体中文</a></li><li class="dropdown-item"><!----> <a href="/en/" class="nav-link">English</a></li></ul></div></div> <a href="https://github.com/dgiot" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="用户手册" class="dropdown-title"><span class="title">用户手册</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/zh/manual/cloud/" class="nav-link">数蛙工业数据云平台</a></li><li class="dropdown-item"><!----> <a href="/zh/manual/edge/" class="nav-link">数蛙工业边缘网关</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="产品说明" class="dropdown-title"><span class="title">产品说明</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/zh/product/dgiot/" class="nav-link">一站式物联网平台</a></li><li class="dropdown-item"><!----> <a href="/zh/product/dgpress/" class="nav-link">一站式云压测平台</a></li><li class="dropdown-item"><!----> <a href="/zh/product/dgtest/" class="nav-link">一站式云检测平台</a></li><li class="dropdown-item"><!----> <a href="/zh/product/dgii/" class="nav-link">一站式云工厂平台</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开发指南" class="dropdown-title"><span class="title">开发指南</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/zh/backend/" class="nav-link">服务架构</a></li><li class="dropdown-item"><!----> <a href="/zh/frontend/" class="nav-link router-link-active">交互技术</a></li><li class="dropdown-item"><!----> <a href="/zh/dataanalysis/" class="nav-link">数据分析</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="实战教程" class="dropdown-title"><span class="title">实战教程</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/zh/blog/knowledge/" class="nav-link">基础知识</a></li><li class="dropdown-item"><!----> <a href="/zh/blog/study/" class="nav-link">案例教程</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/zh/frontend/parse/performance.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">简体中文</a></li><li class="dropdown-item"><!----> <a href="/en/" class="nav-link">English</a></li></ul></div></div> <a href="https://github.com/dgiot" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav> <div style="padding-left:1.5rem;"><div></div></div> <ul class="sidebar-links"><li><a href="/zh/frontend/" aria-current="page" class="sidebar-link">交互技术</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>云组态</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Web前端</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>安卓App</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>苹果App</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>微信小程序</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Konva</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Parse-Server</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/zh/frontend/parse/parse.html" class="sidebar-link">简介</a></li><li><a href="/zh/frontend/parse/get-started.html" class="sidebar-link">开始</a></li><li><a href="/zh/frontend/parse/Object.html" class="sidebar-link">对象Objects</a></li><li><a href="/zh/frontend/parse/Query.html" class="sidebar-link">查询Queries</a></li><li><a href="/zh/frontend/parse/Live Query.html" class="sidebar-link">实时查询Live Queries</a></li><li><a href="/zh/frontend/parse/Users.html" class="sidebar-link">用户Users</a></li><li><a href="/zh/frontend/parse/Session.html" class="sidebar-link">会话Session</a></li><li><a href="/zh/frontend/parse/Roles.html" class="sidebar-link">角色Roles</a></li><li><a href="/zh/frontend/parse/Files.html" class="sidebar-link">角色Files</a></li><li><a href="/zh/frontend/parse/Promise.html" class="sidebar-link">链式写法Promise</a></li><li><a href="/zh/frontend/parse/Geo Point.html" class="sidebar-link">坐标GeoPoint</a></li><li><a href="/zh/frontend/parse/config.html" class="sidebar-link">配置Config</a></li><li><a href="/zh/frontend/parse/analytics.html" class="sidebar-link">分析analytics</a></li><li><a href="/zh/frontend/parse/data.html" class="sidebar-link">分析data</a></li><li><a href="/zh/frontend/parse/relation.html" class="sidebar-link">对象关系relation</a></li><li><a href="/zh/frontend/parse/error-handling.html" class="sidebar-link">错误处理error-handling</a></li><li><a href="/zh/frontend/parse/security.html" class="sidebar-link">安全security</a></li><li><a href="/zh/frontend/parse/performance.html" aria-current="page" class="active sidebar-link">性能performance</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh/frontend/parse/performance.html#编写高效的查询" class="sidebar-link">编写高效的查询</a></li><li class="sidebar-sub-header"><a href="/zh/frontend/parse/performance.html#索引" class="sidebar-link">索引</a></li><li class="sidebar-sub-header"><a href="/zh/frontend/parse/performance.html#高效的查询设计" class="sidebar-link">高效的查询设计</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh/frontend/parse/performance.html#不等于" class="sidebar-link">不等于</a></li><li class="sidebar-sub-header"><a href="/zh/frontend/parse/performance.html#不包含" class="sidebar-link">不包含</a></li><li class="sidebar-sub-header"><a href="/zh/frontend/parse/performance.html#正则表达式" class="sidebar-link">正则表达式</a></li></ul></li><li class="sidebar-sub-header"><a href="/zh/frontend/parse/performance.html#编写受约束的查询" class="sidebar-link">编写受约束的查询</a></li><li class="sidebar-sub-header"><a href="/zh/frontend/parse/performance.html#客户端缓存" class="sidebar-link">客户端缓存</a></li><li class="sidebar-sub-header"><a href="/zh/frontend/parse/performance.html#使用云代码" class="sidebar-link">使用云代码</a></li><li class="sidebar-sub-header"><a href="/zh/frontend/parse/performance.html#避免count操作" class="sidebar-link">避免Count操作</a></li><li class="sidebar-sub-header"><a href="/zh/frontend/parse/performance.html#使用高效的查询" class="sidebar-link">使用高效的查询</a></li><li class="sidebar-sub-header"><a href="/zh/frontend/parse/performance.html#限额和其他考虑" class="sidebar-link">限额和其他考虑</a></li></ul></li><li><a href="/zh/frontend/parse/error-code.html" class="sidebar-link">错误码error-code</a></li><li><a href="/zh/frontend/parse/parseserver.html" class="sidebar-link">番外: ParseServer配置指南</a></li><li><a href="/zh/frontend/parse/dashboard.html" class="sidebar-link">番外: 仪表盘配置指南</a></li><li><a href="/zh/frontend/parse/cloudcode.html" class="sidebar-link">番外: 云代码使用指南</a></li></ul></section></li></ul> </aside> <!----> <!----> <main class="page"><div class="theme-default-content" style="margin-top:3.6rem;padding-top:0;padding-bottom:0;"></div> <div class="theme-default-content"><div class="content__default"><h1 id="性能"><a href="#性能" class="header-anchor">#</a> 性能</h1> <p>随着你的应用规模增长，你将需要确保应用在负载和使用规模增长的情况下运行良好，本章将介绍如何将你的应用性能最优化。当你使用Parse服务快速构建你的原型时，你不需要考虑性能，但当你开始设计你的应用时，你很有必要考虑性能。我们强烈建议你在发布你的应用前，确保其遵循了我们的建议。</p> <p>通过以下几点，可以提高你的应用性能：</p> <ul><li>编写高效的查询</li> <li>编写受约束的查询</li> <li>使用客户端缓存</li> <li>使用云代码</li> <li>避免count查询</li> <li>使用高效的搜索技术</li></ul> <p>请将以上牢记心中。</p> <p>下面我们来详细了解每一点。</p> <h2 id="编写高效的查询"><a href="#编写高效的查询" class="header-anchor">#</a> 编写高效的查询</h2> <p>Parse对象被存储在数据库中，Parse查询将根据你编写的查询条件获取对象，为了避免每个查询都查看给定的class表的所有数据，可以为数据库使用索引，索引是指满足给定标准的项目排序列表，索引能有帮助，是因为索引允许数据库高效的查询，并在不需要查看所有数据的情况下返回匹配结果。索引的大小很小，所以可以在内存中使用，所以查找更快。</p> <h2 id="索引"><a href="#索引" class="header-anchor">#</a> 索引</h2> <p>在使用Parse服务时，你需要管理你的数据库并保持索引，如果你没有索引，每个查询将必须遍历表中每个数据才能返回匹配结果，反之，如果你有恰当的索引，遍历的数据将很少。</p> <p>查询的约束的有效性排序如下：</p> <ul><li>等于</li> <li>包含</li> <li>小于、小于等于、大于、大于等于</li> <li>匹配字符串开头</li> <li>不等于</li> <li>不包含</li> <li>其他</li></ul> <p>来看看下面的查询，获取<code>GameScore</code>对象：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> GameScore <span class="token operator">=</span> Parse<span class="token punctuation">.</span>Object<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token string">&quot;GameScore&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Parse<span class="token punctuation">.</span>Query</span><span class="token punctuation">(</span>GameScore<span class="token punctuation">)</span><span class="token punctuation">;</span>
query<span class="token punctuation">.</span><span class="token function">equalTo</span><span class="token punctuation">(</span><span class="token string">&quot;score&quot;</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
query<span class="token punctuation">.</span><span class="token function">containedIn</span><span class="token punctuation">(</span><span class="token string">&quot;playerName&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">&quot;Jonathan Walsh&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Dario Wunsch&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Shawn Simon&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>在<code>score</code>字段上创建索引，会比在<code>playerName</code>上创建索引创造更小的搜索空间。</p> <p>当检查数据类型时，布尔值的熵非常低，并且没有很好的索引，使用下面的查询约束：</p> <div class="language-js extra-class"><pre class="language-js"><code>query<span class="token punctuation">.</span><span class="token function">equalTo</span><span class="token punctuation">(</span><span class="token string">&quot;cheatMode&quot;</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>cheatMode</code>可能的值有<code>true</code>和<code>false</code>，如果在<code>cheatMode</code>上建立索引，用处并不大，因为要返回查询结果，可能要遍历50%的对象。</p> <p>数据类型根据键值空间的预期熵排序：</p> <ul><li>GeoPoints</li> <li>Array</li> <li>Pointer</li> <li>Date</li> <li>String</li> <li>Number</li> <li>Other</li></ul> <p>即使最好的索引策略也可能被不够好的查询打败。</p> <h2 id="高效的查询设计"><a href="#高效的查询设计" class="header-anchor">#</a> 高效的查询设计</h2> <p>编写高效的查询，意味着充分利用索引的好处。下面的查询约束，会使索引无效：</p> <ul><li>不等于</li> <li>不包含</li></ul> <p>另外某些场景下，下面的查询，如果他们不能充分利用索引的好处，可能会造成查询相应变慢。</p> <ul><li>正则表达式</li> <li>按某字段排序</li></ul> <h3 id="不等于"><a href="#不等于" class="header-anchor">#</a> <em>不等于</em></h3> <p>假设，你正在记录一个游戏中的<code>GameScore</code>表的高分，你想获取除了某个玩家以外的所有玩家分数，你可以编写这样的查询：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> GameScore <span class="token operator">=</span> Parse<span class="token punctuation">.</span>Object<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token string">&quot;GameScore&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Parse<span class="token punctuation">.</span>Query</span><span class="token punctuation">(</span>GameScore<span class="token punctuation">)</span><span class="token punctuation">;</span>
query<span class="token punctuation">.</span><span class="token function">notEqualTo</span><span class="token punctuation">(</span><span class="token string">&quot;playerName&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Michael Yabuti&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
query<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">results</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Retrieved scores successfully</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>这个查询不能充分利用索引的好处，数据库必须对比<code>GameScore</code>表中的每一个对象，才能返回结果，随着class表的条目增长，查询时间会变长。你应该和其他字段匹配，而不是查询是否缺少值，这样才可以让数据库使用索引，查询会更快。</p> <p>比如说，用户表有一个<code>state</code>字段，它可能的值有SignedUp、Verified和invited，下面查找所有最少使用过一次应用的用户的查询，是较慢的方式：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Parse<span class="token punctuation">.</span>Query</span><span class="token punctuation">(</span>Parse<span class="token punctuation">.</span>User<span class="token punctuation">)</span><span class="token punctuation">;</span>
query<span class="token punctuation">.</span><span class="token function">notEqualTo</span><span class="token punctuation">(</span><span class="token string">&quot;state&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Invited&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>如果是给查询设置&quot;包含条件&quot;的约束，查询就会较快：</p> <div class="language-js extra-class"><pre class="language-js"><code>query<span class="token punctuation">.</span><span class="token function">containedIn</span><span class="token punctuation">(</span><span class="token string">&quot;state&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&quot;SignedUp&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Verified&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>有时候你应该重写你的查询。我们回到上一个<code>GameScore</code>的例子，假设我们要查询比指定玩家最高分高的玩家，我们可以做些不同的，先拿到指定玩家的最高分，然后执行下面查询：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> GameScore <span class="token operator">=</span> Parse<span class="token punctuation">.</span>Object<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token string">&quot;GameScore&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Parse<span class="token punctuation">.</span>Query</span><span class="token punctuation">(</span>GameScore<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 先拿到 Michael Yabuti 的highScore</span>
query<span class="token punctuation">.</span><span class="token function">greaterThan</span><span class="token punctuation">(</span><span class="token string">&quot;score&quot;</span><span class="token punctuation">,</span> highScore<span class="token punctuation">)</span><span class="token punctuation">;</span>
query<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">results</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Retrieved scores successfully</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>查询的重写取决于你的使用场景，这有时可能意味着要重新设计数据模型。</p> <h3 id="不包含"><a href="#不包含" class="header-anchor">#</a> <em>不包含</em></h3> <p>类似于&quot;不等于&quot;，&quot;不包含&quot;查询约束不能使用索引，你应该尝试使用互补的“包含”查询约束。回到之前的用户例子，如果<code>state</code>字段还有一个“Blocked”值表示被封的用户，我们现在要查询活动的用户，下面这样是低效的：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Parse<span class="token punctuation">.</span>Query</span><span class="token punctuation">(</span>Parse<span class="token punctuation">.</span>User<span class="token punctuation">)</span><span class="token punctuation">;</span>
query<span class="token punctuation">.</span><span class="token function">notContainedIn</span><span class="token punctuation">(</span><span class="token string">&quot;state&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&quot;Invited&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Blocked&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>使用对应的“包含”查询约束是高效的：</p> <div class="language-js extra-class"><pre class="language-js"><code>query<span class="token punctuation">.</span><span class="token function">containedIn</span><span class="token punctuation">(</span><span class="token string">&quot;state&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&quot;SignedUp&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Verified&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>这意味着根据你的架构设置，你要相应的重写查询，甚至重写架构。</p> <h3 id="正则表达式"><a href="#正则表达式" class="header-anchor">#</a> <em>正则表达式</em></h3> <p>处于性能考虑，应该尽量避免使用正则表达式，MongoDB对于字符串部分匹配的执行不是很高效。使用正则查询对性能的消耗是很高的，尤其是在表数据超过10万条后。你需要考虑在特定时间内限制多少这样的查询，你的应用才能正常运行。</p> <p>正则表达式不支持索引，比如下面的查询，通过给定的<code>playerName</code>字段查找数据，字符串查询时不区分大小写的，并且不能被索引：</p> <div class="language-js extra-class"><pre class="language-js"><code>query<span class="token punctuation">.</span><span class="token function">matches</span><span class="token punctuation">(</span><span class="token string">&quot;playerName&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Michael&quot;</span><span class="token punctuation">,</span> “i”<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>下面的查询区分大小写，会查询每个相应字段包含了给定字符串的对象，并且不能被索引：</p> <div class="language-js extra-class"><pre class="language-js"><code>query<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">&quot;playerName&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Michael&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>上面两个查询都是低效的，事实上，<code>matches</code>和<code>contains</code>查询约束并没有包含在我们的查询指南中，我们也不推荐使用他们。根据你的使用场景，你应该切换到使用下面的查询约束，它可以使用索引：</p> <div class="language-js extra-class"><pre class="language-js"><code>query<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">&quot;playerName&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Michael&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>上面查询会根据给定的字符串查找数据，因为使用了所有，所有查询会更快。</p> <p>作为最佳实践，当你使用正则表达式约束时，你要确保查询中的其他约束能将结果控制在数百个以内，以保证查询效率。如果你必须使用<code>matches</code>或<code>contains</code>约束，那么尽可能使用大小写敏感和锚查询，比如：</p> <div class="language-js extra-class"><pre class="language-js"><code>query<span class="token punctuation">.</span><span class="token function">matches</span><span class="token punctuation">(</span><span class="token string">&quot;playerName&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;^Michael&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>大多数场景下都会使用到包含正则表达式的搜索，稍候会详细介绍更高效的查询方法。</p> <h2 id="编写受约束的查询"><a href="#编写受约束的查询" class="header-anchor">#</a> 编写受约束的查询</h2> <p>编写受约束的查询可以保证只有客户端需要的数据被返回，这在数据使用受限和网络连接不可信的环境下非常重要。在查询章节介绍了你可以添加到查询的约束类型，用以限制返回的数据。增加约束时，你应专注设计高效的查询。</p> <p>你可以使用skip和limit来获取需要的数据，查询条数限制默认为100条：</p> <div class="language-js extra-class"><pre class="language-js"><code>query<span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 限制条数10</span>
</code></pre></div><p>如果你在GeoPoints上遇到问题，确保你指定了合理的半径：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Parse<span class="token punctuation">.</span>Query</span><span class="token punctuation">(</span>PlaceObject<span class="token punctuation">)</span><span class="token punctuation">;</span>
query<span class="token punctuation">.</span><span class="token function">withinMiles</span><span class="token punctuation">(</span><span class="token string">&quot;location&quot;</span><span class="token punctuation">,</span> userGeoPoint<span class="token punctuation">,</span> <span class="token number">10.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
query<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">placesObjects</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Get a list of objects within 10 miles of a user's location</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>你可以使用select进一步的限制返回哪些字段：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> GameScore <span class="token operator">=</span> Parse<span class="token punctuation">.</span>Object<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token string">&quot;GameScore&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Parse<span class="token punctuation">.</span>Query</span><span class="token punctuation">(</span>GameScore<span class="token punctuation">)</span><span class="token punctuation">;</span>
query<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">&quot;score&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;playerName&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
query<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">results</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// each of results will only have the selected fields available.</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="客户端缓存"><a href="#客户端缓存" class="header-anchor">#</a> 客户端缓存</h2> <p>对于IOS和Android应用，你可以开启查询缓存，详情查看<a href="http://docs.parseplatform.org/ios/guide/#caching-queries" target="_blank" rel="noopener noreferrer">IOS<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>和<a href="http://docs.parseplatform.org/android/guide/#caching-queries" target="_blank" rel="noopener noreferrer">Android<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>指南。查询缓存可以提高你的应用性能，尤其是在你想显示客户端从Parse最后一次拉取到的数据的时候。</p> <h2 id="使用云代码"><a href="#使用云代码" class="header-anchor">#</a> 使用云代码</h2> <p>云代码可以让你在Parse服务上运行JavaScript代码，而不是在客户端运行。</p> <p>你可以使用云代码减少客户端逻辑，使应用性能感知上更好。你还可以在云代码中创建对象操作的触发器，这在验证数据和净化数据时很有用。你也可以使用云代码修改相关的对象，或启动其他处理，比如发送推送通知。</p> <p>我们已经看过了通过编写受约束的查询限制返回数据，你也可以使用<a href="http://docs.parseplatform.org/cloudcode/guide/#cloud-functions" target="_blank" rel="noopener noreferrer">云函数<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>来为你的应用限制返回的数据数量。在下面的例子中，我们定义了一个云函数来获取一部电影的平均分：</p> <div class="language-js extra-class"><pre class="language-js"><code>Parse<span class="token punctuation">.</span>Cloud<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token string">&quot;averageStars&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">,</span> response</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> Review <span class="token operator">=</span> Parse<span class="token punctuation">.</span>Object<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token string">&quot;Review&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Parse<span class="token punctuation">.</span>Query</span><span class="token punctuation">(</span>Review<span class="token punctuation">)</span><span class="token punctuation">;</span>
  query<span class="token punctuation">.</span><span class="token function">equalTo</span><span class="token punctuation">(</span><span class="token string">&quot;movie&quot;</span><span class="token punctuation">,</span> request<span class="token punctuation">.</span>params<span class="token punctuation">.</span>movie<span class="token punctuation">)</span><span class="token punctuation">;</span>
  query<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">results</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> results<span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      sum <span class="token operator">+=</span> results<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;stars&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    response<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span>sum <span class="token operator">/</span> results<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    response<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;movie lookup failed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>你也可以在客户端执行一个<code>Review</code>表的查询，只返回<code>stars</code>字段，并在客户端计算结果，随着一部电影的reviews（评论次数）增加，你可以看到返回到客户端的数量也在增加。</p> <p>在你考虑优化你的查询时，你会发现你必须修改这个查询，有时候甚至是在你把应用提交到应用市场以后。不通过修改客户端来修改查询代码是可能的，如果你使用了云函数，你就是要重新设计你的架构，都可以在云代码中完成。</p> <p>上面的查询平均分的云函数例子，在客户端可以像这样调用它：</p> <div class="language-js extra-class"><pre class="language-js"><code>Parse<span class="token punctuation">.</span>Cloud<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token string">&quot;averageStars&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token string">&quot;movie&quot;</span><span class="token operator">:</span> <span class="token string">&quot;The Matrix&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">ratings</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ratings is 4.5</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>如果以后你需要修改数据架构，你的客户端可以保持不变，只要你返回一个表示得分结果的数字就行了。</p> <h2 id="避免count操作"><a href="#避免count操作" class="header-anchor">#</a> 避免Count操作</h2> <p>当使用对象统计功能频繁时，可以考虑在数据库中增加一个统计变量，它会随着对象的增加而增加。然后，统计数据就可以通过简单的检索存储的变量来完成。</p> <p>假设你要在你的应用中显示电影信息，并且你的数据模型是由<code>Movie</code>表和<code>Review</code>表组成，<code>Review</code>表包含了一个指向对象<code>Movie</code>对象的指针。你可能想在顶级导航统计视图显示每个电影的评论次数，查询类似这样：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> Review <span class="token operator">=</span> Parse<span class="token punctuation">.</span>Object<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token string">&quot;Review&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Parse<span class="token punctuation">.</span>Query</span><span class="token punctuation">(</span><span class="token string">&quot;Review&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
query<span class="token punctuation">.</span><span class="token function">equalTo</span><span class="token punctuation">(</span>“movie”<span class="token punctuation">,</span> movie<span class="token punctuation">)</span><span class="token punctuation">;</span>
query<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">count</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Request succeeded</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>如果你为每个UI元素执行这个查询请求，在大数据集中这会很低效。避免使用count操作的办法就是增加一个<code>reviews</code>字段到Movie表，用以表示评论次数，每当<code>Review</code>表新增一个对象，就给对应的<code>Movie</code>对象<code>reviews</code>增加计数。可以通过<code>afterSave</code>触发器完成：</p> <div class="language-js extra-class"><pre class="language-js"><code>Parse<span class="token punctuation">.</span>Cloud<span class="token punctuation">.</span><span class="token function">afterSave</span><span class="token punctuation">(</span><span class="token string">&quot;Review&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">request</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 获取movie对象id</span>
  <span class="token keyword">var</span> movieId <span class="token operator">=</span> request<span class="token punctuation">.</span>object<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;movie&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>id<span class="token punctuation">;</span>
  <span class="token comment">// 查询movie对象</span>
  <span class="token keyword">var</span> Movie <span class="token operator">=</span> Parse<span class="token punctuation">.</span>Object<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token string">&quot;Movie&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Parse<span class="token punctuation">.</span>Query</span><span class="token punctuation">(</span>Movie<span class="token punctuation">)</span><span class="token punctuation">;</span>
  query<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>movieId<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">movie</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 给reviews增加计数</span>
    movie<span class="token punctuation">.</span><span class="token function">increment</span><span class="token punctuation">(</span><span class="token string">&quot;reviews&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    movie<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token string">&quot;Got an error &quot;</span> <span class="token operator">+</span> error<span class="token punctuation">.</span>code <span class="token operator">+</span> <span class="token string">&quot; : &quot;</span> <span class="token operator">+</span> error<span class="token punctuation">.</span>message<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>这样，就可以避免使用count，也能获取到统计信息了：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> Movie <span class="token operator">=</span> Parse<span class="token punctuation">.</span>Object<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token string">&quot;Movie&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Parse<span class="token punctuation">.</span>Query</span><span class="token punctuation">(</span>Movie<span class="token punctuation">)</span><span class="token punctuation">;</span>
query<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">results</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 结果中包含reviews统计字段</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Request failed</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>你也可以使用单独的Parse对象来监测每个评论的数量，每当一个评论增加或减少，就通过<code>afterSave</code>或<code>afterDelete</code>触发器来做相应的计数增减。你可以根据你的使用场景来选择。</p> <h2 id="使用高效的查询"><a href="#使用高效的查询" class="header-anchor">#</a> 使用高效的查询</h2> <p>正如前文提高的，MongoDB对字符串部分匹配的查询支持不够好，但是，这是产品中实现可拓展的搜索功能的重要功能。</p> <p>简单搜索算法只是扫描class表中的所有数据，并对每个条目进行查询。编写高效查询的关键，在于使用索引执行每个查询时，将必须被检查的数据量降到最低。你将需要用一种方便建立索引的构建你的数据模型，比如，随着数据集的增长，字符串查询将不能匹配不能被索引、会造成超时的字符串。</p> <p>我们通过一个例子来了解如何构建一个高效的查询，你可以将这个例子中学到的概念应用到你的使用场景中。假设你的应用有用户发布文章，并且你想为应用提供标签搜索或关键词搜索的能力，你需要预处理你的文章，并在一个数组字段中保存标签或关键词。你可以在你的应用中在文章保存后处理，也可以使用<code>beforeSave</code>触发器在云函数中处理：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> _ <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;underscore&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Parse<span class="token punctuation">.</span>Cloud<span class="token punctuation">.</span><span class="token function">beforeSave</span><span class="token punctuation">(</span><span class="token string">&quot;Post&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">,</span> response</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> post <span class="token operator">=</span> request<span class="token punctuation">.</span>object<span class="token punctuation">;</span>
  <span class="token keyword">var</span> <span class="token function-variable function">toLowerCase</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">w</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> w<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> words <span class="token operator">=</span> post<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;text&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\b</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  words <span class="token operator">=</span> _<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>words<span class="token punctuation">,</span> toLowerCase<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> stopWords <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;the&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;in&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;and&quot;</span><span class="token punctuation">]</span>
  words <span class="token operator">=</span> _<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>words<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">w</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> w<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^\w+$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>   _<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>stopWords<span class="token punctuation">,</span> w<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> hashtags <span class="token operator">=</span> post<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;text&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">#.+?\b</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  hashtags <span class="token operator">=</span> _<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>hashtags<span class="token punctuation">,</span> toLowerCase<span class="token punctuation">)</span><span class="token punctuation">;</span>
  post<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;words&quot;</span><span class="token punctuation">,</span> words<span class="token punctuation">)</span><span class="token punctuation">;</span>
  post<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;hashtags&quot;</span><span class="token punctuation">,</span> hashtags<span class="token punctuation">)</span><span class="token punctuation">;</span>
  response<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>上面代码会保存关键词和标签到数组字段，并会被MongoDB用多键索引。其中有几个要点需要说明。首先，所有的字符串都被转换成了小写，以便我们使用小写字母查询，并且还能大小写敏感；其次，其中过滤掉了注入&quot;the&quot;,&quot;in&quot;,&quot;and&quot;之类会出现在很多文章中的单词，在执行时会减少很多无用的扫描。</p> <p>当你建立了关键词字段后，你就可以使用<code>containsAll</code>约束高效的查询了：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> Post <span class="token operator">=</span> Parse<span class="token punctuation">.</span>Object<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token string">&quot;Post&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Parse<span class="token punctuation">.</span>Query</span><span class="token punctuation">(</span>Post<span class="token punctuation">)</span><span class="token punctuation">;</span>
query<span class="token punctuation">.</span><span class="token function">containsAll</span><span class="token punctuation">(</span><span class="token string">&quot;hashtags&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>“#parse”<span class="token punctuation">,</span> “#ftw”<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
query<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">results</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Request succeeded</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Request failed</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="限额和其他考虑"><a href="#限额和其他考虑" class="header-anchor">#</a> 限额和其他考虑</h2> <p>为了让API以高性能的方式为你提供数据，在空间上会有一些限额。我们未来可能会调整这些(不可能了)，请花点时间看看下面列表：</p> <h5 id="对象"><a href="#对象" class="header-anchor">#</a> 对象</h5> <ul><li>Parse对象被限制在128k以内。</li> <li>我们建议不要创建超过64个字段，以便我们为你的查询构建高校的索引。</li> <li>我们建议你的字段名吗不要超过1024个字符，否则这个字段将不会被建立索引。</li></ul> <h5 id="查询"><a href="#查询" class="header-anchor">#</a> 查询</h5> <ul><li>查询默认返回100个对象，使用limit方法可以修改。</li> <li>skips和limits只可以被外部查询使用。</li> <li>相互冲突的约束将会导致只有一个约束被应用，比如说有两个<code>equalTo</code>约束应用在同一个字段和不同的值，那么只有一个会被应用。（可能你需要的是<code>containedIn</code>）。</li> <li>在复查查询or中没有地理位置查询。</li> <li>使用<code>$exists:false</code>是不明智的。</li> <li>JavaScript SDK中的每一个查询方法都不能与使用地理位置约束的查询联合使用。</li> <li><code>containsAll</code>查询约束最多包含9个元素。</li></ul> <h5 id="推送通知"><a href="#推送通知" class="header-anchor">#</a> 推送通知</h5> <ul><li><a href="https://www.gitbook.com/book/jaweii/parse/edit#" target="_blank" rel="noopener noreferrer">Delivery of notifications is a “best effort”, not guaranteed<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.  它不打算推送数据到你的应用，只是通知用户有新的数据可用。</li></ul> <h5 id="云代码"><a href="#云代码" class="header-anchor">#</a> 云代码</h5> <ul><li>传给云函数的params载荷被限制在50MB以内。</li></ul></div> <!----></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">7/10/2021, 6:45:09 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/zh/frontend/parse/security.html" class="prev">安全security</a></span> <span class="next"><a href="/zh/frontend/parse/error-code.html">错误码error-code</a>
      →
    </span></p></div> </main></div><div class="global-ui"><div></div><div class="add-this"></div><div tabindex="-1" role="dialog" aria-hidden="true" class="pswp"><div class="pswp__bg"></div> <div class="pswp__scroll-wrap"><div class="pswp__container"><div class="pswp__item"></div> <div class="pswp__item"></div> <div class="pswp__item"></div></div> <div class="pswp__ui pswp__ui--hidden"><div class="pswp__top-bar"><div class="pswp__counter"></div> <button title="Close (Esc)" class="pswp__button pswp__button--close"></button> <button title="Share" class="pswp__button pswp__button--share"></button> <button title="Toggle fullscreen" class="pswp__button pswp__button--fs"></button> <button title="Zoom in/out" class="pswp__button pswp__button--zoom"></button> <div class="pswp__preloader"><div class="pswp__preloader__icn"><div class="pswp__preloader__cut"><div class="pswp__preloader__donut"></div></div></div></div></div> <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class="pswp__share-tooltip"></div></div> <button title="Previous (arrow left)" class="pswp__button pswp__button--arrow--left"></button> <button title="Next (arrow right)" class="pswp__button pswp__button--arrow--right"></button> <div class="pswp__caption"><div class="pswp__caption__center"></div></div></div></div></div></div></div>
    <script src="/assets/js/app.4e242cc4.js" defer></script><script src="/assets/js/7.57a5124b.js" defer></script><script src="/assets/js/5.7fd7e714.js" defer></script><script src="/assets/js/137.cf1aa4b6.js" defer></script>
  </body>
</html>
