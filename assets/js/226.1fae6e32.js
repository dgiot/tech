(window.webpackJsonp=window.webpackJsonp||[]).push([[226],{443:function(t,s,a){"use strict";a.r(s);var n=a(10),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"连接器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#连接器"}},[t._v("#")]),t._v(" 连接器")]),t._v(" "),a("p",[t._v("TDengine提供了丰富的应用程序开发接口，其中包括C/C++、Java、Python、Go、Node.js、C# 、RESTful 等，便于用户快速开发应用。")]),t._v(" "),a("p",[a("img",{attrs:{src:"http://dgiot-1253666439.cos.ap-shanghai-fsi.myqcloud.com/tdengine/images/connector.png",alt:"connector.png"}})]),t._v(" "),a("p",[t._v("目前TDengine的连接器可支持的平台广泛，包括：X64/X86/ARM64/ARM32/MIPS/Alpha等硬件平台，以及Linux/Win64/Win32等开发环境。对照矩阵如下：")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[a("strong",[t._v("CPU")])]),t._v(" "),a("th",[a("strong",[t._v("X64   64bit")])]),t._v(" "),a("th",[a("strong",[t._v("X64   64bit")])]),t._v(" "),a("th",[a("strong",[t._v("X64   64bit")])]),t._v(" "),a("th",[a("strong",[t._v("X86   32bit")])]),t._v(" "),a("th",[a("strong",[t._v("ARM64")])]),t._v(" "),a("th",[a("strong",[t._v("ARM32")])]),t._v(" "),a("th",[a("strong",[t._v("MIPS   龙芯")])]),t._v(" "),a("th",[a("strong",[t._v("Alpha   申威")])]),t._v(" "),a("th",[a("strong",[t._v("X64   海光")])])])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("strong",[t._v("OS")])]),t._v(" "),a("td",[a("strong",[t._v("Linux")])]),t._v(" "),a("td",[a("strong",[t._v("Win64")])]),t._v(" "),a("td",[a("strong",[t._v("Win32")])]),t._v(" "),a("td",[a("strong",[t._v("Win32")])]),t._v(" "),a("td",[a("strong",[t._v("Linux")])]),t._v(" "),a("td",[a("strong",[t._v("Linux")])]),t._v(" "),a("td",[a("strong",[t._v("Linux")])]),t._v(" "),a("td",[a("strong",[t._v("Linux")])]),t._v(" "),a("td",[a("strong",[t._v("Linux")])])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("C/C++")])]),t._v(" "),a("td",[t._v("●")]),t._v(" "),a("td",[t._v("●")]),t._v(" "),a("td",[t._v("●")]),t._v(" "),a("td",[t._v("○")]),t._v(" "),a("td",[t._v("●")]),t._v(" "),a("td",[t._v("●")]),t._v(" "),a("td",[t._v("○")]),t._v(" "),a("td",[t._v("○")]),t._v(" "),a("td",[t._v("○")])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("JDBC")])]),t._v(" "),a("td",[t._v("●")]),t._v(" "),a("td",[t._v("●")]),t._v(" "),a("td",[t._v("●")]),t._v(" "),a("td",[t._v("○")]),t._v(" "),a("td",[t._v("●")]),t._v(" "),a("td",[t._v("●")]),t._v(" "),a("td",[t._v("○")]),t._v(" "),a("td",[t._v("○")]),t._v(" "),a("td",[t._v("○")])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("Python")])]),t._v(" "),a("td",[t._v("●")]),t._v(" "),a("td",[t._v("●")]),t._v(" "),a("td",[t._v("●")]),t._v(" "),a("td",[t._v("○")]),t._v(" "),a("td",[t._v("●")]),t._v(" "),a("td",[t._v("●")]),t._v(" "),a("td",[t._v("○")]),t._v(" "),a("td",[t._v("--")]),t._v(" "),a("td",[t._v("○")])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("Go")])]),t._v(" "),a("td",[t._v("●")]),t._v(" "),a("td",[t._v("●")]),t._v(" "),a("td",[t._v("●")]),t._v(" "),a("td",[t._v("○")]),t._v(" "),a("td",[t._v("●")]),t._v(" "),a("td",[t._v("●")]),t._v(" "),a("td",[t._v("○")]),t._v(" "),a("td",[t._v("--")]),t._v(" "),a("td",[t._v("--")])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("NodeJs")])]),t._v(" "),a("td",[t._v("●")]),t._v(" "),a("td",[t._v("●")]),t._v(" "),a("td",[t._v("○")]),t._v(" "),a("td",[t._v("○")]),t._v(" "),a("td",[t._v("●")]),t._v(" "),a("td",[t._v("●")]),t._v(" "),a("td",[t._v("○")]),t._v(" "),a("td",[t._v("--")]),t._v(" "),a("td",[t._v("--")])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("C#")])]),t._v(" "),a("td",[t._v("○")]),t._v(" "),a("td",[t._v("●")]),t._v(" "),a("td",[t._v("●")]),t._v(" "),a("td",[t._v("○")]),t._v(" "),a("td",[t._v("○")]),t._v(" "),a("td",[t._v("○")]),t._v(" "),a("td",[t._v("○")]),t._v(" "),a("td",[t._v("--")]),t._v(" "),a("td",[t._v("--")])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("RESTful")])]),t._v(" "),a("td",[t._v("●")]),t._v(" "),a("td",[t._v("●")]),t._v(" "),a("td",[t._v("●")]),t._v(" "),a("td",[t._v("●")]),t._v(" "),a("td",[t._v("●")]),t._v(" "),a("td",[t._v("●")]),t._v(" "),a("td",[t._v("○")]),t._v(" "),a("td",[t._v("○")]),t._v(" "),a("td",[t._v("○")])])])]),t._v(" "),a("p",[t._v("其中 ● 表示经过官方测试验证， ○ 表示非官方测试验证。")]),t._v(" "),a("p",[t._v("注意：")]),t._v(" "),a("ul",[a("li",[t._v("在没有安装TDengine服务端软件的系统中使用连接器（除RESTful外）访问 TDengine 数据库，需要安装相应版本的客户端安装包来使应用驱动（Linux系统中文件名为libtaos.so，Windows系统中为taos.dll）被安装在系统中，否则会产生无法找到相应库文件的错误。")]),t._v(" "),a("li",[t._v("所有执行 SQL 语句的 API，例如 C/C++ Connector 中的 "),a("code",[t._v("tao_query")]),t._v("、"),a("code",[t._v("taos_query_a")]),t._v("、"),a("code",[t._v("taos_subscribe")]),t._v(" 等，以及其它语言中与它们对应的API，每次都只能执行一条 SQL 语句，如果实际参数中包含了多条语句，它们的行为是未定义的。")]),t._v(" "),a("li",[t._v("升级到TDengine到2.0.8.0版本的用户，必须更新JDBC连接TDengine必须升级taos-jdbcdriver到2.0.12及以上。")]),t._v(" "),a("li",[t._v("无论选用何种编程语言的连接器，2.0 及以上版本的 TDengine 推荐数据库应用的每个线程都建立一个独立的连接，或基于线程建立连接池，以避免连接内的“USE statement”状态量在线程之间相互干扰（但连接的查询和写入操作都是线程安全的）。")])]),t._v(" "),a("h2",{attrs:{id:"安装连接器驱动步骤"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装连接器驱动步骤"}},[t._v("#")]),t._v(" "),a("a",{staticClass:"anchor",attrs:{id:"driver"}}),t._v("安装连接器驱动步骤")]),t._v(" "),a("p",[t._v("服务器应该已经安装TDengine服务端安装包。连接器驱动安装步骤如下：")]),t._v(" "),a("p",[a("strong",[t._v("Linux")])]),t._v(" "),a("p",[a("strong",[t._v("1.   从涛思官网（https://www.taosdata.com/cn/all-downloads/）下载")])]),t._v(" "),a("ul",[a("li",[a("p",[t._v("X64硬件环境：TDengine-client-2.x.x.x-Linux-x64.tar.gz")])]),t._v(" "),a("li",[a("p",[t._v("ARM64硬件环境：TDengine-client-2.x.x.x-Linux-aarch64.tar.gz")])]),t._v(" "),a("li",[a("p",[t._v("ARM32硬件环境：TDengine-client-2.x.x.x-Linux-aarch32.tar.gz")])])]),t._v(" "),a("p",[a("strong",[t._v("2.   解压缩软件包")])]),t._v(" "),a("p",[t._v("将软件包放置在当前用户可读写的任意目录下，然后执行下面的命令：")]),t._v(" "),a("p",[a("code",[t._v("tar -xzvf TDengine-client-xxxxxxxxx.tar.gz")])]),t._v(" "),a("p",[t._v("其中xxxxxxx需要替换为实际版本的字符串。")]),t._v(" "),a("p",[a("strong",[t._v("3.   执行安装脚本")])]),t._v(" "),a("p",[t._v("解压软件包之后，会在解压目录下看到以下文件(目录)：")]),t._v(" "),a("p",[t._v("​    "),a("em",[t._v("install_client.sh")]),t._v("：安装脚本，用于应用驱动程序\n​    "),a("em",[t._v("taos.tar.gz")]),t._v("：应用驱动安装包\n​    "),a("em",[t._v("driver")]),t._v("：TDengine应用驱动driver\n​    "),a("em",[t._v("connector")]),t._v(": 各种编程语言连接器（go/grafanaplugin/nodejs/python/JDBC）\n​    "),a("em",[t._v("examples")]),t._v(": 各种编程语言的示例程序(c/C#/go/JDBC/matlab/python/R)")]),t._v(" "),a("p",[t._v("运行install_client.sh进行安装")]),t._v(" "),a("p",[a("strong",[t._v("4.   配置taos.cfg")])]),t._v(" "),a("p",[t._v("编辑taos.cfg文件(默认路径/etc/taos/taos.cfg)，将firstEP修改为TDengine服务器的End Point，例如：h1.taos.com:6030")]),t._v(" "),a("p",[a("strong",[t._v("提示： 如本机没有部署TDengine服务，仅安装了应用驱动，则taos.cfg中仅需配置firstEP，无需配置FQDN。")])]),t._v(" "),a("p",[a("strong",[t._v("Windows x64/x86")])]),t._v(" "),a("p",[a("strong",[t._v("1.   从涛思官网（https://www.taosdata.com/cn/all-downloads/）下载 ：")])]),t._v(" "),a("ul",[a("li",[a("p",[t._v("X64硬件环境：TDengine-client-2.X.X.X-Windows-x64.exe")])]),t._v(" "),a("li",[a("p",[t._v("X86硬件环境：TDengine-client-2.X.X.X-Windows-x86.exe")])])]),t._v(" "),a("p",[a("strong",[t._v("2. 执行安装程序，按提示选择默认值，完成安装")])]),t._v(" "),a("p",[a("strong",[t._v("3. 安装路径")])]),t._v(" "),a("p",[t._v("默认安装路径为：C:\\TDengine，其中包括以下文件(目录)：")]),t._v(" "),a("p",[t._v("​    "),a("em",[t._v("taos.exe")]),t._v("：taos shell命令行程序")]),t._v(" "),a("p",[t._v("​    "),a("em",[t._v("cfg")]),t._v(" : 配置文件目录\n​    "),a("em",[t._v("driver")]),t._v(": 应用驱动动态链接库\n​    "),a("em",[t._v("examples")]),t._v(": 示例程序 bash/C/C#/go/JDBC/Python/Node.js\n​    "),a("em",[t._v("include")]),t._v(": 头文件\n​    "),a("em",[t._v("log")]),t._v(" : 日志文件\n​    "),a("em",[t._v("unins000.exe")]),t._v(": 卸载程序")]),t._v(" "),a("p",[a("strong",[t._v("4. 配置taos.cfg")])]),t._v(" "),a("p",[t._v("编辑taos.cfg文件(默认路径C:\\TDengine\\cfg\\taos.cfg)，将firstEP修改为TDengine服务器的End Point，例如：h1.taos.com:6030")]),t._v(" "),a("p",[a("strong",[t._v("提示：")])]),t._v(" "),a("p",[a("strong",[t._v("1. 如利用FQDN连接服务器，必须确认本机网络环境DNS已配置好，或在hosts文件中添加FQDN寻址记录，如编辑C:\\Windows\\system32\\drivers\\etc\\hosts，添加如下的记录：")]),t._v(" "),a("strong",[t._v("192.168.1.99  h1.taos.com")])]),t._v(" "),a("p",[a("strong",[t._v("2．卸载：运行unins000.exe可卸载TDengine应用驱动。")])]),t._v(" "),a("p",[a("strong",[t._v("安装验证")])]),t._v(" "),a("p",[t._v("以上安装和配置完成后，并确认TDengine服务已经正常启动运行，此时可以执行taos客户端进行登录。")]),t._v(" "),a("p",[a("strong",[t._v("Linux环境：")])]),t._v(" "),a("p",[t._v("在linux shell下直接执行 taos，应该就能正常链接到tdegine服务，进入到taos shell界面，示例如下：")]),t._v(" "),a("div",{staticClass:"language-mysql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("$ taos     \nWelcome to the TDengine shell from Linux, Client  Version:2.0.5.0  \nCopyright (c) 2017 by TAOS Data, Inc. All rights  reserved.     \ntaos> show databases;           \nname       |   created_time    |   ntables  |  vgroups   | replica | quorum | days |    keep1,keep2,keep(D)   | cache(MB)|   blocks  |  minrows   |  maxrows  | wallevel |  fsync    | comp | precision |    status  |  \n=========================================================================================================================================================================================================================  \ntest       | 2020-10-14  10:35:48.617 |     10 |      1 |    1 |   1 |     2 | 3650,3650,3650        |     16|      6 |     100 |    4096 |    1 |    3000 |  2 | ms      | ready    |   \nlog        | 2020-10-12  09:08:21.651 |      4 |      1 |    1 |   1 |   10 | 30,30,30               |      1|      3 |     100 |    4096 |    1 |    3000 |  2 | us    | ready    |  \nQuery OK, 2 row(s) in set (0.001198s)     \ntaos>  \n")])])]),a("p",[a("strong",[t._v("Windows（x64/x86）环境：")])]),t._v(" "),a("p",[t._v("在cmd下进入到c:\\TDengine目录下直接执行 taos.exe，应该就能正常链接到tdegine服务，进入到taos shell界面，示例如下：")]),t._v(" "),a("div",{staticClass:"language-mysql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("  C:\\TDengine>taos     \n  Welcome to the TDengine  shell from Linux, Client Version:2.0.5.0  \n  Copyright (c) 2017 by  TAOS Data, Inc. All rights reserved.     \n  taos> show  databases;         \n  name       |   created_time    |   ntables  |  vgroups   | replica | quorum | days |    keep1,keep2,keep(D)   | cache(MB)   |  blocks  |   minrows  |  maxrows   | wallevel |  fsync  | comp | precision |  status    |  \n  ===================================================================================================================================================================================================================================================================   \n  test       | 2020-10-14  10:35:48.617 |     10 |      1 |    1 |   1 |     2 | 3650,3650,3650        |     16 |      6 |     100 |    4096 |    1 |    3000 |  2 | ms    | ready    |   \n  log        | 2020-10-12  09:08:21.651 |      4 |      1 |    1 |   1 |    10 | 30,30,30              |      1 |      3 |     100 |    4096 |    1 |    3000 |  2 | us    | ready    |  \n  Query OK, 2 row(s) in  set (0.045000s)     \n  taos>  \n")])])]),a("h2",{attrs:{id:"c-c-connector"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#c-c-connector"}},[t._v("#")]),t._v(" "),a("a",{staticClass:"anchor",attrs:{id:"c-cpp"}}),t._v("C/C++ Connector")]),t._v(" "),a("p",[a("strong",[t._v("C/C++连接器支持的系统有")]),t._v("：")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[a("strong",[t._v("CPU类型")])]),t._v(" "),a("th",[t._v("x64（64bit）")]),t._v(" "),a("th"),t._v(" "),a("th"),t._v(" "),a("th",[t._v("ARM64")]),t._v(" "),a("th",[t._v("ARM32")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("strong",[t._v("OS类型")])]),t._v(" "),a("td",[t._v("Linux")]),t._v(" "),a("td",[t._v("Win64")]),t._v(" "),a("td",[t._v("Win32")]),t._v(" "),a("td",[t._v("Linux")]),t._v(" "),a("td",[t._v("Linux")])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("支持与否")])]),t._v(" "),a("td",[a("strong",[t._v("支持")])]),t._v(" "),a("td",[a("strong",[t._v("支持")])]),t._v(" "),a("td",[a("strong",[t._v("支持")])]),t._v(" "),a("td",[a("strong",[t._v("支持")])]),t._v(" "),a("td",[a("strong",[t._v("开发中")])])])])]),t._v(" "),a("p",[t._v("C/C++的API类似于MySQL的C API。应用程序使用时，需要包含TDengine头文件 "),a("em",[t._v("taos.h")]),t._v("（安装后，位于 "),a("em",[t._v("/usr/local/taos/include")]),t._v("）：")]),t._v(" "),a("div",{staticClass:"language-C extra-class"},[a("pre",{pre:!0,attrs:{class:"language-c"}},[a("code",[a("span",{pre:!0,attrs:{class:"token macro property"}},[a("span",{pre:!0,attrs:{class:"token directive-hash"}},[t._v("#")]),a("span",{pre:!0,attrs:{class:"token directive keyword"}},[t._v("include")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("<taos.h>")])]),t._v("\n")])])]),a("p",[t._v("注意：")]),t._v(" "),a("ul",[a("li",[t._v("在编译时需要链接TDengine动态库。Linux 为 "),a("em",[t._v("libtaos.so")]),t._v(" ，安装后，位于 "),a("em",[t._v("/usr/local/taos/driver")]),t._v("。Windows为 taos.dll，安装后位于  "),a("em",[t._v("C:\\TDengine")]),t._v("。")]),t._v(" "),a("li",[t._v("如未特别说明，当API的返回值是整数时，"),a("em",[t._v("0")]),t._v(" 代表成功，其它是代表失败原因的错误码，当返回值是指针时， "),a("em",[t._v("NULL")]),t._v(" 表示失败。")])]),t._v(" "),a("p",[t._v("使用C/C++连接器的示例代码请参见 https://github.com/taosdata/TDengine/tree/develop/tests/examples/c 。")]),t._v(" "),a("h3",{attrs:{id:"基础api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基础api"}},[t._v("#")]),t._v(" 基础API")]),t._v(" "),a("p",[t._v("基础API用于完成创建数据库连接等工作，为其它API的执行提供运行时环境。")]),t._v(" "),a("ul",[a("li",[a("p",[a("code",[t._v("void taos_init()")])]),t._v(" "),a("p",[t._v("初始化运行环境。如果应用没有主动调用该API，那么应用在调用"),a("code",[t._v("taos_connect")]),t._v("时将自动调用，故应用程序一般无需手动调用该API。")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("void taos_cleanup()")])]),t._v(" "),a("p",[t._v("清理运行环境，应用退出前应调用此API。")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("int taos_options(TSDB_OPTION option, const void * arg, ...)")])]),t._v(" "),a("p",[t._v("设置客户端选项，目前只支持时区设置（"),a("em",[t._v("TSDB_OPTION_TIMEZONE")]),t._v("）和编码设置（"),a("em",[t._v("TSDB_OPTION_LOCALE")]),t._v("）。时区和编码默认为操作系统当前设置。")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("char *taos_get_client_info()")])]),t._v(" "),a("p",[t._v("获取客户端版本信息。")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("TAOS *taos_connect(const char *host, const char *user, const char *pass, const char *db, int port)")])]),t._v(" "),a("p",[t._v("创建数据库连接，初始化连接上下文。其中需要用户提供的参数包含：")]),t._v(" "),a("ul",[a("li",[t._v("host：TDengine管理主节点的FQDN")]),t._v(" "),a("li",[t._v("user：用户名")]),t._v(" "),a("li",[t._v("pass：密码")]),t._v(" "),a("li",[t._v("db：数据库名字，如果用户没有提供，也可以正常连接，用户可以通过该连接创建新的数据库，如果用户提供了数据库名字，则说明该数据库用户已经创建好，缺省使用该数据库")]),t._v(" "),a("li",[t._v("port：端口号")])]),t._v(" "),a("p",[t._v("返回值为空表示失败。应用程序需要保存返回的参数，以便后续API调用。")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("char *taos_get_server_info(TAOS *taos)")])]),t._v(" "),a("p",[t._v("获取服务端版本信息。")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("int taos_select_db(TAOS *taos, const char *db)")])]),t._v(" "),a("p",[t._v("将当前的缺省数据库设置为"),a("code",[t._v("db")]),t._v("。")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("void taos_close(TAOS *taos)")])]),t._v(" "),a("p",[t._v("关闭连接, 其中"),a("code",[t._v("taos")]),t._v("是"),a("code",[t._v("taos_connect")]),t._v("函数返回的指针。")])])]),t._v(" "),a("h3",{attrs:{id:"同步查询api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#同步查询api"}},[t._v("#")]),t._v(" 同步查询API")]),t._v(" "),a("p",[t._v("传统的数据库操作API，都属于同步操作。应用调用API后，一直处于阻塞状态，直到服务器返回结果。TDengine支持如下API：")]),t._v(" "),a("ul",[a("li",[a("p",[a("code",[t._v("TAOS_RES* taos_query(TAOS *taos, const char *sql)")])]),t._v(" "),a("p",[t._v("该API用来执行SQL语句，可以是DQL、DML或DDL语句。 其中的"),a("code",[t._v("taos")]),t._v("参数是通过"),a("code",[t._v("taos_connect")]),t._v("获得的指针。返回值 NULL 表示失败。")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("int taos_result_precision(TAOS_RES *res)")])]),t._v(" "),a("p",[t._v("返回结果集时间戳字段的精度，"),a("code",[t._v("0")]),t._v(" 代表毫秒，"),a("code",[t._v("1")]),t._v(" 代表微秒，"),a("code",[t._v("2")]),t._v(" 代表纳秒。")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("TAOS_ROW taos_fetch_row(TAOS_RES *res)")])]),t._v(" "),a("p",[t._v("按行获取查询结果集中的数据。")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("int taos_fetch_block(TAOS_RES *res, TAOS_ROW *rows)")])]),t._v(" "),a("p",[t._v("批量获取查询结果集中的数据，返回值为获取到的数据的行数。")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("int taos_num_fields(TAOS_RES *res)")]),t._v(" 和 "),a("code",[t._v("int taos_field_count(TAOS_RES *res)")])]),t._v(" "),a("p",[t._v("这两个API等价，用于获取查询结果集中的列数。")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("int* taos_fetch_lengths(TAOS_RES *res)")])]),t._v(" "),a("p",[t._v("获取结果集中每个字段的长度。 返回值是一个数组，其长度为结果集的列数。")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("int taos_affected_rows(TAOS_RES *res)")])]),t._v(" "),a("p",[t._v("获取被所执行的 SQL 语句影响的行数。")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("TAOS_FIELD *taos_fetch_fields(TAOS_RES *res)")])]),t._v(" "),a("p",[t._v("获取查询结果集每列数据的属性（数据类型、名字、字节数），与taos_num_fileds配合使用，可用来解析"),a("code",[t._v("taos_fetch_row")]),t._v("返回的一个元组(一行)的数据。 "),a("code",[t._v("TAOS_FIELD")]),t._v(" 的结构如下：")])])]),t._v(" "),a("div",{staticClass:"language-c extra-class"},[a("pre",{pre:!0,attrs:{class:"language-c"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typedef")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("struct")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("taosField")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("char")]),t._v("     name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("65")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 列名")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("uint8_t")]),t._v("  type"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 数据类型")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("int16_t")]),t._v("  bytes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("     "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 字节数")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" TAOS_FIELD"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("ul",[a("li",[a("p",[a("code",[t._v("void taos_stop_query(TAOS_RES *res)")])]),t._v(" "),a("p",[t._v("停止一个查询的执行。")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("void taos_free_result(TAOS_RES *res)")])]),t._v(" "),a("p",[t._v("释放查询结果集以及相关的资源。查询完成后，务必调用该API释放资源，否则可能导致应用内存泄露。但也需注意，释放资源后，如果再调用"),a("code",[t._v("taos_consume")]),t._v("等获取查询结果的函数，将导致应用Crash。")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("char *taos_errstr(TAOS_RES *res)")])]),t._v(" "),a("p",[t._v("获取最近一次API调用失败的原因,返回值为字符串。")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("char *taos_errno(TAOS_RES *res)")])]),t._v(" "),a("p",[t._v("获取最近一次API调用失败的原因，返回值为错误代码。")])])]),t._v(" "),a("p",[a("strong",[t._v("注意")]),t._v("：2.0及以上版本 TDengine 推荐数据库应用的每个线程都建立一个独立的连接，或基于线程建立连接池。而不推荐在应用中将该连接 (TAOS*) 结构体传递到不同的线程共享使用。基于 TAOS 结构体发出的查询、写入等操作具有多线程安全性，但 “USE statement” 等状态量有可能在线程之间相互干扰。此外，C 语言的连接器可以按照需求动态建立面向数据库的新连接（该过程对用户不可见），同时建议只有在程序最后退出的时候才调用 taos_close 关闭连接。")]),t._v(" "),a("h3",{attrs:{id:"异步查询api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#异步查询api"}},[t._v("#")]),t._v(" 异步查询API")]),t._v(" "),a("p",[t._v("同步API之外，TDengine还提供性能更高的异步调用API处理数据插入、查询操作。在软硬件环境相同的情况下，异步API处理数据插入的速度比同步API快2～4倍。异步API采用非阻塞式的调用方式，在系统真正完成某个具体数据库操作前，立即返回。调用的线程可以去处理其他工作，从而可以提升整个应用的性能。异步API在网络延迟严重的情况下，优点尤为突出。")]),t._v(" "),a("p",[t._v("异步API都需要应用提供相应的回调函数，回调函数参数设置如下：前两个参数都是一致的，第三个参数依不同的API而定。第一个参数param是应用调用异步API时提供给系统的，用于回调时，应用能够找回具体操作的上下文，依具体实现而定。第二个参数是SQL操作的结果集，如果为空，比如insert操作，表示没有记录返回，如果不为空，比如select操作，表示有记录返回。")]),t._v(" "),a("p",[t._v("异步API对于使用者的要求相对较高，用户可根据具体应用场景选择性使用。下面是三个重要的异步API：")]),t._v(" "),a("ul",[a("li",[a("p",[a("code",[t._v("void taos_query_a(TAOS *taos, const char *sql, void (*fp)(void *param, TAOS_RES *, int code), void *param);")])]),t._v(" "),a("p",[t._v("异步执行SQL语句。")]),t._v(" "),a("ul",[a("li",[t._v("taos：调用taos_connect返回的数据库连接")]),t._v(" "),a("li",[t._v("sql：需要执行的SQL语句")]),t._v(" "),a("li",[t._v("fp：用户定义的回调函数，其第三个参数"),a("code",[t._v("code")]),t._v("用于指示操作是否成功，"),a("code",[t._v("0")]),t._v("表示成功，负数表示失败(调用"),a("code",[t._v("taos_errstr")]),t._v("获取失败原因)。应用在定义回调函数的时候，主要处理第二个参数"),a("code",[t._v("TAOS_RES *")]),t._v("，该参数是查询返回的结果集")]),t._v(" "),a("li",[t._v("param：应用提供一个用于回调的参数")])])]),t._v(" "),a("li",[a("p",[a("code",[t._v("void taos_fetch_rows_a(TAOS_RES *res, void (*fp)(void *param, TAOS_RES *, int numOfRows), void *param);")])]),t._v(" "),a("p",[t._v("批量获取异步查询的结果集，只能与"),a("code",[t._v("taos_query_a")]),t._v("配合使用。其中：")]),t._v(" "),a("ul",[a("li",[t._v("res："),a("code",[t._v("taos_query_a")]),t._v("回调时返回的结果集")]),t._v(" "),a("li",[t._v("fp：回调函数。其参数"),a("code",[t._v("param")]),t._v("是用户可定义的传递给回调函数的参数结构体；"),a("code",[t._v("numOfRows")]),t._v("是获取到的数据的行数（不是整个查询结果集的函数）。 在回调函数中，应用可以通过调用"),a("code",[t._v("taos_fetch_row")]),t._v("前向迭代获取批量记录中每一行记录。读完一块内的所有记录后，应用需要在回调函数中继续调用"),a("code",[t._v("taos_fetch_rows_a")]),t._v("获取下一批记录进行处理，直到返回的记录数（numOfRows）为零（结果返回完成）或记录数为负值（查询出错）。")])])])]),t._v(" "),a("p",[t._v("TDengine的异步API均采用非阻塞调用模式。应用程序可以用多线程同时打开多张表，并可以同时对每张打开的表进行查询或者插入操作。需要指出的是，"),a("strong",[t._v("客户端应用必须确保对同一张表的操作完全串行化")]),t._v("，即对同一个表的插入或查询操作未完成时（未返回时），不能够执行第二个插入或查询操作。")]),t._v(" "),a("h3",{attrs:{id:"参数绑定api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参数绑定api"}},[t._v("#")]),t._v(" 参数绑定API")]),t._v(" "),a("p",[t._v("除了直接调用 "),a("code",[t._v("taos_query")]),t._v(" 进行查询，TDengine也提供了支持参数绑定的Prepare API，与 MySQL 一样，这些API目前也仅支持用问号"),a("code",[t._v("?")]),t._v("来代表待绑定的参数，具体如下：")]),t._v(" "),a("ul",[a("li",[a("p",[a("code",[t._v("TAOS_STMT* taos_stmt_init(TAOS *taos)")])]),t._v(" "),a("p",[t._v("创建一个 TAOS_STMT 对象用于后续调用。")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("int taos_stmt_prepare(TAOS_STMT *stmt, const char *sql, unsigned long length)")])]),t._v(" "),a("p",[t._v("解析一条sql语句，将解析结果和参数信息绑定到stmt上，如果参数length大于0，将使用此参数作为sql语句的长度，如等于0，将自动判断sql语句的长度。")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("int taos_stmt_bind_param(TAOS_STMT *stmt, TAOS_BIND *bind)")])]),t._v(" "),a("p",[t._v("进行参数绑定，bind指向一个数组，需保证此数组的元素数量和顺序与sql语句中的参数完全一致。TAOS_BIND 的使用方法与 MySQL中的 MYSQL_BIND 一致，具体定义如下：")])])]),t._v(" "),a("div",{staticClass:"language-c extra-class"},[a("pre",{pre:!0,attrs:{class:"language-c"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typedef")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("struct")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TAOS_BIND")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("            buffer_type"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("         buffer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("unsigned")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),t._v("  buffer_length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 未实际使用")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("unsigned")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("          is_null"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("            is_unsigned"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 未实际使用")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("          error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("          "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 未实际使用")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" TAOS_BIND"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("ul",[a("li",[a("p",[a("code",[t._v("int taos_stmt_add_batch(TAOS_STMT *stmt)")])]),t._v(" "),a("p",[t._v("将当前绑定的参数加入批处理中，调用此函数后，可以再次调用"),a("code",[t._v("taos_stmt_bind_param")]),t._v("绑定新的参数。需要注意，此函数仅支持 insert/import 语句，如果是select等其他SQL语句，将返回错误。")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("int taos_stmt_execute(TAOS_STMT *stmt)")])]),t._v(" "),a("p",[t._v("执行准备好的语句。目前，一条语句只能执行一次。")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("TAOS_RES* taos_stmt_use_result(TAOS_STMT *stmt)")])]),t._v(" "),a("p",[t._v("获取语句的结果集。结果集的使用方式与非参数化调用时一致，使用完成后，应对此结果集调用 "),a("code",[t._v("taos_free_result")]),t._v("以释放资源。")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("int taos_stmt_close(TAOS_STMT *stmt)")])]),t._v(" "),a("p",[t._v("执行完毕，释放所有资源。")])])]),t._v(" "),a("h3",{attrs:{id:"连续查询接口"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#连续查询接口"}},[t._v("#")]),t._v(" 连续查询接口")]),t._v(" "),a("p",[t._v("TDengine提供时间驱动的实时流式计算API。可以每隔一指定的时间段，对一张或多张数据库的表(数据流)进行各种实时聚合计算操作。操作简单，仅有打开、关闭流的API。具体如下：")]),t._v(" "),a("ul",[a("li",[a("p",[a("code",[t._v("TAOS_STREAM *taos_open_stream(TAOS *taos, const char *sql, void (*fp)(void *param, TAOS_RES *, TAOS_ROW row), int64_t stime, void *param, void (*callback)(void *))")])]),t._v(" "),a("p",[t._v("该API用来创建数据流，其中：")]),t._v(" "),a("ul",[a("li",[t._v("taos：已经建立好的数据库连接")]),t._v(" "),a("li",[t._v("sql：SQL查询语句（仅能使用查询语句）")]),t._v(" "),a("li",[t._v("fp：用户定义的回调函数指针，每次流式计算完成后，TDengine将查询的结果（TAOS_ROW）、查询状态（TAOS_RES）、用户定义参数（PARAM）传递给回调函数，在回调函数内，用户可以使用taos_num_fields获取结果集列数，taos_fetch_fields获取结果集每列数据的类型。")]),t._v(" "),a("li",[t._v("stime：是流式计算开始的时间，如果是0，表示从现在开始，如果不为零，表示从指定的时间开始计算（UTC时间从1970/1/1算起的毫秒数）")]),t._v(" "),a("li",[t._v("param：是应用提供的用于回调的一个参数，回调时，提供给应用")]),t._v(" "),a("li",[t._v("callback: 第二个回调函数，会在连续查询自动停止时被调用。")])]),t._v(" "),a("p",[t._v("返回值为NULL，表示创建成功，返回值不为空，表示成功。")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("void taos_close_stream (TAOS_STREAM *tstr)")])]),t._v(" "),a("p",[t._v("关闭数据流，其中提供的参数是taos_open_stream的返回值。用户停止流式计算的时候，务必关闭该数据流。")])])]),t._v(" "),a("h3",{attrs:{id:"数据订阅接口"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数据订阅接口"}},[t._v("#")]),t._v(" 数据订阅接口")]),t._v(" "),a("p",[t._v("订阅API目前支持订阅一张或多张表，并通过定期轮询的方式不断获取写入表中的最新数据。")]),t._v(" "),a("ul",[a("li",[a("p",[a("code",[t._v("TAOS_SUB *taos_subscribe(TAOS* taos, int restart, const char* topic, const char *sql, TAOS_SUBSCRIBE_CALLBACK fp, void *param, int interval)")])]),t._v(" "),a("p",[t._v("该函数负责启动订阅服务，成功时返回订阅对象，失败时返回 "),a("code",[t._v("NULL")]),t._v("，其参数为：")]),t._v(" "),a("ul",[a("li",[t._v("taos：已经建立好的数据库连接")]),t._v(" "),a("li",[t._v("restart：如果订阅已经存在，是重新开始，还是继续之前的订阅")]),t._v(" "),a("li",[t._v("topic：订阅的主题（即名称），此参数是订阅的唯一标识")]),t._v(" "),a("li",[t._v("sql：订阅的查询语句，此语句只能是 "),a("code",[t._v("select")]),t._v(" 语句，只应查询原始数据，只能按时间正序查询数据")]),t._v(" "),a("li",[t._v("fp：收到查询结果时的回调函数（稍后介绍函数原型），只在异步调用时使用，同步调用时此参数应该传 "),a("code",[t._v("NULL")])]),t._v(" "),a("li",[t._v("param：调用回调函数时的附加参数，系统API将其原样传递到回调函数，不进行任何处理")]),t._v(" "),a("li",[t._v("interval：轮询周期，单位为毫秒。异步调用时，将根据此参数周期性的调用回调函数，为避免对系统性能造成影响，不建议将此参数设置的过小；同步调用时，如两次调用"),a("code",[t._v("taos_consume")]),t._v("的间隔小于此周期，API将会阻塞，直到时间间隔超过此周期。")])])]),t._v(" "),a("li",[a("p",[a("code",[t._v("typedef void (*TAOS_SUBSCRIBE_CALLBACK)(TAOS_SUB* tsub, TAOS_RES *res, void* param, int code)")])]),t._v(" "),a("p",[t._v("异步模式下，回调函数的原型，其参数为：")]),t._v(" "),a("ul",[a("li",[t._v("tsub：订阅对象")]),t._v(" "),a("li",[t._v("res：查询结果集，注意结果集中可能没有记录")]),t._v(" "),a("li",[t._v("param：调用 "),a("code",[t._v("taos_subscribe")]),t._v("时客户程序提供的附加参数")]),t._v(" "),a("li",[t._v("code：错误码")])])]),t._v(" "),a("li",[a("p",[a("code",[t._v("TAOS_RES *taos_consume(TAOS_SUB *tsub)")])]),t._v(" "),a("p",[t._v("同步模式下，该函数用来获取订阅的结果。 用户应用程序将其置于一个循环之中。 如两次调用"),a("code",[t._v("taos_consume")]),t._v("的间隔小于订阅的轮询周期，API将会阻塞，直到时间间隔超过此周期。 如果数据库有新记录到达，该API将返回该最新的记录，否则返回一个没有记录的空结果集。 如果返回值为 "),a("code",[t._v("NULL")]),t._v("，说明系统出错。 异步模式下，用户程序不应调用此API。")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("void taos_unsubscribe(TAOS_SUB *tsub, int keepProgress)")])]),t._v(" "),a("p",[t._v("取消订阅。 如参数 "),a("code",[t._v("keepProgress")]),t._v(" 不为0，API会保留订阅的进度信息，后续调用 "),a("code",[t._v("taos_subscribe")]),t._v(" 时可以基于此进度继续；否则将删除进度信息，后续只能重新开始读取数据。")])])]),t._v(" "),a("h2",{attrs:{id:"python-connector"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#python-connector"}},[t._v("#")]),t._v(" "),a("a",{staticClass:"anchor",attrs:{id:"python"}}),t._v("Python Connector")]),t._v(" "),a("p",[t._v("Python连接器的使用参见"),a("a",{attrs:{href:"https://www.taosdata.com/blog/2020/11/11/1963.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("视频教程"),a("OutboundLink")],1)]),t._v(" "),a("h3",{attrs:{id:"安装准备"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装准备"}},[t._v("#")]),t._v(" 安装准备")]),t._v(" "),a("ul",[a("li",[t._v("应用驱动安装请参考"),a("a",{attrs:{href:"https://www.taosdata.com/cn/documentation/connector#driver",target:"_blank",rel:"noopener noreferrer"}},[t._v("安装连接器驱动步骤"),a("OutboundLink")],1),t._v("。")]),t._v(" "),a("li",[t._v("已安装python 2.7 or >= 3.4")]),t._v(" "),a("li",[t._v("已安装pip 或 pip3")])]),t._v(" "),a("h3",{attrs:{id:"python客户端安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#python客户端安装"}},[t._v("#")]),t._v(" Python客户端安装")]),t._v(" "),a("h4",{attrs:{id:"linux"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#linux"}},[t._v("#")]),t._v(" Linux")]),t._v(" "),a("p",[t._v("用户可以在源代码的src/connector/python（或者tar.gz的/connector/python）文件夹下找到python2和python3的connector安装包。用户可以通过pip命令安装：")]),t._v(" "),a("p",[t._v("​\t\t"),a("code",[t._v("pip install src/connector/python/linux/python2/")])]),t._v(" "),a("p",[t._v("或")]),t._v(" "),a("p",[t._v("​\t\t"),a("code",[t._v("pip3 install src/connector/python/linux/python3/")])]),t._v(" "),a("h4",{attrs:{id:"windows"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#windows"}},[t._v("#")]),t._v(" Windows")]),t._v(" "),a("p",[t._v('在已安装Windows TDengine 客户端的情况下， 将文件"C:\\TDengine\\driver\\taos.dll" 拷贝到 "C:\\windows\\system32" 目录下, 然后进入Windwos '),a("em",[t._v("cmd")]),t._v(" 命令行界面")]),t._v(" "),a("div",{staticClass:"language-cmd extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("cd C:\\TDengine\\connector\\python\\windows\npython -m pip install python2\\\n")])])]),a("p",[t._v("或")]),t._v(" "),a("div",{staticClass:"language-cmd extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("cd C:\\TDengine\\connector\\python\\windows\npython -m pip install python3\\\n")])])]),a("ul",[a("li",[t._v("如果机器上没有pip命令，用户可将src/connector/python/python3或src/connector/python/python2下的taos文件夹拷贝到应用程序的目录使用。\n对于windows 客户端，安装TDengine windows 客户端后，将C:\\TDengine\\driver\\taos.dll拷贝到C:\\windows\\system32目录下即可。")])]),t._v(" "),a("h3",{attrs:{id:"使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用"}},[t._v("#")]),t._v(" 使用")]),t._v(" "),a("h4",{attrs:{id:"代码示例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#代码示例"}},[t._v("#")]),t._v(" 代码示例")]),t._v(" "),a("ul",[a("li",[t._v("导入TDengine客户端模块")])]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" taos\n")])])]),a("ul",[a("li",[t._v("获取连接并获取游标对象")])]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("conn "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" taos"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("connect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("host"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"127.0.0.1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" user"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"root"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" password"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"taosdata"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" config"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/etc/taos"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nc1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" conn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cursor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("ul",[a("li",[a("p",[a("em",[t._v("host")]),t._v(" 是TDengine 服务端所有IP, "),a("em",[t._v("config")]),t._v(" 为客户端配置文件所在目录")])]),t._v(" "),a("li",[a("p",[t._v("写入数据")])])]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" datetime\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 创建数据库")]),t._v("\nc1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("execute"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'create database db'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nc1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("execute"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'use db'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 建表")]),t._v("\nc1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("execute"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'create table tb (ts timestamp, temperature int, humidity float)'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 插入数据")]),t._v("\nstart_time "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" datetime"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("datetime"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2019")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\naffected_rows "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" c1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("execute"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'insert into tb values (\\'%s\\', 0, 0.0)'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("start_time"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 批量插入数据")]),t._v("\ntime_interval "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" datetime"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("timedelta"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("seconds"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("60")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nsqlcmd "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'insert into tb values'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" irow "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("range")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  start_time "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" time_interval\n  sqlcmd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("append"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'(\\'%s\\', %d, %f)'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("start_time"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" irow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" irow"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\naffected_rows "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" c1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("execute"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("' '")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("join"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sqlcmd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("ul",[a("li",[t._v("查询数据")])]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("c1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("execute"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'select * from tb'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 拉取查询结果")]),t._v("\ndata "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" c1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("fetchall"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 返回的结果是一个列表，每一行构成列表的一个元素")]),t._v("\nnumOfRows "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" c1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rowcount\nnumOfCols "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("len")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("description"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" irow "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("range")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("numOfRows"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Row%d: ts=%s, temperature=%d, humidity=%f"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("irow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("irow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("irow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("irow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 直接使用cursor 循环拉取查询结果")]),t._v("\nc1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("execute"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'select * from tb'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" data "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" c1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ts=%s, temperature=%d, humidity=%f"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("ul",[a("li",[t._v("创建订阅")])]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 创建一个主题为 'test' 消费周期为1000毫秒的订阅")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 第一个参数为 True 表示重新开始订阅，如为 False 且之前创建过主题为 'test' 的订阅，则表示继续消费此订阅的数据，而不是重新开始消费所有数据")]),t._v("\nsub "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" conn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("subscribe"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"test"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"select * from tb;"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("ul",[a("li",[t._v("消费订阅的数据")])]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("data "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" sub"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("consume"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" d "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("d"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("ul",[a("li",[t._v("取消订阅")])]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("sub"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("close"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("ul",[a("li",[t._v("关闭连接")])]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("c1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("close"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nconn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("close"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("h4",{attrs:{id:"帮助信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#帮助信息"}},[t._v("#")]),t._v(" 帮助信息")]),t._v(" "),a("p",[t._v("用户可通过python的帮助信息直接查看模块的使用信息，或者参考tests/examples/python中的示例程序。以下为部分常用类和方法：")]),t._v(" "),a("ul",[a("li",[a("p",[a("em",[t._v("TDengineConnection")]),t._v(" 类")]),t._v(" "),a("p",[t._v("参考python中help(taos.TDengineConnection)。\n这个类对应客户端和TDengine建立的一个连接。在客户端多线程的场景下，推荐每个线程申请一个独立的连接实例，而不建议多线程共享一个连接。")])]),t._v(" "),a("li",[a("p",[a("em",[t._v("TDengineCursor")]),t._v(" 类")]),t._v(" "),a("p",[t._v("参考python中help(taos.TDengineCursor)。\n这个类对应客户端进行的写入、查询操作。在客户端多线程的场景下，这个游标实例必须保持线程独享，不能夸线程共享使用，否则会导致返回结果出现错误。")])]),t._v(" "),a("li",[a("p",[a("em",[t._v("connect")]),t._v(" 方法")]),t._v(" "),a("p",[t._v("用于生成taos.TDengineConnection的实例。")])])]),t._v(" "),a("h3",{attrs:{id:"python客户端使用示例代码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#python客户端使用示例代码"}},[t._v("#")]),t._v(" Python客户端使用示例代码")]),t._v(" "),a("p",[t._v("在tests/examples/python中，我们提供了一个示例Python程序read_example.py，可以参考这个程序来设计用户自己的写入、查询程序。在安装了对应的客户端后，通过import taos引入taos类。主要步骤如下")]),t._v(" "),a("ul",[a("li",[t._v("通过taos.connect获取TDengineConnection对象，这个对象可以一个程序只申请一个，在多线程中共享。")]),t._v(" "),a("li",[t._v("通过TDengineConnection对象的 .cursor()方法获取一个新的游标对象，这个游标对象必须保证每个线程独享。")]),t._v(" "),a("li",[t._v("通过游标对象的execute()方法，执行写入或查询的SQL语句")]),t._v(" "),a("li",[t._v("如果执行的是写入语句，execute返回的是成功写入的行数信息affected rows")]),t._v(" "),a("li",[t._v("如果执行的是查询语句，则execute执行成功后，需要通过fetchall方法去拉取结果集。\n具体方法可以参考示例代码。")])]),t._v(" "),a("h2",{attrs:{id:"restful-connector"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#restful-connector"}},[t._v("#")]),t._v(" "),a("a",{staticClass:"anchor",attrs:{id:"restful"}}),t._v("RESTful Connector")]),t._v(" "),a("p",[t._v("为支持各种不同类型平台的开发，TDengine提供符合REST设计标准的API，即RESTful API。为最大程度降低学习成本，不同于其他数据库RESTful API的设计方法，TDengine直接通过HTTP POST 请求BODY中包含的SQL语句来操作数据库，仅需要一个URL。RESTful连接器的使用参见"),a("a",{attrs:{href:"https://www.taosdata.com/blog/2020/11/11/1965.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("视频教程"),a("OutboundLink")],1),t._v("。")]),t._v(" "),a("h3",{attrs:{id:"http请求格式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#http请求格式"}},[t._v("#")]),t._v(" HTTP请求格式")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("http://<ip>:<PORT>/rest/sql\n")])])]),a("p",[t._v("参数说明：")]),t._v(" "),a("ul",[a("li",[t._v("IP: 集群中的任一台主机")]),t._v(" "),a("li",[t._v("PORT: 配置文件中httpPort配置项，缺省为6041")])]),t._v(" "),a("p",[t._v("例如：http://192.168.0.1:6041/rest/sql 是指向IP地址为192.168.0.1的URL.")]),t._v(" "),a("p",[t._v("HTTP请求的Header里需带有身份认证信息，TDengine支持Basic认证与自定义认证两种机制，后续版本将提供标准安全的数字签名机制来做身份验证。")]),t._v(" "),a("ul",[a("li",[t._v("自定义身份认证信息如下所示（"),a("token",[t._v("稍后介绍）")])],1)]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("Authorization: Taosd <TOKEN>\n")])])]),a("ul",[a("li",[t._v("Basic身份认证信息如下所示")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("Authorization: Basic <TOKEN>\n")])])]),a("p",[t._v("HTTP请求的BODY里就是一个完整的SQL语句，SQL语句中的数据表应提供数据库前缀，例如<db-name>.<tb-name>。如果表名不带数据库前缀，系统会返回错误。因为HTTP模块只是一个简单的转发，没有当前DB的概念。")]),t._v(" "),a("p",[t._v("使用curl通过自定义身份认证方式来发起一个HTTP Request，语法如下：")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -H "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Authorization: Basic <TOKEN>'")]),t._v(" -d "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'<SQL>'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("ip"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(":"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("PORT"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("/rest/sql\n")])])]),a("p",[t._v("或者")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -u username:password -d "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'<SQL>'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("ip"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(":"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("PORT"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("/rest/sql\n")])])]),a("p",[t._v("其中，"),a("code",[t._v("TOKEN")]),t._v("为"),a("code",[t._v("{username}:{password}")]),t._v("经过Base64编码之后的字符串，例如"),a("code",[t._v("root:taosdata")]),t._v("编码后为"),a("code",[t._v("cm9vdDp0YW9zZGF0YQ==")])]),t._v(" "),a("h3",{attrs:{id:"http返回格式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#http返回格式"}},[t._v("#")]),t._v(" HTTP返回格式")]),t._v(" "),a("p",[t._v("返回值为JSON格式，如下:")]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"status"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"succ"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"head"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Time Stamp"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"current"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" …"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"data"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2018-10-03 14:38:05.000"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" …"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2018-10-03 14:38:15.000"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("12.6")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" …"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"rows"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" \n")])])]),a("p",[t._v("说明：")]),t._v(" "),a("ul",[a("li",[t._v("status: 告知操作结果是成功还是失败")]),t._v(" "),a("li",[t._v("head: 表的定义，如果不返回结果集，仅有一列“affected_rows”")]),t._v(" "),a("li",[t._v("data: 具体返回的数据，一排一排的呈现，如果不返回结果集，仅[[affected_rows]]")]),t._v(" "),a("li",[t._v("rows: 表明总共多少行数据")])]),t._v(" "),a("h3",{attrs:{id:"自定义授权码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#自定义授权码"}},[t._v("#")]),t._v(" 自定义授权码")]),t._v(" "),a("p",[t._v("HTTP请求中需要带有授权码"),a("code",[t._v("<TOKEN>")]),t._v("，用于身份识别。授权码通常由管理员提供，可简单的通过发送"),a("code",[t._v("HTTP GET")]),t._v("请求来获取授权码，操作如下：")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" http://"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("ip"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(":6041/rest/login/"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("username"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("/"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("password"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),a("p",[t._v("其中，"),a("code",[t._v("ip")]),t._v("是TDengine数据库的IP地址，"),a("code",[t._v("username")]),t._v("为数据库用户名，"),a("code",[t._v("password")]),t._v("为数据库密码，返回值为"),a("code",[t._v("JSON")]),t._v("格式，各字段含义如下：")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("status：请求结果的标志位")])]),t._v(" "),a("li",[a("p",[t._v("code：返回值代码")])]),t._v(" "),a("li",[a("p",[t._v("desc: 授权码")])])]),t._v(" "),a("p",[t._v("获取授权码示例：")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" http://192.168.0.1:6041/rest/login/root/taosdata\n")])])]),a("p",[t._v("返回值：")]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"status"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"succ"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"code"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"desc"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/KfeAzX/f9na8qdtNZmtONryp201ma04bEl8LcvLUd7a8qdtNZmtONryp201ma04"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"使用示例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用示例"}},[t._v("#")]),t._v(" 使用示例")]),t._v(" "),a("ul",[a("li",[t._v("在demo库里查询表d1001的所有记录：")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -H "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Authorization: Basic cm9vdDp0YW9zZGF0YQ=='")]),t._v(" -d "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'select * from demo.d1001'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".0.1:6041/rest/sql\n")])])]),a("p",[t._v("返回值：")]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"status"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"succ"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"head"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Time Stamp"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"current"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"voltage"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"phase"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"data"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2018-10-03 14:38:05.000"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("219")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.31")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2018-10-03 14:38:15.000"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("12.6")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("218")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.33")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"rows"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("ul",[a("li",[t._v("创建库demo：")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -H "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Authorization: Basic cm9vdDp0YW9zZGF0YQ=='")]),t._v(" -d "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'create database demo'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".0.1:6041/rest/sql\n")])])]),a("p",[t._v("返回值：")]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"status"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"succ"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"head"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"affected_rows"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"data"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"rows"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"其他用法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#其他用法"}},[t._v("#")]),t._v(" 其他用法")]),t._v(" "),a("h4",{attrs:{id:"结果集采用unix时间戳"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#结果集采用unix时间戳"}},[t._v("#")]),t._v(" 结果集采用Unix时间戳")]),t._v(" "),a("p",[t._v("HTTP请求URL采用"),a("code",[t._v("sqlt")]),t._v("时，返回结果集的时间戳将采用Unix时间戳格式表示，例如")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -H "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Authorization: Basic cm9vdDp0YW9zZGF0YQ=='")]),t._v(" -d "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'select * from demo.d1001'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".0.1:6041/rest/sqlt\n")])])]),a("p",[t._v("返回值：")]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"status"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"succ"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"head"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"column1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"column2"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"column3"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"data"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1538548685000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("219")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.31")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1538548695000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("12.6")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("218")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.33")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"rows"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h4",{attrs:{id:"结果集采用utc时间字符串"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#结果集采用utc时间字符串"}},[t._v("#")]),t._v(" 结果集采用UTC时间字符串")]),t._v(" "),a("p",[t._v("HTTP请求URL采用"),a("code",[t._v("sqlutc")]),t._v("时，返回结果集的时间戳将采用UTC时间字符串表示，例如")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -H "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Authorization: Basic cm9vdDp0YW9zZGF0YQ=='")]),t._v(" -d "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'select * from demo.t1'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".0.1:6041/rest/sqlutc\n")])])]),a("p",[t._v("返回值：")]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"status"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"succ"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"head"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"column1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"column2"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"column3"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"data"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2018-10-03T14:38:05.000+0800"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("219")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.31")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2018-10-03T14:38:15.000+0800"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("12.6")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("218")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.33")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"rows"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"重要配置项"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#重要配置项"}},[t._v("#")]),t._v(" 重要配置项")]),t._v(" "),a("p",[t._v("下面仅列出一些与RESTFul接口有关的配置参数，其他系统参数请看配置文件里的说明。注意：配置修改后，需要重启taosd服务才能生效")]),t._v(" "),a("ul",[a("li",[t._v("httpPort: 对外提供RESTFul服务的端口号，默认绑定到6041")]),t._v(" "),a("li",[t._v("httpMaxThreads: 启动的线程数量，默认为2")]),t._v(" "),a("li",[t._v("restfulRowLimit: 返回结果集（JSON格式）的最大条数，默认值为10240")]),t._v(" "),a("li",[t._v("httpEnableCompress: 是否支持压缩，默认不支持，目前TDengine仅支持gzip压缩格式")]),t._v(" "),a("li",[t._v("httpDebugFlag: 日志开关，131：仅错误和报警信息，135：调试信息，143：非常详细的调试信息，默认131")])]),t._v(" "),a("h2",{attrs:{id:"csharp-connector"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#csharp-connector"}},[t._v("#")]),t._v(" "),a("a",{staticClass:"anchor",attrs:{id:"csharp"}}),t._v("CSharp Connector")]),t._v(" "),a("p",[t._v("C#连接器支持的系统有：Linux 64/Windows x64/Windows x86")]),t._v(" "),a("h3",{attrs:{id:"安装准备-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装准备-2"}},[t._v("#")]),t._v(" 安装准备")]),t._v(" "),a("ul",[a("li",[t._v("应用驱动安装请参考"),a("a",{attrs:{href:"https://www.taosdata.com/cn/documentation/connector#driver",target:"_blank",rel:"noopener noreferrer"}},[t._v("安装连接器驱动步骤"),a("OutboundLink")],1),t._v("。")]),t._v(" "),a("li",[t._v(".NET接口文件\ufeffTDengineDrivercs.cs和参考程序示例TDengineTest.cs均位于Windows客户端install_directory/examples/C#目录下。")]),t._v(" "),a("li",[t._v("在Windows系统上，C#应用程序可以使用TDengine的原生C接口来执行所有数据库操作，后续版本将提供ORM（dapper）框架驱动。")])]),t._v(" "),a("h3",{attrs:{id:"安装验证"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装验证"}},[t._v("#")]),t._v(" 安装验证")]),t._v(" "),a("p",[t._v("运行install_directory/examples/C#/C#Checker/C#Checker.exe")]),t._v(" "),a("div",{staticClass:"language-cmd extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("cd {install_directory}/examples/C#/C#Checker\ncsc /optimize *.cs\nC#Checker.exe -h <fqdn>\n")])])]),a("h3",{attrs:{id:"c-连接器的使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#c-连接器的使用"}},[t._v("#")]),t._v(" C#连接器的使用")]),t._v(" "),a("p",[t._v("在Windows系统上，.NET应用程序可以使用TDengine的.NET接口来执行所有数据库的操作。使用.NET接口的步骤如下所示：")]),t._v(" "),a("ol",[a("li",[t._v("将.NET接口文件\ufeffTDengineDrivercs.cs加入到应用程序所在.NET项目中。")]),t._v(" "),a("li",[t._v("用户可以参考\ufeffTDengineTest.cs来定义数据库连接参数，以及如何执行数据插入、查询等操作；")])]),t._v(" "),a("p",[t._v("此.NET接口需要用到taos.dll文件，所以在执行应用程序前，拷贝Windows客户端install_directory/driver目录中的taos.dll文件到.NET项目最后生成.exe可执行文件所在文件夹。之后运行exe文件，即可访问TDengine数据库并做插入、查询等操作。")]),t._v(" "),a("p",[a("strong",[t._v("注意：")])]),t._v(" "),a("ol",[a("li",[t._v("TDengine V2.0.3.0之后同时支持32位和64位Windows系统，所以.NET项目在生成.exe文件时，“解决方案”/“项目”的“平台”请选择对应的“X86” 或“x64”。")]),t._v(" "),a("li",[t._v("此.NET接口目前已经在Visual Studio 2015/2017中验证过，其它VS版本尚待验证。")])]),t._v(" "),a("h3",{attrs:{id:"第三方驱动"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第三方驱动"}},[t._v("#")]),t._v(" 第三方驱动")]),t._v(" "),a("p",[t._v("Maikebing.Data.Taos是一个TDengine的ADO.Net提供器，支持linux，windows。该开发包由热心贡献者"),a("code",[t._v("麦壳饼@@maikebing")]),t._v("提供，具体请参考")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("//接口下载\nhttps://github.com/maikebing/Maikebing.EntityFrameworkCore.Taos   \n//用法说明    \nhttps://www.taosdata.com/blog/2020/11/02/1901.html                    \n")])])]),a("h2",{attrs:{id:"go-connector"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#go-connector"}},[t._v("#")]),t._v(" "),a("a",{staticClass:"anchor",attrs:{id:"go"}}),t._v("Go Connector")]),t._v(" "),a("h3",{attrs:{id:"安装准备-3"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装准备-3"}},[t._v("#")]),t._v(" 安装准备")]),t._v(" "),a("ul",[a("li",[t._v("应用驱动安装请参考"),a("a",{attrs:{href:"https://www.taosdata.com/cn/documentation/connector#driver",target:"_blank",rel:"noopener noreferrer"}},[t._v("安装连接器驱动步骤"),a("OutboundLink")],1),t._v("。")])]),t._v(" "),a("p",[t._v("TDengine提供了GO驱动程序"),a("code",[t._v("taosSql")]),t._v("。 "),a("code",[t._v("taosSql")]),t._v("实现了GO语言的内置接口"),a("code",[t._v("database/sql/driver")]),t._v("。用户只需按如下方式引入包就可以在应用程序中访问TDengine, 详见"),a("code",[t._v("https://github.com/taosdata/driver-go/blob/develop/taosSql/driver_test.go")]),t._v("。")]),t._v(" "),a("p",[t._v("使用 Go 连接器的示例代码请参考 https://github.com/taosdata/TDengine/tree/develop/tests/examples/go 以及"),a("a",{attrs:{href:"https://www.taosdata.com/blog/2020/11/11/1951.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("视频教程"),a("OutboundLink")],1),t._v("。")]),t._v(" "),a("div",{staticClass:"language-Go extra-class"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"database/sql"')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("_")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"github.com/taosdata/driver-go/taosSql"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[a("strong",[t._v("建议使用Go版本1.13或以上，并开启模块支持：")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("go "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("env")]),t._v(" -w "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("GO111MODULE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("on  \ngo "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("env")]),t._v(" -w "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("GOPROXY")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("https://goproxy.io,direct  \n")])])]),a("h3",{attrs:{id:"常用api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#常用api"}},[t._v("#")]),t._v(" 常用API")]),t._v(" "),a("ul",[a("li",[a("p",[a("code",[t._v("sql.Open(DRIVER_NAME string, dataSourceName string) *DB")])]),t._v(" "),a("p",[t._v("该API用来打开DB，返回一个类型为*DB的对象，一般情况下，DRIVER_NAME设置为字符串"),a("code",[t._v("taosSql")]),t._v(", dataSourceName设置为字符串"),a("code",[t._v("user:password@/tcp(host:port)/dbname")]),t._v("，如果客户想要用多个goroutine并发访问TDengine, 那么需要在各个goroutine中分别创建一个sql.Open对象并用之访问TDengine")]),t._v(" "),a("p",[a("strong",[t._v("注意")]),t._v("： 该API成功创建的时候，并没有做权限等检查，只有在真正执行Query或者Exec的时候才能真正的去创建连接，并同时检查user/password/host/port是不是合法。 另外，由于整个驱动程序大部分实现都下沉到taosSql所依赖的libtaos中。所以，sql.Open本身特别轻量。")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("func (db *DB) Exec(query string, args ...interface{}) (Result, error)")])])])]),t._v(" "),a("p",[t._v("sql.Open内置的方法，用来执行非查询相关SQL")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("func (db *DB) Query(query string, args ...interface{}) (*Rows, error)")])])]),t._v(" "),a("p",[t._v("sql.Open内置的方法，用来执行查询语句")]),t._v(" "),a("ul",[a("li",[a("p",[a("code",[t._v("func (db *DB) Prepare(query string) (*Stmt, error)")])]),t._v(" "),a("p",[t._v("sql.Open内置的方法，Prepare creates a prepared statement for later queries or executions.")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("func (s *Stmt) Exec(args ...interface{}) (Result, error)")])]),t._v(" "),a("p",[t._v("sql.Open内置的方法，executes a prepared statement with the given arguments and returns a Result summarizing the effect of the statement.")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("func (s *Stmt) Query(args ...interface{}) (*Rows, error)")])]),t._v(" "),a("p",[t._v("sql.Open内置的方法，Query executes a prepared query statement with the given arguments and returns the query results as a *Rows.")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("func (s *Stmt) Close() error")])]),t._v(" "),a("p",[t._v("sql.Open内置的方法，Close closes the statement.")])])]),t._v(" "),a("h2",{attrs:{id:"node-js-connector"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#node-js-connector"}},[t._v("#")]),t._v(" "),a("a",{staticClass:"anchor",attrs:{id:"nodejs"}}),t._v("Node.js Connector")]),t._v(" "),a("p",[t._v("Node.js连接器支持的系统有：")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[a("strong",[t._v("CPU类型")])]),t._v(" "),a("th",[t._v("x64（64bit）")]),t._v(" "),a("th"),t._v(" "),a("th"),t._v(" "),a("th",[t._v("aarch64")]),t._v(" "),a("th",[t._v("aarch32")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("strong",[t._v("OS类型")])]),t._v(" "),a("td",[t._v("Linux")]),t._v(" "),a("td",[t._v("Win64")]),t._v(" "),a("td",[t._v("Win32")]),t._v(" "),a("td",[t._v("Linux")]),t._v(" "),a("td",[t._v("Linux")])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("支持与否")])]),t._v(" "),a("td",[a("strong",[t._v("支持")])]),t._v(" "),a("td",[a("strong",[t._v("支持")])]),t._v(" "),a("td",[a("strong",[t._v("支持")])]),t._v(" "),a("td",[a("strong",[t._v("支持")])]),t._v(" "),a("td",[a("strong",[t._v("支持")])])])])]),t._v(" "),a("p",[t._v("Node.js连接器的使用参见"),a("a",{attrs:{href:"https://www.taosdata.com/blog/2020/11/11/1957.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("视频教程"),a("OutboundLink")],1)]),t._v(" "),a("h3",{attrs:{id:"安装准备-4"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装准备-4"}},[t._v("#")]),t._v(" 安装准备")]),t._v(" "),a("ul",[a("li",[t._v("应用驱动安装请参考"),a("a",{attrs:{href:"https://www.taosdata.com/cn/documentation/connector#driver",target:"_blank",rel:"noopener noreferrer"}},[t._v("安装连接器驱动步骤"),a("OutboundLink")],1),t._v("。")])]),t._v(" "),a("h3",{attrs:{id:"安装node-js连接器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装node-js连接器"}},[t._v("#")]),t._v(" 安装Node.js连接器")]),t._v(" "),a("p",[t._v("用户可以通过"),a("a",{attrs:{href:"https://www.npmjs.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("npm"),a("OutboundLink")],1),t._v("来进行安装，也可以通过源代码"),a("em",[t._v("src/connector/nodejs/")]),t._v(" 来进行安装。具体安装步骤如下：")]),t._v(" "),a("p",[t._v("首先，通过"),a("a",{attrs:{href:"https://www.npmjs.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("npm"),a("OutboundLink")],1),t._v("安装node.js 连接器.")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" td2.0-connector\n")])])]),a("p",[t._v("我们建议用户使用npm 安装node.js连接器。如果您没有安装npm, 可以将*src/connector/nodejs/*拷贝到您的nodejs 项目目录下")]),t._v(" "),a("p",[t._v("我们使用"),a("a",{attrs:{href:"https://github.com/nodejs/node-gyp",target:"_blank",rel:"noopener noreferrer"}},[t._v("node-gyp"),a("OutboundLink")],1),t._v("和TDengine服务端进行交互。安装node.js 连接器之前，还需安装以下软件：")]),t._v(" "),a("h3",{attrs:{id:"linux-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#linux-2"}},[t._v("#")]),t._v(" Linux")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("python")]),t._v(" (建议"),a("code",[t._v("v2.7")]),t._v(" , "),a("code",[t._v("v3.x.x")]),t._v(" 目前还不支持)")]),t._v(" "),a("li",[a("code",[t._v("node")]),t._v("  2.0.6支持v12.x和v10.x，2.0.5及更早版本支持v10.x版本，其他版本可能存在包兼容性的问题。")]),t._v(" "),a("li",[a("code",[t._v("make")])]),t._v(" "),a("li",[t._v("c语言编译器比如"),a("a",{attrs:{href:"https://gcc.gnu.org",target:"_blank",rel:"noopener noreferrer"}},[t._v("GCC"),a("OutboundLink")],1)])]),t._v(" "),a("h3",{attrs:{id:"windows-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#windows-2"}},[t._v("#")]),t._v(" Windows")]),t._v(" "),a("h4",{attrs:{id:"安装方法1"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装方法1"}},[t._v("#")]),t._v(" 安装方法1")]),t._v(" "),a("p",[t._v("使用微软的"),a("a",{attrs:{href:"https://github.com/felixrieseberg/windows-build-tools",target:"_blank",rel:"noopener noreferrer"}},[t._v("windows-build-tools"),a("OutboundLink")],1),t._v("在"),a("code",[t._v("cmd")]),t._v(" 命令行界面执行"),a("code",[t._v("npm install --global --production windows-build-tools")]),t._v(" 即可安装所有的必备工具")]),t._v(" "),a("h4",{attrs:{id:"安装方法2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装方法2"}},[t._v("#")]),t._v(" 安装方法2")]),t._v(" "),a("p",[t._v("手动安装以下工具:")]),t._v(" "),a("ul",[a("li",[t._v("安装Visual Studio相关："),a("a",{attrs:{href:"https://visualstudio.microsoft.com/thank-you-downloading-visual-studio/?sku=BuildTools",target:"_blank",rel:"noopener noreferrer"}},[t._v("Visual Studio Build 工具"),a("OutboundLink")],1),t._v(" 或者 "),a("a",{attrs:{href:"https://visualstudio.microsoft.com/pl/thank-you-downloading-visual-studio/?sku=Community",target:"_blank",rel:"noopener noreferrer"}},[t._v("Visual Studio 2017 Community"),a("OutboundLink")],1)]),t._v(" "),a("li",[t._v("安装 "),a("a",{attrs:{href:"https://www.python.org/downloads/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Python"),a("OutboundLink")],1),t._v(" 2.7("),a("code",[t._v("v3.x.x")]),t._v(" 暂不支持) 并执行 "),a("code",[t._v("npm config set python python2.7")])]),t._v(" "),a("li",[t._v("进入"),a("code",[t._v("cmd")]),t._v("命令行界面, "),a("code",[t._v("npm config set msvs_version 2017")])])]),t._v(" "),a("p",[t._v("如果以上步骤不能成功执行, 可以参考微软的node.js用户手册"),a("a",{attrs:{href:"https://github.com/Microsoft/nodejs-guidelines/blob/master/windows-environment.md#compiling-native-addon-modules",target:"_blank",rel:"noopener noreferrer"}},[t._v("Microsoft's Node.js Guidelines for Windows"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v('如果在Windows 10 ARM 上使用ARM64 Node.js, 还需添加 "Visual C++ compilers and libraries for ARM64" 和 "Visual  C++ ATL for ARM64".')]),t._v(" "),a("h3",{attrs:{id:"示例程序"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#示例程序"}},[t._v("#")]),t._v(" 示例程序")]),t._v(" "),a("p",[t._v("示例程序源码位于install_directory/examples/nodejs，有：")]),t._v(" "),a("p",[t._v("Node-example.js       \t\tnode.js示例源程序\nNode-example-raw.js")]),t._v(" "),a("h3",{attrs:{id:"安装验证-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装验证-2"}},[t._v("#")]),t._v(" 安装验证")]),t._v(" "),a("p",[t._v("在安装好TDengine客户端后，使用nodejsChecker.js程序能够验证当前环境是否支持nodejs方式访问Tdengine。")]),t._v(" "),a("p",[t._v("验证方法：")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("新建安装验证目录，例如："),a("code",[t._v("~/tdengine-test")]),t._v("，拷贝github上nodejsChecker.js源程序。下载地址：（https://github.com/taosdata/TDengine/tree/develop/tests/examples/nodejs/nodejsChecker.js）。")])]),t._v(" "),a("li",[a("p",[t._v("在命令中执行以下命令：")])])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" init -y\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" td2.0-connector\nnode nodejsChecker.js "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("host")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("localhost\n")])])]),a("ol",{attrs:{start:"3"}},[a("li",[t._v("执行以上步骤后，在命令行会输出nodejs连接Tdengine实例，并执行简答插入和查询的结果。")])]),t._v(" "),a("h3",{attrs:{id:"node-js连接器的使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#node-js连接器的使用"}},[t._v("#")]),t._v(" Node.js连接器的使用")]),t._v(" "),a("p",[t._v("以下是node.js 连接器的一些基本使用方法，详细的使用方法可参考"),a("a",{attrs:{href:"http://docs.taosdata.com/node",target:"_blank",rel:"noopener noreferrer"}},[t._v("TDengine Node.js connector"),a("OutboundLink")],1)]),t._v(" "),a("h4",{attrs:{id:"建立连接"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#建立连接"}},[t._v("#")]),t._v(" 建立连接")]),t._v(" "),a("p",[t._v("使用node.js连接器时，必须先"),a("em",[t._v("require")]),t._v(" "),a("code",[t._v("td2.0-connector")]),t._v("，然后使用 "),a("code",[t._v("taos.connect")]),t._v(" 函数。"),a("code",[t._v("taos.connect")]),t._v(" 函数必须提供的参数是"),a("code",[t._v("host")]),t._v("，其它参数在没有提供的情况下会使用如下的默认值。最后需要初始化"),a("code",[t._v("cursor")]),t._v(" 来和TDengine服务端通信")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" taos "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'td2.0-connector'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" conn "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" taos"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("connect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("host"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"127.0.0.1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" user"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"root"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" password"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"taosdata"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" config"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/etc/taos"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("port"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" cursor "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" conn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("cursor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Initializing a new cursor")]),t._v("\n")])])]),a("p",[t._v("关闭连接可执行")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("conn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("close")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h4",{attrs:{id:"执行sql和插入数据"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#执行sql和插入数据"}},[t._v("#")]),t._v(" 执行SQL和插入数据")]),t._v(" "),a("p",[t._v("对于DDL语句（例如create database、create table、use等），可以使用cursor的execute方法。代码如下：")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("cursor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("execute")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'create database if not exists test;'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("以上代码创建了一个名称为test的数据库。对于DDL语句，一般没有返回值，cursor的execute返回值为0。")]),t._v(" "),a("p",[t._v("对于Insert语句，代码如下：")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" affectRows "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" cursor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("execute")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'insert into test.weather values(now, 22.3, 34);'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("execute方法的返回值为该语句影响的行数，上面的sql向test库的weather表中，插入了一条数据，则返回值affectRows为1。")]),t._v(" "),a("p",[t._v("TDengine目前还不支持update和delete语句。")]),t._v(" "),a("h4",{attrs:{id:"查询"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查询"}},[t._v("#")]),t._v(" 查询")]),t._v(" "),a("p",[t._v("可通过 "),a("code",[t._v("cursor.query")]),t._v(" 函数来查询数据库。")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" query "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" cursor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("query")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'show databases;'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("查询的结果可以通过 "),a("code",[t._v("query.execute()")]),t._v(" 函数获取并打印出来")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" promise "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" query"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("execute")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\npromise"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("result")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  result"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pretty")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("格式化查询语句还可以使用"),a("code",[t._v("query")]),t._v("的"),a("code",[t._v("bind")]),t._v("方法。如下面的示例："),a("code",[t._v("query")]),t._v("会自动将提供的数值填入查询语句的"),a("code",[t._v("?")]),t._v("里。")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" query "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" cursor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("query")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'select * from meterinfo.meters where ts <= ? and areaid = ?;'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("bind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Date")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nquery"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("execute")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("result")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  result"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pretty")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("如果在"),a("code",[t._v("query")]),t._v("语句里提供第二个参数并设为"),a("code",[t._v("true")]),t._v("也可以立即获取查询结果。如下：")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" promise "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" cursor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("query")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'select * from meterinfo.meters where v1 = 30;'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\npromise"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("result")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  result"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pretty")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("h4",{attrs:{id:"异步函数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#异步函数"}},[t._v("#")]),t._v(" 异步函数")]),t._v(" "),a("p",[t._v("异步查询数据库的操作和上面类似，只需要在"),a("code",[t._v("cursor.execute")]),t._v(", "),a("code",[t._v("TaosQuery.execute")]),t._v("等函数后面加上"),a("code",[t._v("_a")]),t._v("。")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" promise1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" cursor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("query")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'select count(*), avg(v1), avg(v2) from meter1;'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("execute_a")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" promise2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" cursor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("query")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'select count(*), avg(v1), avg(v2) from meter2;'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("execute_a")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\npromise1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("result")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  result"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pretty")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\npromise2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("result")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  result"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pretty")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("h3",{attrs:{id:"示例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#示例"}},[t._v("#")]),t._v(" 示例")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://github.com/taosdata/TDengine/tree/master/tests/examples/nodejs/node-example.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("node-example.js"),a("OutboundLink")],1),t._v("提供了一个使用NodeJS 连接器建表，插入天气数据并查询插入的数据的代码示例")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://github.com/taosdata/TDengine/tree/master/tests/examples/nodejs/node-example-raw.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("node-example-raw.js"),a("OutboundLink")],1),t._v("同样是一个使用NodeJS 连接器建表，插入天气数据并查询插入的数据的代码示例，但和上面不同的是，该示例只使用"),a("code",[t._v("cursor")]),t._v(".")])])}),[],!1,null,null,null);s.default=e.exports}}]);