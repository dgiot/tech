(window.webpackJsonp=window.webpackJsonp||[]).push([[215],{808:function(v,_,t){"use strict";t.r(_);var e=t(9),d=Object(e.a)({},(function(){var v=this,_=v.$createElement,t=v._self._c||_;return t("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[t("h1",{attrs:{id:"用户场景"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#用户场景"}},[v._v("#")]),v._v(" 用户场景")]),v._v(" "),t("p",[v._v("从用户到设备，主要需要解决如下几个问题：")]),v._v(" "),t("ul",[t("li",[t("p",[v._v("人与设备的关系，User基于流动性，权限系统里一般不会直接绑定User与Device的权限关系，中间会通过Department(Role)来间接绑定ACL")])]),v._v(" "),t("li",[t("p",[v._v("设备与设备的关系，设备与设备之间有可能存在真实的关系，例如DTU与Meter，也可能只有一种虚拟关系，例如Group与DTU，属于因工程需要，临时拉群")])]),v._v(" "),t("li",[t("p",[v._v("对具体设备来说，1、需要一个UID来表征身份；2、需要一个route来表征关系；3、需要多个tag来表征特征")])]),v._v(" "),t("li",[t("p",[v._v("重点讨论Meter、DTU和TCP Server的交互过程")]),v._v(" "),t("table",[t("thead",[t("tr",[t("th",[v._v("No.")]),v._v(" "),t("th",[v._v("名称")]),v._v(" "),t("th",[v._v("Meter")]),v._v(" "),t("th",[v._v("DTU")]),v._v(" "),t("th",[v._v("TCP Server")]),v._v(" "),t("th",[v._v("说明")])])]),v._v(" "),t("tbody",[t("tr",[t("td",[v._v("1")]),v._v(" "),t("td",[v._v("连接")]),v._v(" "),t("td"),v._v(" "),t("td",[v._v("send ->  [IP]")]),v._v(" "),t("td",[v._v("ack <-- [IP]")]),v._v(" "),t("td",[v._v("必选")])]),v._v(" "),t("tr",[t("td",[v._v("2")]),v._v(" "),t("td",[v._v("登陆")]),v._v(" "),t("td"),v._v(" "),t("td",[v._v("send ->  [DtuAddr]")]),v._v(" "),t("td",[v._v("ack <-- [DtuAddr]")]),v._v(" "),t("td",[v._v("可选，可用IP代替")])]),v._v(" "),t("tr",[t("td",[v._v("3")]),v._v(" "),t("td",[v._v("扫串口")]),v._v(" "),t("td",[v._v("ack-> [485]")]),v._v(" "),t("td",[v._v("send <-- [search 485]")]),v._v(" "),t("td",[v._v("send <--[search 485]")]),v._v(" "),t("td",[v._v("可选，有档案可免")])]),v._v(" "),t("tr",[t("td",[v._v("4")]),v._v(" "),t("td",[v._v("扫modbus")]),v._v(" "),t("td",[v._v("ack-> [modbus]")]),v._v(" "),t("td",[v._v("send <-- [search modbus]")]),v._v(" "),t("td",[v._v("send <--[search modbus]")]),v._v(" "),t("td",[v._v("可选，有档案可免")])]),v._v(" "),t("tr",[t("td",[v._v("5")]),v._v(" "),t("td",[v._v("扫表")]),v._v(" "),t("td",[v._v("ack-> [Meter Addr]")]),v._v(" "),t("td",[v._v("send <-- [search meter]")]),v._v(" "),t("td",[v._v("send <--[search meter]")]),v._v(" "),t("td",[v._v("可选，有档案可免")])]),v._v(" "),t("tr",[t("td",[v._v("6")]),v._v(" "),t("td",[v._v("抄表")]),v._v(" "),t("td",[v._v("ack-> [Meter Data]")]),v._v(" "),t("td",[v._v("send <-- [read meter]")]),v._v(" "),t("td",[v._v("send <--[read meter]")]),v._v(" "),t("td",[v._v("必选")])]),v._v(" "),t("tr",[t("td",[v._v("7")]),v._v(" "),t("td",[v._v("写表")]),v._v(" "),t("td",[v._v("ack-> [Meter Control]")]),v._v(" "),t("td",[v._v("send <-- [write meter]")]),v._v(" "),t("td",[v._v("send <--[write meter]")]),v._v(" "),t("td",[v._v("可选")])]),v._v(" "),t("tr",[t("td",[v._v("8")]),v._v(" "),t("td",[v._v("登出")]),v._v(" "),t("td"),v._v(" "),t("td",[v._v("send -> [DtuAddr]")]),v._v(" "),t("td",[v._v("ack <-- [DtuAddr]")]),v._v(" "),t("td",[v._v("可选")])]),v._v(" "),t("tr",[t("td",[v._v("9")]),v._v(" "),t("td",[v._v("断开")]),v._v(" "),t("td"),v._v(" "),t("td",[v._v("send -> [IP]")]),v._v(" "),t("td",[v._v("do_something")]),v._v(" "),t("td",[v._v("必选")])])])]),v._v(" "),t("p",[v._v("扫串口、扫描modbus、扫表是一个费时费流量的操作，例如扫表一般至少需要扫256次，一般只会在物联网工程施工阶段进行，并完成相应的自动注册功能，形成设备档案，正常运行中不进行这些操作。")]),v._v(" "),t("p",[v._v("这也是为什么电力抄表非常强调电表档案建设，如果没有档案，每一次DTU掉线都需要重新进行非常耗时耗流量的扫描任务")])])]),v._v(" "),t("p",[v._v("整体交互流程如下")]),v._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[v._v("---------------------------------------------------------------------------------------------------------------------\n|             物理层                                      |   连接层                 |      虚拟层            | 应用层|\n---------------------------------------------------------------------------------------------------------------------\n         User1(Session)                User2(Session)                           \n             |                              |           \n            API                            API             <--http--\x3e shuwa_rest  --+\n             |                              |                                       |\n             +                              +                                       |\n        Department1(Role)             Department2(Role)                             |\n             |                              |                                       |\n            ACL                            ACL            <--parse--\x3e shuaw_parse --+\n             +                              +                                       |              +-- 时序数据--+\n         Group(Devcie)                 Group(Devcie)                                |              |            |\n             |                              |                                       | === 流计算==> 物理层镜像    +--\x3e 批量计算      \n    +--------+-------+                      +                                       |              |            |\n    |                |                      |                                       |              +-- 关系数据--+              \nDTU1(Device1)    DTU2(Device)           DTU3(Device)        <--tcp--\x3e  tcp_server ---+\n    |                |                      |                                       | \nmodbus             modbus                modbus            <--modbus--\x3e  proctol ---+\n    |                |                      |                                       |\n    +                +                      +                                       |\n   485              485                     485             <--485--\x3e    proctol  --+ \n    |                |                      |                                       |\n    +                +             +--------+--------+                              |\n    |                |             |                 |                              |\nMeter1(Device) Meter2(Device) Meter4(Device）Meter5(Device）<--DLT/645--\x3e proctol --+                \n")])])]),t("p",[v._v("在正式动手之前，请先体会一下心得和理解用户场景")]),v._v(" "),t("h1",{attrs:{id:"培训纲要"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#培训纲要"}},[v._v("#")]),v._v(" 培训纲要")]),v._v(" "),t("ul",[t("li",[v._v("学会创建一个部门")]),v._v(" "),t("li",[v._v("学会创建一个岗位")]),v._v(" "),t("li",[v._v("学会创建一个用户")]),v._v(" "),t("li",[v._v("学会创建一个应用")]),v._v(" "),t("li",[v._v("学习创建一个API")]),v._v(" "),t("li",[v._v("学会创建一个分组")]),v._v(" "),t("li",[v._v("学会创建一个产品")]),v._v(" "),t("li",[v._v("学会创建一个设备")]),v._v(" "),t("li",[v._v("学会创建一个指令")]),v._v(" "),t("li",[v._v("学会创建一个子设备")]),v._v(" "),t("li",[v._v("学会创建一个物模型")]),v._v(" "),t("li",[v._v("学会创建一个组态")]),v._v(" "),t("li",[v._v("学会创建一个通道")]),v._v(" "),t("li",[v._v("学会创建一个规则")]),v._v(" "),t("li",[v._v("学会开发一个插件")]),v._v(" "),t("li",[v._v("学会接入一个设备")]),v._v(" "),t("li",[v._v("学会设计一个统计量")]),v._v(" "),t("li",[v._v("学会状态迁移编程")]),v._v(" "),t("li",[v._v("学会网络通信编程")]),v._v(" "),t("li",[v._v("学会消息路由编程")]),v._v(" "),t("li",[v._v("学会设备动态注册")])]),v._v(" "),t("h1",{attrs:{id:"详细步骤"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#详细步骤"}},[v._v("#")]),v._v(" 详细步骤")])])}),[],!1,null,null,null);_.default=d.exports}}]);