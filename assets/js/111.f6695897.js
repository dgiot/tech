(window.webpackJsonp=window.webpackJsonp||[]).push([[111],{838:function(s,t,a){"use strict";a.r(t);var n=a(8),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"常见错误"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#常见错误"}},[s._v("#")]),s._v(" 常见错误")]),s._v(" "),a("h2",{attrs:{id:"emq-x-无法连接-mysql-8-0"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#emq-x-无法连接-mysql-8-0"}},[s._v("#")]),s._v(" EMQ X 无法连接 MySQL 8.0")]),s._v(" "),a("p",[a("strong",[s._v("标签:")]),s._v(" "),a("RouterLink",{attrs:{to:"/zh/backend/emqx/faq/tags.html#mysql"}},[a("em",[s._v("MySQL")])]),s._v(" "),a("RouterLink",{attrs:{to:"/zh/backend/emqx/faq/tags.html#认证"}},[a("em",[s._v("认证")])])],1),s._v(" "),a("p",[s._v("不同于以往版本，MySQL 8.0 对账号密码配置默认使用"),a("code",[s._v("caching_sha2_password")]),s._v("插件，需要将密码插件改成"),a("code",[s._v("mysql_native_password")])]),s._v(" "),a("ul",[a("li",[a("p",[s._v("修改 "),a("code",[s._v("mysql.user")]),s._v(" 表")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("## 切换到 mysql 数据库\nmysql> use mysql;\n\n## 查看 user 表\n\nmysql> select user, host, plugin from user;\n+------------------+-----------+-----------------------+\n| user             | host      | plugin                |\n+------------------+-----------+-----------------------+\n| root             | %         | caching_sha2_password |\n| mysql.infoschema | localhost | caching_sha2_password |\n| mysql.session    | localhost | caching_sha2_password |\n| mysql.sys        | localhost | caching_sha2_password |\n| root             | localhost | caching_sha2_password |\n+------------------+-----------+-----------------------+\n\n## 修改密码插件\nmysql> ALTER USER 'your_username'@'your_host' IDENTIFIED WITH mysql_native_password BY 'your_password';\nQuery OK, 0 rows affected (0.01 sec)\n\n## 刷新\nmysql> FLUSH PRIVILEGES;\nQuery OK, 0 rows affected (0.00 sec)\n")])])])]),s._v(" "),a("li",[a("p",[s._v("修改 "),a("code",[s._v("my.conf")])]),s._v(" "),a("p",[s._v("在 "),a("code",[s._v("my.cnf")]),s._v(" 配置文件里面的 [mysqld] 下面加一行")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("default_authentication_plugin=mysql_native_password\n")])])])]),s._v(" "),a("li",[a("p",[s._v("重启 MySQL 即可")])])]),s._v(" "),a("h2",{attrs:{id:"openssl-版本不正确"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#openssl-版本不正确"}},[s._v("#")]),s._v(" OPENSSL 版本不正确")]),s._v(" "),a("p",[a("strong",[s._v("标签:")]),s._v(" "),a("RouterLink",{attrs:{to:"/zh/backend/emqx/faq/tags.html#启动失败"}},[a("em",[s._v("启动失败")])])],1),s._v(" "),a("h3",{attrs:{id:"现象"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#现象"}},[s._v("#")]),s._v(" 现象")]),s._v(" "),a("p",[s._v("执行  "),a("code",[s._v("./bin/emqx console")]),s._v(" 输出的错误内容包含：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("application_start_failure,kernel,"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("shutdown,"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("failed_to_start_child,kernel_safe_sup,"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("on_load_function_failed,crypto"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("p",[s._v("它表示，EMQ X 依赖的 Erlang/OTP 中的 "),a("code",[s._v("crypto")]),s._v(" 应用启动失败。")]),s._v(" "),a("h3",{attrs:{id:"解决方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解决方法"}},[s._v("#")]),s._v(" 解决方法")]),s._v(" "),a("h4",{attrs:{id:"linux"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#linux"}},[s._v("#")]),s._v(" Linux")]),s._v(" "),a("p",[s._v("进入到 EMQ X 的安装目录（如果使用包管理工具安装 EMQ X，则应该进入与 EMQ X 的 "),a("code",[s._v("lib")]),s._v(" 目录同级的位置）")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 安装包安装")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" emqx\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 包管理器安装，例如 yum。则它的 lib 目录应该在 /lib/emqx")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /lib/emqx\n")])])]),a("p",[s._v("查询 "),a("code",[s._v("crypto")]),s._v("依赖的 "),a("code",[s._v(".so")]),s._v(" 动态库列表及其在内存中的地址：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ ldd lib/crypto-*/priv/lib/crypto.so\n\nlib/crypto-4.6/priv/lib/crypto.so: /lib64/libcrypto.so.10: version `OPENSSL_1.1.1' not found "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("required by lib/crypto-4.6/priv/lib/crypto.so"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        linux-vdso.so.1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("0x00007fff67bfc000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        libcrypto.so.10 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /lib64/libcrypto.so.10 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("0x00007fee749ca000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        libc.so.6 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /lib64/libc.so.6 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("0x00007fee74609000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        libdl.so.2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /lib64/libdl.so.2 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("0x00007fee74404000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        libz.so.1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /lib64/libz.so.1 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("0x00007fee741ee000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        /lib64/ld-linux-x86-64.so.2 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("0x00007fee74fe5000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n")])])]),a("p",[s._v("其中 "),a("code",[s._v("OPENSSL_1.1.1' not found")]),s._v("表明指定的 OPENSSL 版本的 "),a("code",[s._v(".so")]),s._v(" 库未正确安装。")]),s._v(" "),a("p",[s._v("源码编译安装 OPENSSL 1.1.1，并将其 so 文件放置到可以被系统识别的路径：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 下在最新版本 1.1.1")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://www.openssl.org/source/openssl-1.1.1c.tar.gz\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 上传至 ct-test-ha")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("scp")]),s._v(" openssl-1.1.1c.tar.gz ct-test-ha:~/\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 解压并编译安装")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" zxf   openssl-1.1.1c.tar.gz\n$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" openssl-1.1.1c\n$ ./config\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v("   \t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 执行测试；如果输出 PASS 则继续")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" \n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 确保库的引用")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ln")]),s._v(" -s /usr/local/lib64/libssl.so.1.1 /usr/lib64/libssl.so.1.1\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ln")]),s._v(" -s /usr/local/lib64/libcrypto.so.1.1 /usr/lib64/libcrypto.so.1.1\n")])])]),a("p",[s._v("完成后，执行在 EMQ X 的 lib 同级目录下执行 "),a("code",[s._v("ldd lib/crypto-*/priv/lib/crypto.so")]),s._v(" ，检查是否已能正确识别。如果不在有 "),a("code",[s._v("not found")]),s._v(" 的 "),a("code",[s._v(".so")]),s._v(" 库，即可正常启动 EMQ X。")]),s._v(" "),a("h4",{attrs:{id:"macos"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#macos"}},[s._v("#")]),s._v(" macOS")]),s._v(" "),a("p",[s._v("进入到 EMQ X 的安装目录：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 安装包安装")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" emqx\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## brew 安装")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /usr/local/Cellar/emqx/"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("version"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("/\n")])])]),a("p",[s._v("查询 "),a("code",[s._v("crypto")]),s._v("依赖的 "),a("code",[s._v(".so")]),s._v(" 动态库列表：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ otool -L lib/crypto-*/priv/lib/crypto.so\n\nlib/crypto-4.4.2.1/priv/lib/crypto.so:\n\t/usr/local/opt/openssl@1.1/lib/libcrypto.1.1.dylib "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("compatibility version "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.1")]),s._v(".0, current version "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.1")]),s._v(".0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t/usr/lib/libSystem.B.dylib "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("compatibility version "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.0")]),s._v(".0, current version "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1252.200")]),s._v(".5"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),a("p",[s._v("检查其显示 OPENSSL 已成功安装至指定的目录：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" /usr/local/opt/openssl@1.1/lib/libcrypto.1.1.dylib\nls: /usr/local/opt/openssl@1.1/lib/libcrypto.1.1.dylib: No such "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" or directory\n")])])]),a("p",[s._v("若不存在该文件，则需安装与 "),a("code",[s._v("otool")]),s._v(" 打印出来的对应的 OPENSSL  版本，例如此处显示的为 "),a("code",[s._v("openssl@1.1")]),s._v("：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ brew "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" openssl@1.1\n")])])]),a("p",[s._v("安装完成后，即可正常启动 EMQ X。")]),s._v(" "),a("h2",{attrs:{id:"windows-缺失-msvcr120-dll"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#windows-缺失-msvcr120-dll"}},[s._v("#")]),s._v(" Windows 缺失 MSVCR120.dll")]),s._v(" "),a("p",[a("strong",[s._v("标签:")]),s._v(" "),a("RouterLink",{attrs:{to:"/zh/backend/emqx/faq/tags.html#启动失败"}},[a("em",[s._v("启动失败")])])],1),s._v(" "),a("h3",{attrs:{id:"现象-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#现象-2"}},[s._v("#")]),s._v(" 现象")]),s._v(" "),a("p",[s._v("Windows 执行  "),a("code",[s._v("./bin/emqx console")]),s._v(" 弹出错误窗口：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("无法启动次程序，因为计算机中丢失 MSVCR120.dll。请尝试重新安装该程序以解决此问题。\n")])])]),a("p",[a("img",{attrs:{src:"http://dgiot-1253666439.cos.ap-shanghai-fsi.myqcloud.com/develop_png/zh_CN/faq/static/WechatIMG18396.png",alt:"WechatIMG18396.png"}})]),s._v(" "),a("h3",{attrs:{id:"解决方法-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解决方法-2"}},[s._v("#")]),s._v(" 解决方法")]),s._v(" "),a("p",[s._v("安装 "),a("a",{attrs:{href:"https://www.microsoft.com/en-us/download/search.aspx?q=redistributable+package.",target:"_blank",rel:"noopener noreferrer"}},[s._v("Microsoft Visual C++ RedistributablePackage"),a("OutboundLink")],1)])])}),[],!1,null,null,null);t.default=e.exports}}]);